!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=42)}([function(e,t,n){n(26),n(8),n(27),n(29)},function(e,t,n){n(0);var r=Object.prototype.hasOwnProperty;function o(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}function i(e,t,n,r){var o,i,a,u=e.active,s=e.current,l=s.length,c=l;for(u.length>l&&(u.length=l);l--;)u[l]=s[l];for(i=0;i<c;i++)if(a=u[i],!i||s.indexOf(a)>=0){if(!(o=a[e.specificHandlerMethodName]||a[e.genericHandlerMethodName]||a).call)throw new Error("No event listener for "+e.specificHandlerName+" or "+e.genericHandlerName+" or call on "+o);o.call(a,n,t,r)}}e.exports=o,o.debug=!0,o.prototype.getOwnPropertyChangeDescriptor=function(e){this.__propertyChangeListeners__||Object.defineProperty(this,"__propertyChangeListeners__",{value:{},enumerable:!1,configurable:!0,writable:!0});var t=this.__propertyChangeListeners__;if(!r.call(t,e)){var n=String(e);n=n&&n[0].toUpperCase()+n.slice(1),t[e]={willChangeListeners:{current:[],active:[],specificHandlerMethodName:"handle"+n+"WillChange",genericHandlerMethodName:"handlePropertyWillChange"},changeListeners:{current:[],active:[],specificHandlerMethodName:"handle"+n+"Change",genericHandlerMethodName:"handlePropertyChange"}}}return t[e]},o.prototype.hasOwnPropertyChangeDescriptor=function(e){if(!this.__propertyChangeListeners__)return!1;if(!e)return!0;var t=this.__propertyChangeListeners__;return!!r.call(t,e)},o.prototype.addOwnPropertyChangeListener=function(e,t,n){this.makeObservable&&!this.isObservable&&this.makeObservable();var r,i=o.getOwnPropertyChangeDescriptor(this,e);r=n?i.willChangeListeners:i.changeListeners,o.makePropertyObservable(this,e),r.current.push(t);var a=this;return function(){o.removeOwnPropertyChangeListener(a,e,t,n),a=null}},o.prototype.addBeforeOwnPropertyChangeListener=function(e,t){return o.addOwnPropertyChangeListener(this,e,t,!0)},o.prototype.removeOwnPropertyChangeListener=function(e,t,n){var r,i=o.getOwnPropertyChangeDescriptor(this,e),a=(r=n?i.willChangeListeners:i.changeListeners).current.lastIndexOf(t);if(-1===a)throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(e));r.current.splice(a,1)},o.prototype.removeBeforeOwnPropertyChangeListener=function(e,t){return o.removeOwnPropertyChangeListener(this,e,t,!0)},o.prototype.dispatchOwnPropertyChange=function(e,t,n){var r,a=o.getOwnPropertyChangeDescriptor(this,e);if(!a.isActive){a.isActive=!0,r=n?a.willChangeListeners:a.changeListeners;try{i(r,e,t,this)}finally{a.isActive=!1}}},o.prototype.dispatchBeforeOwnPropertyChange=function(e,t){return o.dispatchOwnPropertyChange(this,e,t,!0)},o.prototype.makePropertyObservable=function(e){var t,n,o=this.__overriddenPropertyDescriptors__;if(o){if(r.call(o,e))return}else{if(Array.isArray(this))return;if(!Object.isExtensible(this))throw new Error("Can't make property "+JSON.stringify(e)+" observable on "+this+" because object is not extensible");o={},Object.defineProperty(this,"__overriddenPropertyDescriptors__",{value:o,enumerable:!1,writable:!0,configurable:!0})}"object"==typeof this.__state__?t=this.__state__:(t={},Object.defineProperty(this,"__state__",{value:t,writable:!0,enumerable:!1})),t[e]=this[e];var a,u=this;do{if(n=Object.getOwnPropertyDescriptor(u,e))break;u=Object.getPrototypeOf(u)}while(u);if(n){if(!n.configurable)return;if(!n.writable&&!n.set)return}else n={value:void 0,enumerable:!0,writable:!0,configurable:!0};o[e]=n,a="value"in n?{get:function(){return n.value},set:function(r){var o,a;if(r!==n.value){if(!(a=(o=this.__propertyChangeListeners__[e]).isActive)){o.isActive=!0;try{i(o.willChangeListeners,e,n.value,this)}finally{}}if(n.value=r,t[e]=r,!a)try{i(o.changeListeners,e,r,this)}finally{o.isActive=!1}}},enumerable:n.enumerable,configurable:!0}:{get:n.get,set:function(r){var o,a,u=this[e];if(n.set.call(this,r),(r=this[e])!==u){if(!(a=(o=this.__propertyChangeListeners__[e]).isActive)){o.isActive=!0;try{i(o.willChangeListeners,e,u,this)}finally{}}if(t[e]=r,!a)try{i(o.changeListeners,e,r,this)}finally{o.isActive=!1}}},enumerable:n.enumerable,configurable:!0},Object.defineProperty(this,e,a)},o.getOwnPropertyChangeDescriptor=function(e,t){return e.getOwnPropertyChangeDescriptor?e.getOwnPropertyChangeDescriptor(t):o.prototype.getOwnPropertyChangeDescriptor.call(e,t)},o.hasOwnPropertyChangeDescriptor=function(e,t){return e.hasOwnPropertyChangeDescriptor?e.hasOwnPropertyChangeDescriptor(t):o.prototype.hasOwnPropertyChangeDescriptor.call(e,t)},o.addOwnPropertyChangeListener=function(e,t,n,r){if(Object.isObject(e))return e.addOwnPropertyChangeListener?e.addOwnPropertyChangeListener(t,n,r):o.prototype.addOwnPropertyChangeListener.call(e,t,n,r)},o.removeOwnPropertyChangeListener=function(e,t,n,r){if(Object.isObject(e))return e.removeOwnPropertyChangeListener?e.removeOwnPropertyChangeListener(t,n,r):o.prototype.removeOwnPropertyChangeListener.call(e,t,n,r)},o.dispatchOwnPropertyChange=function(e,t,n,r){if(Object.isObject(e))return e.dispatchOwnPropertyChange?e.dispatchOwnPropertyChange(t,n,r):o.prototype.dispatchOwnPropertyChange.call(e,t,n,r)},o.addBeforeOwnPropertyChangeListener=function(e,t,n){return o.addOwnPropertyChangeListener(e,t,n,!0)},o.removeBeforeOwnPropertyChangeListener=function(e,t,n){return o.removeOwnPropertyChangeListener(e,t,n,!0)},o.dispatchBeforeOwnPropertyChange=function(e,t,n){return o.dispatchOwnPropertyChange(e,t,n,!0)},o.makePropertyObservable=function(e,t){return e.makePropertyObservable?e.makePropertyObservable(t):o.prototype.makePropertyObservable.call(e,t)}},function(e,t,n){"use strict";function r(){throw new Error("Can't construct. GenericCollection is a mixin.")}e.exports=r,r.EmptyArray=Object.freeze([]),r.prototype.addEach=function(e){if(e&&Object(e)===e)if("function"==typeof e.forEach)e.forEach(this.add,this);else if("number"==typeof e.length)for(var t=0;t<e.length;t++)this.add(e[t],t);else Object.keys(e).forEach(function(t){this.add(e[t],t)},this);else if(e&&"number"==typeof e.length)for(t=0;t<e.length;t++)this.add(e[t],t);return this},r.prototype.deleteEach=function(e,t){return e.forEach(function(e){this.delete(e,t)},this),this},r.prototype.forEach=function(e){var t=arguments[1];return this.reduce(function(n,r,o,i,a){e.call(t,r,o,i,a)},void 0)},r.prototype.map=function(e){var t=arguments[1],n=[];return this.reduce(function(r,o,i,a,u){n.push(e.call(t,o,i,a,u))},void 0),n},r.prototype.enumerate=function(e){null==e&&(e=0);var t=[];return this.reduce(function(n,r){t.push([e++,r])},void 0),t},r.prototype.group=function(e,t,n){n=n||Object.equals;var r=[],o=[];return this.forEach(function(i,a,u){a=e.call(t,i,a,u);var s,l=o.indexOf(a,n);-1===l?(s=[],r.push([a,s]),o.push(a)):s=r[l][1],s.push(i)}),r},r.prototype.toArray=function(){return this.map(Function.identity)},r.prototype.toObject=function(){var e={};return this.reduce(function(t,n,r){e[r]=n},void 0),e},r.prototype.filter=function(e){var t=arguments[1],n=this.constructClone();return this.reduce(function(r,o,i,a,u){e.call(t,o,i,a,u)&&n.add(o,i)},void 0),n},r.prototype.every=function(e){var t=arguments[1];return this.reduce(function(n,r,o,i,a){return n&&e.call(t,r,o,i,a)},!0)},r.prototype.some=function(e){var t=arguments[1];return this.reduce(function(n,r,o,i,a){return n||e.call(t,r,o,i,a)},!1)},r.prototype.all=function(){return this.every(Boolean)},r.prototype.any=function(){return this.some(Boolean)},r.prototype.min=function(e){e=e||this.contentCompare||Object.compare;var t=!0;return this.reduce(function(n,r){return t?(t=!1,r):e(r,n)<0?r:n},void 0)},r.prototype.max=function(e){e=e||this.contentCompare||Object.compare;var t=!0;return this.reduce(function(n,r){return t?(t=!1,r):e(r,n)>0?r:n},void 0)},r.prototype.sum=function(e){return e=void 0===e?0:e,this.reduce(function(e,t){return e+t},e)},r.prototype.average=function(e){var t=void 0===e?0:e,n=void 0===e?0:e;return this.reduce(function(e,r){t+=r,n+=1},void 0),t/n},r.prototype.concat=function(){for(var e=this.constructClone(this),t=0;t<arguments.length;t++)e.addEach(arguments[t]);return e},r.prototype.flatten=function(){var e=this;return this.reduce(function(t,n){return n.forEach(function(e){this.push(e)},t,e),t},[])},r.prototype.zip=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(this),Array.unzip(e)},r.prototype.join=function(e){return this.reduce(function(t,n){return void 0===t?n:t+e+n},void 0)},r.prototype.sorted=function(e,t,n){return(e=e||this.contentCompare||Object.compare).by?(t=e.by,e=e.compare||this.contentCompare||Object.compare):t=t||Function.identity,void 0===n&&(n=1),this.map(function(e){return{by:t(e),value:e}}).sort(function(t,r){return e(t.by,r.by)*n}).map(function(e){return e.value})},r.prototype.reversed=function(){return this.constructClone(this).reverse()},r.prototype.clone=function(e,t){if(void 0===e)e=1/0;else if(0===e)return this;var n=this.constructClone();return this.forEach(function(r,o){n.add(Object.clone(r,e-1,t),o)},this),n},r.prototype.only=function(){if(1===this.length)return this.one()},r.prototype.iterator=function(){return this.iterate.apply(this,arguments)},n(26)},function(e,t){function n(e){this.parent=null,this.value=e}e.exports=n,n.prototype.nest=function(e){var t=Object.create(this);return t.value=e,t.parent=this,t}},function(e,t,n){"use strict";var r=n(10),o=n(14),i=new r;function a(){throw new Error("Can't construct. RangeChanges is a mixin.")}e.exports=a,a.prototype.getAllRangeChangeDescriptors=function(){return i.has(this)||i.set(this,o()),i.get(this)},a.prototype.getRangeChangeDescriptor=function(e){var t=this.getAllRangeChangeDescriptors();return e=e||"",t.has(e)||t.set(e,{isActive:!1,changeListeners:[],willChangeListeners:[]}),t.get(e)},a.prototype.addRangeChangeListener=function(e,t,n){!this.isObservable&&this.makeObservable&&this.makeObservable();var r=this.getRangeChangeDescriptor(t);(n?r.willChangeListeners:r.changeListeners).push(e),Object.defineProperty(this,"dispatchesRangeChanges",{value:!0,writable:!0,configurable:!0,enumerable:!1});var o=this;return function(){o&&(o.removeRangeChangeListener(e,t,n),o=null)}},a.prototype.removeRangeChangeListener=function(e,t,n){var r,o=this.getRangeChangeDescriptor(t),i=(r=n?o.willChangeListeners:o.changeListeners).lastIndexOf(e);if(-1===i)throw new Error("Can't remove range change listener: does not exist: token "+JSON.stringify(t));r.splice(i,1)},a.prototype.dispatchRangeChange=function(e,t,n,r){var o=this.getAllRangeChangeDescriptors(),i="Range"+(r?"WillChange":"Change");o.forEach(function(o,a){if(!o.isActive){var u;o.isActive=!0,u=r?o.willChangeListeners:o.changeListeners;var s="handle"+(a.slice(0,1).toUpperCase()+a.slice(1))+i;try{u.slice().forEach(function(o){if(!(u.indexOf(o)<0))if(o[s])o[s](e,t,n,this,r);else{if(!o.call)throw new Error("Handler "+o+" has no method "+s+" and is not callable");o.call(this,e,t,n,this,r)}},this)}finally{o.isActive=!1}}},this)},a.prototype.addBeforeRangeChangeListener=function(e,t){return this.addRangeChangeListener(e,t,!0)},a.prototype.removeBeforeRangeChangeListener=function(e,t){return this.removeRangeChangeListener(e,t,!0)},a.prototype.dispatchBeforeRangeChange=function(e,t,n){return this.dispatchRangeChange(e,t,n,!0)}},function(e,t,n){n(0);var r=n(47),o={};e.exports=function e(t,n){if(Array.isArray(t))return{type:"tuple",args:t.map(function(t){return e(t,n)})};if(!n&&Object.prototype.hasOwnProperty.call(o,t))return o[t];try{var i=r.parse(t,n||Object.empty);return n||(o[t]=i),i}catch(e){throw e.message=e.message.replace(/[\s\.]+$/,"")+"  on line "+e.line+" column "+e.column,e}}},function(e,t,n){n(0);var r=n(1);n(33);var o=n(48),i=n(34),a=n(11),u=(n(12),n(49)),s=(n(3),n(20));function l(e){return function(t){return t(e)}}function c(e,t){return e(t.value)}t.makeLiteralObserver=l,t.observeValue=c,t.observeParameters=function(e,t){return e(t.parameters)},t.makeElementObserver=function(e){return function(t,n){return t(n.document.getElementById(e))}},t.makeComponentObserver=function(e,t){return function(t,n){var r=n.components;return t((r.getObjectByLabel||r.getComponentByLabel).call(r,e))}},t.observeProperty=f;var h=f;function f(e,t,n,o){if(null==e)return n();var i;function a(e,t,r){i&&i(),i=n(e,t,r)}return r.addOwnPropertyChangeListener(e,t,a,o.beforeChange),a(e[t],t,e),function(){i&&i(),r.removeOwnPropertyChangeListener(e,t,a,o.beforeChange)}}function p(e,t){return function(n,r){return t(function(t){return"string"!=typeof t&&"number"!=typeof t?n():e(function(e){return null==e?n():e.observeProperty?e.observeProperty(t,n,r):h(e,t,n,r)},r)},r)}}t.makePropertyObserver=p,t.observeKey=g,t.observeGet=g;var d=g;function g(e,t,n,r){var o,i=e.contentEquals||Object.equals;function a(e,r,a){i(t,r)&&(o&&o(),o=n(e,t,a))}return a(e.get(t),t,e),e.addMapChangeListener(a,r.beforeChange),function(){o&&o(),e.removeMapChangeListener(a)}}function m(e){return function(t,n){for(var r=[],o=[],i=0;i<e.length;i++)r[i]=void 0,o[i]=function(e,t){return e(function(e){r.set(t,e)},n)}(e[i],i);var a=t(r);return function(){a&&a();for(var e=0;e<o.length;e++)(a=o[e])&&a()}}}function v(e){return function(t,n){var r={},o={};for(var i in e)!function(e,t){o[e]=void 0,r[e]=t(function(t){o[e]=t},n)}(i,e[i]);var a=t(o);return function(){for(var e in a&&a(),r)(a=r[e])&&a()}}}function y(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return m(e)}t.makeGetObserver=function(e,t){return function(n,r){return e(function(e){return e?t(function(t){return null==t?n():e.observeGet?e.observeGet(t,n,r):d(e,t,n,r)},r):n()},r)}},t.makeHasObserver=function(e,t){return function(n,r){return n=Z(n),t(function(t){return e(function(e){return e?e.addRangeChangeListener?M(e,function(){return n((e.has||e.contains).call(e,t))},r):e.addMapChangeListener?U(e,function(){return n(e.has(t))},r):n():n()},r)},r)}},t.makeObserversObserver=m,t.makeRecordObserver=v,t.makeObjectObserver=v,t.makeTupleObserver=y,t.makeArrayObserver=y,t.makeOperatorObserverMaker=function(e){return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var r=m(t),o=I(r);return function(t,n){return o(function(n){return n.every(s.defined)?t(e.apply(void 0,n)):t()},n)}}},t.makeMethodObserverMaker=function(e){var t=e.slice(0,1).toUpperCase()+e.slice(1),n="make"+t+"Observer",r="observe"+t;return function(){var t=arguments[0],o=Array.prototype.slice.call(arguments,1),i=m(o),a=I(i);return function(i,u){return t(function(t){return t?t[n]?t[n].apply(t,o)(i,u):t[r]?t[r](i,u):a(function(n){return n.every(s.defined)&&"function"==typeof t[e]?i(t[e].apply(t,n)):i()},u):i()},u)}}},t.makeNotObserver=function(e){return function(t,n){return e(function(e){return t(!e)},n)}},t.makeAndObserver=function(e,t){return function(n,r){return e(function(e){return e?t(n,r):n(e)},r)}},t.makeOrObserver=function(e,t){return function(n,r){return e(function(e){return e?n(e):t(n,r)},r)}},t.makeConditionalObserver=function(e,t,n){return function(r,o){return e(function(e){return null==e?r():e?t(r,o):n(r,o)},o)}},t.makeDefinedObserver=function(e){return function(t,n){return e(function(e){return t(null!=e)},n)}},t.makeDefaultObserver=function(e,t){return function(n,r){return e(function(e){return null==e?t(n,r):n(e)},r)}};var b=t.makeMapBlockObserver=K(w);function w(e,t){return function(n,r){return e(function(e){if(!e)return n();var o=[],i=[],a=[];var u=M(e,function(n,u,s){var l;X(i,s,u.length,n.map(function(e,t){return{index:s+t}})),function(t){for(;t<e.length;t++)i[t].index=t}(s+n.length);var c,h=[],f=s,p=u.length;for(f=s,p=s+u.length;f<p;f++)(c=a[f])&&c();X(a,s,u.length,n.map(function(e,n){var a=i[s+n];return t(function(e){l?o.set(a.index,e):h[n]=e},r.nest(e))})),l=!0,o.swap(s,u.length,h)},r),s=n(o,e);return function(){s&&s();for(var e=0,t=a.length;e<t;e++)(s=a[e])&&s();u()}},r)}}var O=t.makeFilterBlockObserver=K(function(e,t){var n=w(e,t);return function(e,t){return n(function(n,r){if(!r)return e();var o=[],i=[],a=[0];var u=M(n,function(e,t,i){var u=r.slice(i,i+e.length),s=t.map(Boolean).sum(),l=u.filter(function(t,n){return e[n]}),c=a[i],h=o.slice(c,c+s);(h.length!==l.length||h.some(function(e,t){return e!==l[t]}))&&o.swap(c,s,l),function(e){for(;e<n.length;e++)a[e+1]=a[e]+!!n[e]}(c)},t),s=e(o);return function(){s&&s();for(var e=0,t=i.length;e<t;e++)(s=i[e])&&s();u()}},t)}});function C(e,t){return Object.equals(e[1],t[1])}function A(e,t){return Object.compare(e[1],t[1])}function E(e){return function(t,n){return e(function(e){return t([n.value,e])},n)}}t.makeSortedBlockObserver=function(e,t){var n=E(t),r=w(e,n);return b(function(e,t){return r(function(n){if(!n)return e();var r=[],i=o(r,C,A);var a=M(n,function(e,t){i.deleteEach(t),i.addEach(e)},t),u=e(r);return function(){u&&u(),a()}},t)},G)},t.makeSortedSetBlockObserver=function(e,t){var n=E(t),r=w(e,n),o=w(B(r,z),L(z));return function(e,t){var n=new a;var r=new i(null,function(e,t){return e=n.get(e),t=n.get(t),Object.equals(e,t)},function(e,t){return e=n.get(e),t=n.get(t),Object.compare(e,t)}),u=e(r);function s(e,t){t.forEach(function(e){r.delete(e[0]),n.delete(e[0])}),e.forEach(function(e){n.set(e[0],e[1]),r.add(e[0])})}var l=o(function(e){return r.clear(),M(e,s,t)},t);return function(){u&&u(),l()}}},t.makeReversedObserver=K(function(e){return function(t,n){return e(function(e){if(!e)return t();var r=[];var o=M(e,function(e,t,n){var o=r.length-n-t.length;r.swap(o,t.length,e.reversed())},n),i=t(r);return function(){i&&i(),o()}},n)}});var k=t.makeFlattenObserver=K(function(e){return function(t,n){return e(function(e){if(!e)return t();var r=[],o=[],i=[0],a=[];function u(t){for(var n=t;n<e.length;n++)a[n].index=n,e[n]?i[n+1]=i[n]+e[n].length:i[n+1]=i[n]}var s=M(e,function(e,t,s){var l,c=i[s],h=(p=i[s+t.length])-c;r.swap(c,h,[]),X(a,s,t.length,e.map(function(){return{index:null}})),u(s);for(var f=s,p=s+t.length;f<p;f++)(l=o[f])&&l();X(o,s,t.length,e.map(function(e,t){var o=a[s+t];return M(e,function(e,t,n){u(o.index);var a=i[o.index]+n,s=i[o.index]+n+t.length-a;r.swap(a,s,e)},n)}))},n),l=t(r);return function(){l&&l();for(var e=0,t=o.length;e<t;e++)(l=o[e])&&l();s()}},n)}});function B(e,t){var n=x(e,t);return Y(n)}function x(e,t){var n=w(e,E(t));return function(e,t){return n(function(n,r){if(!n)return e();var o=a();var i=M(n,function(e,t,n){t.forEach(function(e){var t=o.get(e[1]);1===t.length?o.delete(e[1]):t.delete(e[0])}),e.forEach(function(e){var t,n=!o.has(e[1]);(t=n?r.constructClone():o.get(e[1])).add(e[0]),n&&o.set(e[1],t)})},t),u=e(o);return function(){i(),u&&u()}},t)}}function P(e,t,n){var r=w(e,E(t));function o(e,t){return Object.compare(e[1],t[1])*n}return function(e,t){return r(function(n){if(!n)return e();var r=new u(null,C,o);var i=M(n,function(e,t){r.addEach(e),r.deleteEach(t)},t),a=U(r,function(t,n){if(0===n)return t?e(t[0]):e()},t);return function(){i(),a()}},t)}}t.makeConcatObserver=function(){var e=[],t=arguments.length;for(;t--;)e[t]=arguments[t];return k(m(e))},t.makeSomeBlockObserver=function(e,t){return V(p(O(e,t),R),Boolean)},t.makeEveryBlockObserver=function(e,t){var n=V(t,s.not);return V(p(O(e,n),R),s.not)},t.makeGroupBlockObserver=B,t.makeGroupMapBlockObserver=x,t.makeMaxBlockObserver=function(e,t){return P(e,t,1)},t.makeMinBlockObserver=function(e,t){return P(e,t,-1)},t.makeMaxObserver=function(e){return P(e,c,1)},t.makeMinObserver=function(e){return P(e,c,-1)};var R=l("length");function j(e){return function(t){return function(n,r){return n=Z(n),t(function(t){if(!t)return n();var o=e(t,n);return M(t,function(e,t,r){return n(o(e,t,r))},r)},r)}}}function _(e){return"number"==typeof e&&!isNaN(e)}t.makeSumObserver=j(function(){var e=0;return function(t,n,r){return t=t.filter(_),n=n.filter(_),e+=t.sum()-n.sum()}}),t.makeAverageObserver=j(function(){var e=0,t=0;return function(n,r,o){return n=n.filter(_),r=r.filter(_),e+=n.sum()-r.sum(),t+=n.length-r.length,e/t}}),t.makeViewObserver=K(function(e,t,n){n||(n=t,t=T);return function(r,o){return e(function(e){if(!e)return r();var i,a,u,s,l=[],c=!1,h=M(e,function(t,n,r){if(!c)return;var o=t.length-n.length;r<=a?o>0?(l.swap(0,0,e.slice(a,a+o)),l.splice(i,l.length-i)):(l.splice(0,-o),l.swap(l.length,0,e.slice(a+l.length,a+i))):r<a+i&&(l.swap(r-a,n.length,t),o>0?l.splice(i,l.length-i):l.swap(l.length,0,e.slice(a+l.length,a+i)))},o),f=n(function(t){t=+t,isNaN(t)&&(t=void 0);var n="number"==typeof t&&"number"==typeof a,r=Math.max(0,t);"number"==typeof s&&(r=Math.min(r,e.length-s)),c!==n?(n?l.swap(0,0,e.slice(s,s+r)):l.clear(),c=n):c&&u!==r&&(r<u?l.splice(t,u-r):l.swap(u,0,e.slice(s+u,s+r))),i=t,u=r},o),p=t(function(t){t=+t,isNaN(t)&&(t=void 0);var n="number"==typeof i&&"number"==typeof t,r=Math.max(0,t);"number"==typeof i&&(r=Math.min(r,e.length));var o=Math.max(0,i);if("number"==typeof r&&(o=Math.min(o,e.length-r)),c!==n)n?l.swap(0,l.length,e.slice(r,r+o)):l.clear(),c=n;else if(c&&s!==r){var h=Math.abs(r-s);h<u&&r<s?(l.swap(0,0,e.slice(r,s)),l.splice(o,l.length-o)):h<u&&r>s?(l.swap(l.length,0,e.slice(s+u,r+o)),l.splice(0,l.length-o)):l.swap(0,l.length,e.slice(r,r+o))}a=t,s=r,u=o},o);var d=r(l);return function(){d&&d(),f(),p(),h()}},o)}});var T=l(0);t.makeEnumerateObserver=K(function(e){return function(t,n){return e(function(e){if(!e)return t();var r=[];var o=M(e,function(e,t,n){r.swap(n,t.length,e.map(function(e,t){return[n+t,e]})),function(e){for(;e<r.length;e++)r[e].set(0,e)}(n+e.length)},n),i=t(r);return function(){i&&i(),o()}},n)}}),t.makeEnumerationObserver=t.makeEnumerateObserver,t.makeRangeObserver=function(e){return function(t,n){var r=[],o=t(r),i=e(function(e){if(null==(e>>>=0))r.clear();else if(e>r.length){for(var t=[],n=r.length;n<e;n++)t.push(n);r.swap(r.length,0,t)}else e<r.length&&r.splice(e,r.length)},n);return function(){o&&o(),i&&i()}}},t.makeStartsWithObserver=function(e,t){return function(n,r){return t(function(t){if("string"!=typeof t)return n();var o=new RegExp("^"+RegExp.escape(t));return e(function(e){return"string"!=typeof e?n():n(o.test(e))},r)},r)}},t.makeEndsWithObserver=function(e,t){return function(n,r){return t(function(t){if("string"!=typeof t)return n();var o=new RegExp(RegExp.escape(t)+"$");return e(function(e){return"string"!=typeof e?n():n(o.test(e))},r)},r)}},t.makeContainsObserver=function(e,t){return function(n,r){return t(function(t){if("string"!=typeof t)return n();var o=new RegExp(RegExp.escape(t));return e(function(e){return"string"!=typeof e?n():n(o.test(e))},r)},r)}},t.makeJoinObserver=function(e,t){return t=t||S,function(n,r){return e(function(e){return e?t(function(t){if("string"!=typeof t)return n();var o;var i=M(e,function(){o&&o(),o=n(e.join(t))},r);return function(){i(),o&&o()}},r):n()},r)}};var S=l("");function M(e,t,n){if(!e)return Function.noop;var r;if(!e.toArray)return Function.noop;if(!e.addRangeChangeListener)return Function.noop;function o(e,n,o){r&&r(),r=t(e,n,o)}o(e.toArray(),[],0);var i=e.addRangeChangeListener(o,null,n.beforeChange);return function(){r&&r(),i()}}function L(e){return function(t,n){return e(function(e){return q(e,t,n)},n)}}t.observeRangeChange=M,t.makeLastObserver=L,t.observeLast=N;var q=N;function N(e,t,n){var r,o=-1;var i=M(e,function(n,i,a){if(o+=n.length-i.length,!(a+i.length<o&&a+n.length<o)){var u=o<0?null:e.get(o);r&&r(),r=t(u),u}},n);return function(){r&&r(),i&&i()}}function F(e,t,n){var r=0;return M(e,function(n,o,i){return 1!==(r+=n.length-o.length)?t():t(e.only())},n)}function D(e,t,n){var r=0;return M(e,function(n,o,i){return 0===(r+=n.length-o.length)?t():t(e.one())},n)}function I(e){return function(t,n){return e(function(e){return e&&e.addRangeChangeListener?M(e,function(){return t(e)},n):t(e)},n)}}function U(e,t,n){if(e.addMapChangeListener){var r=new a;e.forEach(i);var o=e.addMapChangeListener(i,n.beforeChange);return function(){r.forEach(function(e){e&&e()}),o()}}function i(e,n,o){var i=r.get(n);r.delete(n),i&&i(),i=t(e,n,o),void 0===e?i&&i():r.set(n,i)}}t.makeOnlyObserver=function(e){return function(t,n){return e(Z(function(e){return F(e,t,n)}),n)}},t.observeOnly=F,t.makeOneObserver=function(e){return function(t,n){return e(Z(function(e){return D(e,t,n)}),n)}},t.observeOne=D,t.makeRangeContentObserver=I,t.makeMapContentObserver=function(e){return function(t,n){return e(function(e){return e&&e.addMapChangeListener?U(e,function(){return t(e)},n):t(e)},n)}},t.observeMapChange=U;var Y=t.makeEntriesObserver=K(function(e){return function(t,n){return e(function(e){return e?H(e,t,n):t()},n)}});function H(e,t,n){var r=[],o=a(),i=t(r);var u=U(e,function(e,t,n){var i,a;o.has(t)?null==e?(i=o.get(t),o.delete(t),a=r.indexOf(i),r.splice(a,1)):(i=o.get(t)).set(1,e):(i=[t,e],o.set(t,i),r.push(i))},n);return function(){i&&i(),u&&u()}}function G(e,t){return t.value?e(t.value[0]):e()}function z(e,t){return t.value?e(t.value[1]):e()}t.observeEntries=H,t.makeKeysObserver=function(e){var t=Y(e);return b(t,G)},t.observeEntryKey=G,t.makeValuesObserver=function(e){var t=Y(e);return b(t,z)},t.observeEntryValue=z,t.makeToMapObserver=function(e){return function(t,n){var r=new a,o=t(r),i=e(function(e){if(r.clear(),e&&"object"==typeof e){if(e.addRangeChangeListener)return W(function(e){return M(e,function(e,t){t.forEach(function(e){r.delete(e[0])}),e.forEach(function(e){r.set(e[0],e[1])})},n)},n.nest(e));if(e.addMapChangeListener)return U(e,function(e,t){void 0===e?r.delete(t):r.set(t,e)},n);var t=[],o=0;for(var i in e)t[o++]=h(e,i,function(e){void 0===e?r.delete(i):r.set(i,e)},n);return function(){for(var e=0,n=t.length;e<n;e++)t[e]()}}},n)||Function.noop;return function(){o&&o(),i()}}};var W=b(B(c,G),L(z));function V(e,t,n){return function(r,o){return r=Z(r),e(function(e){return r(t.call(n,e))},o)}}function J(e,t){var r=n(5),o=n(9);return function(n,i){return n=Z(n),t(function(t){if(null==t)return n();var a,u;try{a=r(t),u=o(a)}catch(e){return n()}return e(function(e){return u(n,i.nest(e))},i)},i)}}t.makeParentObserver=function(e){return function(t,n){return n.parent?e(t,n.parent):t()}},t.makeConverterObserver=V,t.makeComputerObserver=function(e,t,n){return function(r,o){return r=Z(r),e(function(e){if(e&&e.every(s.defined))return r(t.apply(n,e))},o)}},t.makePathObserver=J,t.makeExpressionObserver=J,t.makeWithObserver=function(e,t){return function(n,r){return e(function(e){return null==e?n():t(function(e){return null==e?n():n(e)},r.nest(e))},r)}},t.makeToArrayObserver=K(Function.identity),t.makeAsArrayObserver=t.makeToArrayObserver;var $=n(50).merge;function K(e){return function(){var t=e.apply(this,arguments);return function(e,n){var r=[],o=t(function(e){function t(e,t,n){r.swap(n,t.length,e)}if(e&&e.addRangeChangeListener)return $(r,e),e.addRangeChangeListener(t,null,n.beforeChange),function(){e.removeRangeChangeListener(t,null,n.beforeChange)};r.clear()},n),i=e(r);return function(){o&&o(),i&&i()}}}}function Z(e){var t;return function(n){if(n!==t){var r=e.apply(this,arguments);return t=n,r}}}function X(e,t,n,r){t<0?t=e.length+t:t>e.length&&(e.length=t),t+n>e.length?n=e.length-t:n<0&&(n=0);var o=r.length-n,i=e.length,a=e.length+o;if(o>0)for(var u=i-1;u>=t+n;u--){var s=u+o;u in e?e[s]=e[u]:(e[s]=void 0,delete e[s])}for(u=0;u<r.length;u++)u in r?e[t+u]=r[u]:(e[t+u]=void 0,delete e[t+u]);if(o<0)for(u=t+r.length;u<i-o;u++){(s=u-o)in e?e[u]=e[s]:(e[u]=void 0,delete e[u])}e.length=a}t.makeUniq=Z,t.cancelEach=function(e){e.forEach(function(e){e&&e()})},t.autoCancelPrevious=function(e){var t;return function(n){return t&&t(),t=e.apply(this,arguments),function(){t&&t(),t=void 0}}}},function(e,t,n){var r=n(15);function o(e){return function(t){return""!==t&&e("Unexpected "+JSON.stringify(t)),function e(){return e}}}function i(e){return function t(n,r){return r=r||[],e(function(e){return null!=e?t(n,r.concat([e])):n(r)})}}function a(e){return" "===e||"\n"===e||""===e}t.makeParser=function(e,t){t=t||function(e,t){throw new Error(e+" while parsing "+JSON.stringify(t))};return function(n){var r;n=n.trim();var i=e.apply(null,[function(e){return r=e,o(function(e){return t(e,n)})}].concat(Array.prototype.slice.call(arguments,1)));for(Array.prototype.forEach.call(n,function(e,t){i=i(e)});!r;)i=i("");return r}},t.makeExpect=function(e){return function(t){return function(n){return n===e?t(n):t()(n)}}},t.makeParseSome=function(e){var t=i(e);return function(n){return e(function(e){return null!=e?t(n,[e]):n([])})}},t.makeParseAny=i,t.makeDelimitedParser=function(e,t){return function n(r,o,i){return i=i||[],e(function(e){return e.length?(i=i.concat([e]),t(function(e){return e?n(r,o,i):r(i)})):r(i)},o)}},t.isBreak=a,t.isFinal=function(e){return a(e)||r[e]},t.countPrimes=function e(t,n,r){n=n||0;r=r||function(e){return e};return function(o){return"'"===o?e(t,n+1,function(e){return r(e)("'")}):t(n,r)(o)}}},function(e,t,n){"use strict";var r=n(10);e.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.isObject=function(e){return Object(e)===e},Object.getValueOf=function(e){return e&&"function"==typeof e.valueOf&&(e=e.valueOf()),e};var o=new r;Object.hash=function(e){return e&&"function"==typeof e.hash?""+e.hash():Object(e)===e?(o.has(e)||o.set(e,Math.random().toString(36).slice(2)),o.get(e)):""+e};var i=Object.prototype.hasOwnProperty;Object.owns=function(e,t){return i.call(e,t)},Object.has=function(e,t){if("object"!=typeof e)throw new Error("Object.has can't accept non-object: "+typeof e);if(e&&"function"==typeof e.has)return e.has(t);if("string"==typeof t)return t in e&&e[t]!==Object.prototype[t];throw new Error("Key must be a string for Object.has on plain objects")},Object.get=function(e,t,n){if("object"!=typeof e)throw new Error("Object.get can't accept non-object: "+typeof e);return e&&"function"==typeof e.get?e.get(t,n):Object.has(e,t)?e[t]:n},Object.set=function(e,t,n){e&&"function"==typeof e.set?e.set(t,n):e[t]=n},Object.addEach=function(e,t){if(t)if("function"!=typeof t.forEach||t.hasOwnProperty("forEach"))if("number"==typeof t.length)for(var n=0;n<t.length;n++)e[n]=t[n];else Object.keys(t).forEach(function(n){e[n]=t[n]});else!0===t.isMap?t.forEach(function(t,n){e[n]=t}):t.forEach(function(t){e[t[0]]=t[1]});else;return e},Object.forEach=function(e,t,n){Object.keys(e).forEach(function(r){t.call(n,e[r],r,e)})},Object.map=function(e,t,n){return Object.keys(e).map(function(r){return t.call(n,e[r],r,e)})},Object.values=function(e){return Object.map(e,Function.identity)},Object.concat=function(){for(var e={},t=0;t<arguments.length;t++)Object.addEach(e,arguments[t]);return e},Object.from=Object.concat,Object.is=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},Object.equals=function(e,t,n,o){if(n=n||Object.equals,(e=Object.getValueOf(e))===(t=Object.getValueOf(t)))return!0;if(Object.isObject(e)){if((o=o||new r).has(e))return!0;o.set(e,!0)}if(Object.isObject(e)&&"function"==typeof e.equals)return e.equals(t,n,o);if(Object.isObject(t)&&"function"==typeof t.equals)return t.equals(e,n,o);if(Object.isObject(e)&&Object.isObject(t)&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype){for(var i in e)if(!n(e[i],t[i],n,o))return!1;for(var i in t)if(!(i in e&&n(t[i],e[i],n,o)))return!1;return!0}return e!=e&&t!=t||(!e||!t)&&e===t},Object.compare=function(e,t){if((e=Object.getValueOf(e))===(t=Object.getValueOf(t)))return 0;var n=typeof e,r=typeof t;return"number"===n&&"number"===r?e-t:"string"===n&&"string"===r?e<t?-1/0:1/0:e&&"function"==typeof e.compare?e.compare(t):t&&"function"==typeof t.compare?-t.compare(e):0},Object.clone=function(e,t,n){if(e=Object.getValueOf(e),n=n||new r,void 0===t)t=1/0;else if(0===t)return e;if(Object.isObject(e)){if(!n.has(e))if(e&&"function"==typeof e.clone)n.set(e,e.clone(t,n));else{var o=Object.getPrototypeOf(e);if(null!==o&&o!==Object.prototype)throw new Error("Can't clone "+e);var i=Object.create(o);for(var a in n.set(e,i),e)i[a]=Object.clone(e[a],t-1,n)}return n.get(e)}return e},Object.clear=function(e){if(e&&"function"==typeof e.clear)e.clear();else for(var t=Object.keys(e),n=t.length;n;)delete e[t[--n]];return e}},function(e,t,n){var r=n(6),o=n(20);function i(e){return a.compile(e)}e.exports=i;var a=i.semantics={compilers:{property:r.makePropertyObserver,get:r.makeGetObserver,path:r.makePathObserver,with:r.makeWithObserver,if:r.makeConditionalObserver,parent:r.makeParentObserver,not:r.makeNotObserver,and:r.makeAndObserver,or:r.makeOrObserver,default:r.makeDefaultObserver,defined:r.makeDefinedObserver,rangeContent:Function.identity,mapContent:Function.identity,keys:r.makeKeysObserver,values:r.makeValuesObserver,items:r.makeEntriesObserver,entries:r.makeEntriesObserver,toMap:r.makeToMapObserver,mapBlock:r.makeMapBlockObserver,filterBlock:r.makeFilterBlockObserver,everyBlock:r.makeEveryBlockObserver,someBlock:r.makeSomeBlockObserver,sortedBlock:r.makeSortedBlockObserver,sortedSetBlock:r.makeSortedSetBlockObserver,groupBlock:r.makeGroupBlockObserver,groupMapBlock:r.makeGroupMapBlockObserver,minBlock:r.makeMinBlockObserver,maxBlock:r.makeMaxBlockObserver,min:r.makeMinObserver,max:r.makeMaxObserver,enumerate:r.makeEnumerationObserver,reversed:r.makeReversedObserver,flatten:r.makeFlattenObserver,concat:r.makeConcatObserver,view:r.makeViewObserver,sum:r.makeSumObserver,average:r.makeAverageObserver,last:r.makeLastObserver,only:r.makeOnlyObserver,one:r.makeOneObserver,has:r.makeHasObserver,tuple:r.makeArrayObserver,range:r.makeRangeObserver,startsWith:r.makeStartsWithObserver,endsWith:r.makeEndsWithObserver,contains:r.makeContainsObserver,join:r.makeJoinObserver,toArray:r.makeToArrayObserver,asArray:r.makeToArrayObserver},compile:function(e){var t=this.compilers;if("literal"===e.type)return r.makeLiteralObserver(e.value);if("value"===e.type)return r.observeValue;if("parameters"===e.type)return r.observeParameters;if("element"===e.type)return r.makeElementObserver(e.id);if("component"===e.type)return r.makeComponentObserver(e.label,e);if("record"===e.type){var n={},o=e.args;for(var i in o)n[i]=this.compile(o[i]);return r.makeObjectObserver(n)}t.hasOwnProperty(e.type)||(t[e.type]=r.makeMethodObserverMaker(e.type));var a=e.args.map(this.compile,this);return t[e.type].apply(null,a)}},u=a.compilers;Object.keys(o).forEach(function(e){u[e]||(u[e]=r.makeOperatorObserverMaker(o[e]))}),u.toString=r.makeOperatorObserverMaker(o.toString)},function(e,t){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=m);var t=!1;if("function"==typeof WeakMap){var n=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var r=new n,o=Object.freeze({});if(r.set(o,1),1===r.get(o))return void(e.exports=WeakMap);t=!0}}Object.prototype.hasOwnProperty;var i=Object.getOwnPropertyNames,a=Object.defineProperty,u=Object.isExtensible,s="weakmap:",l=s+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var c=new ArrayBuffer(25),h=new Uint8Array(c);crypto.getRandomValues(h),l=s+"rand:"+Array.prototype.map.call(h,function(e){return(e%36).toString(36)}).join("")+"___"}if(a(Object,"getOwnPropertyNames",{value:function(e){return i(e).filter(v)}}),"getPropertyNames"in Object){var f=Object.getPropertyNames;a(Object,"getPropertyNames",{value:function(e){return f(e).filter(v)}})}!function(){var e=Object.freeze;a(Object,"freeze",{value:function(t){return y(t),e(t)}});var t=Object.seal;a(Object,"seal",{value:function(e){return y(e),t(e)}});var n=Object.preventExtensions;a(Object,"preventExtensions",{value:function(e){return y(e),n(e)}})}();var p=!1,d=0,g=function(){this instanceof g||w();var e=[],t=[],n=d++;return Object.create(g.prototype,{get___:{value:b(function(r,o){var i,a=y(r);return a?n in a?a[n]:o:(i=e.indexOf(r))>=0?t[i]:o})},has___:{value:b(function(t){var r=y(t);return r?n in r:e.indexOf(t)>=0})},set___:{value:b(function(r,o){var i,a=y(r);return a?a[n]=o:(i=e.indexOf(r))>=0?t[i]=o:(i=e.length,t[i]=o,e[i]=r),this})},delete___:{value:b(function(r){var o,i,a=y(r);return a?n in a&&delete a[n]:!((o=e.indexOf(r))<0)&&(i=e.length-1,e[o]=void 0,t[o]=t[i],e[o]=e[i],e.length=i,t.length=i,!0)})}})};g.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){return this.set___(e,t)},writable:!0,configurable:!0},delete:{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof n?function(){function r(){this instanceof g||w();var e,r=new n,o=void 0,i=!1;return e=t?function(e,t){return r.set(e,t),r.has(e)||(o||(o=new g),o.set(e,t)),this}:function(e,t){if(i)try{r.set(e,t)}catch(n){o||(o=new g),o.set___(e,t)}else r.set(e,t);return this},Object.create(g.prototype,{get___:{value:b(function(e,t){return o?r.has(e)?r.get(e):o.get___(e,t):r.get(e,t)})},has___:{value:b(function(e){return r.has(e)||!!o&&o.has___(e)})},set___:{value:b(e)},delete___:{value:b(function(e){var t=!!r.delete(e);return o&&o.delete___(e)||t})},permitHostObjects___:{value:b(function(e){if(e!==m)throw new Error("bogus call to permitHostObjects___");i=!0})}})}t&&"undefined"!=typeof Proxy&&(Proxy=void 0),r.prototype=g.prototype,e.exports=r,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),e.exports=g)}function m(e){e.permitHostObjects___&&e.permitHostObjects___(m)}function v(e){return!(e.substr(0,s.length)==s&&"___"===e.substr(e.length-3))}function y(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[l];if(t&&t.key===e)return t;if(u(e)){t={key:e};try{return a(e,l,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(e){return}}}function b(e){return e.prototype=null,Object.freeze(e)}function w(){p||"undefined"==typeof console||(p=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},function(e,t,n){"use strict";n(0);var r=n(12),o=n(2),i=n(30),a=n(1);function u(e,t,n,o){if(!(this instanceof u))return new u(e,t,n,o);t=t||Object.equals,n=n||Object.hash,o=o||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=o,this.store=new r(void 0,function(e,n){return t(e.key,n.key)},function(e){return n(e.key)}),this.length=0,this.addEach(e)}e.exports=u,u.Map=u,Object.addEach(u.prototype,o.prototype),Object.addEach(u.prototype,i.prototype),Object.addEach(u.prototype,a.prototype),u.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},u.prototype.log=function(e,t,n,r){t=t||this.logNode,this.store.log(e,function(e,n,r){t(e.value.value,n,r)},n,r)},u.prototype.logNode=function(e,t){t(" key: "+e.key),t(" value: "+e.value)}},function(e,t,n){"use strict";n(0);var r=n(13),o=n(45),i=n(2),a=n(17),u=n(1),s=n(4);function l(e,t,n,r){if(!(this instanceof l))return new l(e,t,n,r);t=t||Object.equals,n=n||Object.hash,r=r||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=r,this.order=new this.Order(void 0,t),this.store=new this.Store(void 0,function(e,n){return t(e.value,n.value)},function(e){return n(e.value)}),this.length=0,this.addEach(e)}e.exports=l,l.Set=l,Object.addEach(l.prototype,i.prototype),Object.addEach(l.prototype,a.prototype),Object.addEach(l.prototype,u.prototype),Object.addEach(l.prototype,s.prototype),l.prototype.Order=r,l.prototype.Store=o,l.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},l.prototype.has=function(e){var t=new this.order.Node(e);return this.store.has(t)},l.prototype.get=function(e,t){if(t)throw new Error("Set#get does not support second argument: equals");var n=new this.order.Node(e);return(n=this.store.get(n))?n.value:this.getDefault(e)},l.prototype.add=function(e){var t=new this.order.Node(e);if(!this.store.has(t)){var n=this.length;return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],n),this.order.add(e),t=this.order.head.prev,this.store.add(t),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],n),!0}return!1},l.prototype.delete=function(e,t){if(t)throw new Error("Set#delete does not support second argument: equals");var n=new this.order.Node(e);return!!this.store.has(n)&&(n=this.store.get(n),this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],n.index),this.store.delete(n),this.order.splice(n,1),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],n.index),!0)},l.prototype.pop=function(){if(this.length){var e=this.order.head.prev.value;return this.delete(e),e}},l.prototype.shift=function(){if(this.length){var e=this.order.head.next.value;return this.delete(e),e}},l.prototype.one=function(){if(this.length>0)return this.store.one().value},l.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange([],e,0)),this.store.clear(),this.order.clear(),this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange([],e,0)},l.prototype.reduce=function(e,t){var n=arguments[2],r=this.order,o=0;return r.reduce(function(t,r){return e.call(n,t,r,o++,this)},t,this)},l.prototype.reduceRight=function(e,t){var n=arguments[2],r=this.order,o=this.length-1;return r.reduceRight(function(t,r){return e.call(n,t,r,o--,this)},t,this)},l.prototype.iterate=function(){return this.order.iterate()},l.prototype.log=function(){var e=this.store;return e.log.apply(e,arguments)},l.prototype.makeObservable=function(){this.order.makeObservable()}},function(e,t,n){"use strict";e.exports=u;n(0);var r=n(2),o=n(28),i=n(1),a=n(4);function u(e,t,n){if(!(this instanceof u))return new u(e,t,n);var r=this.head=new this.Node;r.next=r,r.prev=r,this.contentEquals=t||Object.equals,this.getDefault=n||Function.noop,this.length=0,this.addEach(e)}function s(e){this.head=e,this.at=e.next}function l(e){this.value=e,this.prev=null,this.next=null}u.List=u,Object.addEach(u.prototype,r.prototype),Object.addEach(u.prototype,o.prototype),Object.addEach(u.prototype,i.prototype),Object.addEach(u.prototype,a.prototype),u.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.getDefault)},u.prototype.find=function(e,t,n){t=t||this.contentEquals;for(var r=this.head,o=this.scan(n,r.next);o!==r;){if(t(o.value,e))return o;o=o.next}},u.prototype.findLast=function(e,t,n){t=t||this.contentEquals;for(var r=this.head,o=this.scan(n,r.prev);o!==r;){if(t(o.value,e))return o;o=o.prev}},u.prototype.has=function(e,t){return!!this.find(e,t)},u.prototype.get=function(e,t){var n=this.find(e,t);return n?n.value:this.getDefault(e)},u.prototype.delete=function(e,t){var n=this.findLast(e,t);if(n){if(this.dispatchesRangeChanges){var r=[],o=[e];this.dispatchBeforeRangeChange(r,o,n.index)}return n.delete(),this.length--,this.dispatchesRangeChanges&&(this.updateIndexes(n.next,n.index),this.dispatchRangeChange(r,o,n.index)),!0}return!1},u.prototype.deleteAll=function(e,t){t=t||this.contentEquals;for(var n=this.head,r=n.next,o=0;r!==n;)t(e,r.value)&&(r.delete(),o++),r=r.next;return this.length-=o,o},u.prototype.clear=function(){var e,t;this.dispatchesRangeChanges&&(t=this.toArray(),e=[],this.dispatchBeforeRangeChange(e,t,0)),this.head.next=this.head.prev=this.head,this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange(e,t,0)},u.prototype.add=function(e){var t=new this.Node(e);return this.dispatchesRangeChanges&&(t.index=this.length,this.dispatchBeforeRangeChange([e],[],t.index)),this.head.addBefore(t),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],t.index),!0},u.prototype.push=function(){var e=this.head;if(this.dispatchesRangeChanges){var t=Array.prototype.slice.call(arguments),n=[],r=this.length;this.dispatchBeforeRangeChange(t,n,r);var o=this.head.prev}for(var i=0;i<arguments.length;i++){var a=arguments[i],u=new this.Node(a);e.addBefore(u)}this.length+=arguments.length,this.dispatchesRangeChanges&&(this.updateIndexes(o.next,void 0===o.index?0:o.index+1),this.dispatchRangeChange(t,n,r))},u.prototype.unshift=function(){if(this.dispatchesRangeChanges){var e=Array.prototype.slice.call(arguments),t=[];this.dispatchBeforeRangeChange(e,t,0)}for(var n=this.head,r=0;r<arguments.length;r++){var o=arguments[r],i=new this.Node(o);n.addAfter(i),n=i}this.length+=arguments.length,this.dispatchesRangeChanges&&(this.updateIndexes(this.head.next,0),this.dispatchRangeChange(e,t,0))},u.prototype.pop=function(){var e,t=this.head;if(t.prev!==t){if(e=t.prev.value,this.dispatchesRangeChanges){var n=[],r=[e],o=this.length-1;this.dispatchBeforeRangeChange(n,r,o)}t.prev.delete(),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange(n,r,o)}return e},u.prototype.shift=function(){var e,t=this.head;if(t.prev!==t){if(e=t.next.value,this.dispatchesRangeChanges){var n=[],r=[e];this.dispatchBeforeRangeChange(n,r,0)}t.next.delete(),this.length--,this.dispatchesRangeChanges&&(this.updateIndexes(this.head.next,0),this.dispatchRangeChange(n,r,0))}return e},u.prototype.peek=function(){if(this.head!==this.head.next)return this.head.next.value},u.prototype.poke=function(e){this.head!==this.head.next?this.head.next.value=e:this.push(e)},u.prototype.one=function(){return this.peek()},u.prototype.scan=function(e,t){var n=this.head;if("number"==typeof e){var r=e;if(r>=0)for(e=n.next;r&&(r--,(e=e.next)!=n););else for(e=n;r<0&&(r++,(e=e.prev)!=n););return e}return e||t},u.prototype.slice=function(e,t){var n=[],r=this.head;for(e=this.scan(e,r.next),t=this.scan(t,r);e!==t&&e!==r;)n.push(e.value),e=e.next;return n},u.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},u.prototype.swap=function(e,t,n){var r=e;e=this.scan(e,this.head),null==t&&(t=1/0),n=Array.from(n);for(var o,i,a=[],u=e;t--&&t>=0&&u!==this.head;)a.push(u.value),u=u.next;this.dispatchesRangeChanges&&(o=e===this.head?this.length:e.prev===this.head?0:e.index,i=e.prev,this.dispatchBeforeRangeChange(n,a,o));u=e;var s=0;for(u=e;s<a.length;s++,u=u.next)u.delete();null==r&&u===this.head&&(u=this.head.next);for(s=0;s<n.length;s++){var l=new this.Node(n[s]);u.addBefore(l)}return this.length+=n.length-a.length,this.dispatchesRangeChanges&&(e===this.head?this.updateIndexes(this.head.next,0):this.updateIndexes(i.next,i.index+1),this.dispatchRangeChange(n,a,o)),a},u.prototype.reverse=function(){if(this.dispatchesRangeChanges){var e=this.toArray(),t=e.reversed();this.dispatchBeforeRangeChange(t,e,0)}var n=this.head;do{var r=n.next;n.next=n.prev,n.prev=r,n=n.next}while(n!==this.head);return this.dispatchesRangeChanges&&this.dispatchRangeChange(t,e,0),this},u.prototype.sort=function(){this.swap(0,this.length,this.sorted())},u.prototype.reduce=function(e,t){for(var n=arguments[2],r=this.head,o=r.next;o!==r;)t=e.call(n,t,o.value,o,this),o=o.next;return t},u.prototype.reduceRight=function(e,t){for(var n=arguments[2],r=this.head,o=r.prev;o!==r;)t=e.call(n,t,o.value,o,this),o=o.prev;return t},u.prototype.updateIndexes=function(e,t){for(;e!==this.head;)e.index=t++,e=e.next},u.prototype.makeObservable=function(){this.head.index=-1,this.updateIndexes(this.head.next,0),this.dispatchesRangeChanges=!0},u.prototype.iterate=function(){return new s(this.head)},s.prototype.next=function(){if(this.at===this.head)throw StopIteration;var e=this.at.value;return this.at=this.at.next,e},u.prototype.Node=l,l.prototype.delete=function(){this.prev.next=this.next,this.next.prev=this.prev},l.prototype.addBefore=function(e){var t=this.prev;this.prev=e,e.prev=t,t.next=e,e.next=this},l.prototype.addAfter=function(e){var t=this.next;this.next=e,e.next=t,t.prev=e,e.prev=this}},function(e,t,n){"use strict";n(0);var r=n(2),o=n(30),i=n(1);function a(e,t){if(!(this instanceof a))return new a(e,t);t=t||Function.noop,this.getDefault=t,this.store=Object.create(null),this.length=0,this.addEach(e)}e.exports=a,a.Dict=a,Object.addEach(a.prototype,r.prototype),Object.addEach(a.prototype,o.prototype),Object.addEach(a.prototype,i.prototype),a.prototype.constructClone=function(e){return new this.constructor(e,this.getDefault)},a.prototype.assertString=function(e){if("string"!=typeof e)throw new TypeError("key must be a string but Got "+e)},Object.defineProperty(a.prototype,"$__proto__",{writable:!0}),Object.defineProperty(a.prototype,"_hasProto",{get:function(){return this.hasOwnProperty("$__proto__")&&void 0!==this._protoValue}}),Object.defineProperty(a.prototype,"_protoValue",{get:function(){return this.$__proto__},set:function(e){this.$__proto__=e}}),a.prototype.get=function(e,t){return this.assertString(e),"__proto__"===e?this._hasProto?this._protoValue:arguments.length>1?t:this.getDefault(e):e in this.store?this.store[e]:arguments.length>1?t:this.getDefault(e)},a.prototype.set=function(e,t){this.assertString(e);var n="__proto__"===e;return(n?this._hasProto:e in this.store)?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,n?this._protoValue:this.store[e]),n?this._protoValue=t:this.store[e]=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t),!1):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,void 0),this.length++,n?this._protoValue=t:this.store[e]=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t),!0)},a.prototype.has=function(e){return this.assertString(e),"__proto__"===e?this._hasProto:e in this.store},a.prototype.delete=function(e){return this.assertString(e),"__proto__"===e?!!this._hasProto&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this._protoValue),this._protoValue=void 0,this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0):e in this.store&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this.store[e]),delete this.store[e],this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0)},a.prototype.clear=function(){var e;for(e in this._hasProto&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange("__proto__",this._protoValue),this._protoValue=void 0,this.dispatchesMapChanges&&this.dispatchMapChange("__proto__",void 0)),this.store)this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this.store[e]),delete this.store[e],this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0);this.length=0},a.prototype.reduce=function(e,t,n){this._hasProto&&(t=e.call(n,t,"$__proto__","__proto__",this));var r=this.store;for(var o in this.store)t=e.call(n,t,r[o],o,this);return t},a.prototype.reduceRight=function(e,t,n){var r=this,o=this.store;return t=Object.keys(this.store).reduceRight(function(t,i){return e.call(n,t,o[i],i,r)},t),this._hasProto?e.call(n,t,this._protoValue,"__proto__",r):t},a.prototype.one=function(){var e;for(e in this.store)return this.store[e];return this._protoValue},a.prototype.toJSON=function(){return this.toObject()}},function(e,t){e.exports={"-":"comma",",":"comma",":":"comma",";":"full-stop",".":"full-stop","!":"exclamation-point","?":"question-mark","(":"open-paren",")":"close-paren",">":"flourish-left","<":"flourish-right"}},function(e,t,n){"use strict";var r=n(10),o=n(13);function i(){throw new Error("Can't construct. MapChanges is a mixin.")}e.exports=i;Object.prototype.hasOwnProperty;var a=new r,u=null;i.prototype.getAllMapChangeDescriptors=function(){return a.has(this)||(u||(u=n(14)),a.set(this,u())),a.get(this)},i.prototype.getMapChangeDescriptor=function(e){var t=this.getAllMapChangeDescriptors();return e=e||"",t.has(e)||t.set(e,{willChangeListeners:new o,changeListeners:new o}),t.get(e)},i.prototype.addMapChangeListener=function(e,t,n){!this.isObservable&&this.makeObservable&&this.makeObservable();var r=this.getMapChangeDescriptor(t);(n?r.willChangeListeners:r.changeListeners).push(e),Object.defineProperty(this,"dispatchesMapChanges",{value:!0,writable:!0,configurable:!0,enumerable:!1});var o=this;return function(){o&&(o.removeMapChangeListener(e,t,n),o=null)}},i.prototype.removeMapChangeListener=function(e,t,n){var r=this.getMapChangeDescriptor(t),o=(n?r.willChangeListeners:r.changeListeners).findLast(e);if(!o)throw new Error("Can't remove map change listener: does not exist: token "+JSON.stringify(t));o.delete()},i.prototype.dispatchMapChange=function(e,t,n){var r=this.getAllMapChangeDescriptors(),o="Map"+(n?"WillChange":"Change");r.forEach(function(r,i){if(!r.isActive){var a;r.isActive=!0,a=n?r.willChangeListeners:r.changeListeners;var u="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+o;try{a.forEach(function(n){if(n[u])n[u](t,e,this);else{if(!n.call)throw new Error("Handler "+n+" has no method "+u+" and is not callable");n.call(n,t,e,this)}},this)}finally{r.isActive=!1}}},this)},i.prototype.addBeforeMapChangeListener=function(e,t){return this.addMapChangeListener(e,t,!0)},i.prototype.removeBeforeMapChangeListener=function(e,t){return this.removeMapChangeListener(e,t,!0)},i.prototype.dispatchBeforeMapChange=function(e,t){return this.dispatchMapChange(e,t,!0)}},function(e,t){function n(){throw new Error("Can't construct. GenericSet is a mixin.")}e.exports=n,n.prototype.isSet=!0,n.prototype.union=function(e){var t=this.constructClone(this);return t.addEach(e),t},n.prototype.intersection=function(e){return this.constructClone(this.filter(function(t){return e.has(t)}))},n.prototype.difference=function(e){var t=this.constructClone(this);return t.deleteEach(e),t},n.prototype.symmetricDifference=function(e){var t=this.union(e),n=this.intersection(e);return t.difference(n)},n.prototype.deleteAll=function(e){return+this.delete(e)},n.prototype.equals=function(e,t){var n=this;return e&&"function"==typeof e.reduce&&this.length===e.length&&e.reduce(function(e,r){return e&&n.has(r,t)},!0)},n.prototype.toJSON=function(){return this.toArray()},n.prototype.contains=function(e){return this.has(e)},n.prototype.remove=function(e){return this.delete(e)},n.prototype.toggle=function(e){this.has(e)?this.delete(e):this.add(e)}},function(e,t){function n(e,t){return n.semantics.solve(e,t)}e.exports=n,n.semantics={solve:function(e,t){for(;;){for(;this.simplifiers.hasOwnProperty(e.type);){var n=this.simplifiers[e.type](e);if(!n)break;e=n}var r=this.rotateTargetToSource.hasOwnProperty(e.type),o=this.rotateSourceToTarget.hasOwnProperty(t.type);if(!r&&!o)break;r?(t=this.rotateTargetToSource[e.type](e,t),e=e.args[0]):o&&(e=this.rotateSourceToTarget[t.type](e,t),t=t.args[0])}return[e,t]},simplifiers:{not:function(e){var t=e.args[0];if("not"===t.type)return t.args[0]},add:function(e){var t=e.args[0];if("literal"===t.type&&""===t.value)return{type:"toString",args:[e.args[1]]}},someBlock:function(e){return{type:"not",args:[{type:"everyBlock",args:[e.args[0],{type:"not",args:[e.args[1]]}]}]}}},rotateTargetToSource:{reflect:function(e,t){return{type:e.type,args:[t]}},invert:function(e,t,n){return{type:n,args:[t,e.args[1]]}},toNumber:function(e,t){return this.reflect(e,t)},toString:function(e,t){return this.reflect(e,t)},not:function(e,t){return this.reflect(e,t)},neg:function(e,t){return this.reflect(e,t)},add:function(e,t){return this.invert(e,t,"sub")},sub:function(e,t){return this.invert(e,t,"add")},mul:function(e,t){return this.invert(e,t,"div")},div:function(e,t){return this.invert(e,t,"mul")},pow:function(e,t){return this.invert(e,t,"root")},root:function(e,t){return this.invert(e,t,"pow")},join:function(e,t){return this.invert(e,t,"split")},split:function(e,t){return this.invert(e,t,"join")}},rotateSourceToTarget:{rangeContent:function(e,t){return"rangeContent"===e.type?e:{type:t.type,args:[e]}}}}},function(e,t,n){var r=n(12),o=n(14),i=t.precedence=o();(t.precedenceLevels=[["tuple","record"],["literal","value","parameters","property","element","component","mapBlock","filterBlock","sortedBlock","groupBlock","groupMapBlock","with"],["not","neg","number","parent"],["scope"],["default"],["pow","root","log"],["mul","div","mod","rem"],["add","sub"],["equals","lt","gt","le","ge","compare"],["and"],["or"],["if"]]).forEach(function(e){var t=r(i.keys());e.forEach(function(e){i.set(e,t)})});var a=t.operatorTokens=o({"**":"pow","//":"root","%%":"log","*":"mul","/":"div","%":"mod",rem:"rem","+":"add","-":"sub","<":"lt",">":"gt","<=":"le",">=":"ge","==":"equals","<=>":"compare","!=":"notEquals","??":"default","&&":"and","||":"or","?":"then",":":"else"});t.operatorTypes=o(a.map(function(e,t){return[e,t]}))},function(e,t,n){n(8),n(29);var r=n(11),o=n(12);t.toNumber=function(e){return+e},t.toString=function(e){return null==e?e:"string"==typeof e||"number"==typeof e?""+e:null},t.toArray=Array.from,t.toMap=r,t.toSet=o,t.not=function(e){return!e},t.neg=function(e){return-e},t.pow=function(e,t){return Math.pow(e,t)},t.root=function(e,t){return Math.pow(e,1/t)},t.log=function(e,t){return Math.log(e)/Math.log(t)},t.mul=function(e,t){return e*t},t.div=function(e,t){return e/t},t.mod=function(e,t){return(e%t+t)%t},t.rem=function(e,t){return e%t},t.add=function(e,t){return e+t},t.sub=function(e,t){return e-t},t.ceil=function(e){return Math.ceil(e)},t.floor=function(e){return Math.floor(e)},t.round=function(e){return Math.round(e)},t.lt=function(e,t){return Object.compare(e,t)<0},t.gt=function(e,t){return Object.compare(e,t)>0},t.le=function(e,t){return Object.compare(e,t)<=0},t.ge=function(e,t){return Object.compare(e,t)>=0},t.equals=Object.equals,t.compare=Object.compare,t.and=function(e,t){return e&&t},t.or=function(e,t){return e||t},t.defined=function(e){return null!=e},t.startsWith=function(e,t){return new RegExp("^"+RegExp.escape(t)).test(e)},t.endsWith=function(e,t){return new RegExp(RegExp.escape(t)+"$").test(e)},t.contains=function(e,t){return new RegExp(RegExp.escape(t)).test(e)},t.join=function(e,t){return e.join(t||"")},t.split=function(e,t){return e.split(t||"")},t.range=function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t},t.last=function(e){return e.get(e.length-1)}},function(e,t,n){var r=n(39),o=n(40),i=n(41),a=t.tengwar=o.tengwar,u=t.tehtar=o.tehtar,s=t.positions={tinco:{o:3,w:3,others:2},parma:{o:3,w:3,others:2},calma:{o:3,w:3,u:3,"o-below":1,others:2},quesse:{o:3,w:3,"o-below":1,others:2},ando:{wide:!0,e:1,o:2,"":1,"":1,others:0},umbar:{wide:!0,e:1,o:2,"":1,"":1,others:0},anga:{wide:!0,e:1,"":1,"":1,others:0},ungwe:{wide:!0,e:1,o:1,"":1,"":1,others:0},thule:{others:3},formen:3,harma:{e:0,o:3,u:7,"":2,"":2,w:0,others:1},hwesta:{e:0,o:3,u:7,w:0,others:1},anto:{wide:!0,"":1,"":1,others:0},ampa:{wide:!0,"":1,"":1,others:0},anca:{wide:!0,u:7,"":1,"":1,others:0},unque:{wide:!0,u:7,others:0},numen:{wide:!0,"":1,"":1,others:0},malta:{wide:!0,"":1,"":1,others:0},noldo:{wide:!0,"":1,"":1,others:0},nwalme:{wide:!0,"":1,"":1,others:0},ore:{e:3,o:3,u:3,"":3,"":3,others:1},vala:{e:3,o:3,u:3,"":3,"":3,others:1},anna:{e:3,o:3,u:3,"":2,"":2,others:1},wilya:{e:3,o:3,u:3,"":3,"":3,others:1},romen:{e:3,o:3,u:3,"":2,"":2,y:3,"o-below":null,"i-below":3,others:1},arda:{a:1,e:3,i:1,o:3,u:3,"":1,"":2,"":2,y:3,"o-below":null,"i-below":3,others:0},lambe:{wide:!0,e:1,y:4,"":1,"":1,"o-below":null,"i-below":4,others:0},alda:{wide:!0,"o-below":null,others:1},silme:{y:3,"o-below":2,"i-below":2,others:null},"silme-nuquerna":{e:3,o:3,u:3,"":3,"":3,y:null,"o-below":null,"i-below":null,others:1},esse:{y:null,others:null},"esse-nuquerna":{e:3,o:3,u:3,"":3,"":3,others:1},hyarmen:3,"hwesta-sindarinwa":{o:2,u:2,"":1,"":2,others:0},yanta:{e:3,o:3,u:3,"":2,"":2,others:1},ure:{e:3,o:3,u:3,"":3,"":3,others:1},halla:{"i-below":3,others:null},"short-carrier":3,"long-carrier":{y:null,"o-below":null,"i-below":null,others:3},"round-carrier":3,"tinco-extended":3,"parma-extended":3,"calma-extended":{o:3,u:7,"":2,"":2,others:1},"quesse-extended":{o:0,u:7,others:1},"ando-extended":{wide:!0,e:1,o:2,"":1,"":1,others:0},"umbar-extended":{wide:!0,e:1,o:2,"":1,"":1,others:0},"anga-extended":{wide:!0,e:1,"":1,"":1,others:0},"ungwe-extended":{wide:!0,e:1,o:1,"":1,"":1,others:0}};function l(e,t){var n=(t=t||{}).plain||!1,r=e.tengwa||"anna",o=[];e.above&&o.push(e.above),e.below&&o.push(e.below),e.tildeBelow&&o.push("tilde-below"),e.tildeAbove&&o.push("tilde-above"),e.following&&o.push(e.following);var i=a[r]+o.map(function(e){return c(r,e)}).join("");return e.errors&&!n&&(i='<abbr class="error" title="'+e.errors.join("\n").replace(/"/g,"&quot;")+'">'+i+"</abbr>"),i}function c(e,t){var n=function(e,t){if(!u[t])return null;if(u[t].special)return u[t][e]||null;if(-1!==r.barsAndTildes.indexOf(t))return"lambe"===e||"alda"===e&&u[t].length>=2?2:s[e].wide?0:1;return null==s[e]?null:null===s[e][t]?null:null!=s[e][t]?s[e][t]:null!=s[e].others?s[e].others:s[e]}(e,t);return null==n?null:u[t][e]||u[t][n]||""}t.transcribe=function(e,t){var n=(t=t||{}).block||!1,r=n?"<p>":"",o=n?"</p>":"";return e.map(function(e){return e.map(function(e){return r+e.map(function(e){return e.map(function(e){return e.map(function(e){return l(e,t)}).join("")}).join(" ")}).join("<br>\n")+o}).join("\n\n")}).join("\n\n\n")},t.transcribeColumn=l,t.tehtaForTengwa=c,t.makeColumn=function(e,n){return i(t,e,n)}},function(e,t){function n(e,t){return e.split(";").map(function(e){var n=e.split(":"),r=n.shift(),o=n.length?n.shift().split(","):[],i=t(r);return o.forEach(function(e){"tilde-above"===e?i.addTildeAbove():"tilde-below"===e?i.addTildeBelow():"y"===e?i.addBelow("y"):"s"===e||"s-inverse"===e||"s-extended"===e||"s-flourish"===e?"s"!==e||"calma"!==r&&"quesse"!==r?i.addFollowing(e,"s"):i.addBelow(e,"s"):i.addAbove(e,"s")}),i})}t.encode=function(e){return e.map(function(e){return e.map(function(e){return e.map(function(e){return e.map(function(e){return e.map(function(e){var t=[];return e.above&&t.push(e.above),e.below&&t.push(e.below),e.following&&t.push(e.following),e.tildeAbove&&t.push("tilde-above"),e.tildeBelow&&t.push("tilde-below"),t.length?e.tengwa+":"+t.join(","):e.tengwa}).join(";")}).join(" ")}).join("\n")}).join("\n\n")}).join("\n\n\n")},t.decode=function(e,t){return e.split("\n\n\n").map(function(e){return e.split("\n\n").map(function(e){return e.split("\n").map(function(e){return e.split(" ").map(function(e){return n(e,t)})})})})},t.decodeWord=n},function(e,t,n){var r=n(7);e.exports=function(e,t){var n=r.makeDelimitedParser(e,a),o=r.makeDelimitedParser(n,l),i=r.makeDelimitedParser(o,l),u=r.makeDelimitedParser(i,c);return r.makeParser(function(e,n){return n=t(n),u(e,n)})};var o=r.makeExpect(" "),i=r.makeParseAny(o),a=r.makeParseSome(o),u=r.makeExpect("\n"),s=r.makeParseSome(u);function l(e){return i(function(){return u(function(){return i(e)})})}function c(e){return i(function(){return s(function(){return i(e)})})}},function(e,t,n){n(7);var r=n(67),o=n(68);Array.prototype;e.exports=function(e){return function(e){return function t(n){return e=e(n.toLowerCase()),t}}(i(e))};var i=o(r({k:"c",x:"cs",q:"cw",qu:"cw",p:"p",ph:"f",b:"b",bh:"v","":"","":"","":"","":"","":""}),function(e){return function(t){return Array.prototype.reduce.call(e,function(e,t){return e(t)},t)}},function(e){return i(e)},function(e){return function(t){return i(e(t))}})},function(e,t,n){var r=n(7);Array.prototype;e.exports=function(e,t){return o(function(n){return n?function(e,t,n){return r.countPrimes(function(r){return e(function(e,t,n){var r,o,i=n.duodecimal,a=n.font.makeColumn;0==t?o=i?12:10:(o=i?10:12,r=t>1);var u=parseInt(e,10);return(e=u.toString(o).split("")).map(function(e){var t=a(""+parseInt(e,12));return r&&t.addError("Numbers can only be parsed in either decimal or dudecimal."),t})}(t,r,n))})}(e,n.join(""),t):e()})};var o=r.makeParseSome(function(e){return function(t){return""!==t&&-1!=="0123456789".indexOf(t)?e(t):e()(t)}})},function(e,t,n){"use strict";n(27);var r=n(2),o=n(28),i=n(10);e.exports=Array;var a=Array.prototype.splice,u=Array.prototype.slice;function s(e,t){Object.defineProperty(Array.prototype,e,{value:t,writable:!0,configurable:!0,enumerable:!1})}function l(e,t,n){this.array=e,this.start=null==t?0:t,this.end=n}Array.empty=[],Object.freeze&&Object.freeze(Array.empty),Array.from=function(e){var t=[];return t.addEach(e),t},Array.unzip=function(e){for(var t=[],n=1/0,r=0;r<e.length;r++){var o=e[r];e[r]=o.toArray(),o.length<n&&(n=o.length)}for(r=0;r<e.length;r++){o=e[r];for(var i=0;i<o.length;i++)i<n&&i in o&&(t[i]=t[i]||[],t[i][r]=o[i])}return t},s("addEach",r.prototype.addEach),s("deleteEach",r.prototype.deleteEach),s("toArray",r.prototype.toArray),s("toObject",r.prototype.toObject),s("all",r.prototype.all),s("any",r.prototype.any),s("min",r.prototype.min),s("max",r.prototype.max),s("sum",r.prototype.sum),s("average",r.prototype.average),s("only",r.prototype.only),s("flatten",r.prototype.flatten),s("zip",r.prototype.zip),s("enumerate",r.prototype.enumerate),s("group",r.prototype.group),s("sorted",r.prototype.sorted),s("reversed",r.prototype.reversed),s("constructClone",function(e){var t=new this.constructor;return t.addEach(e),t}),s("has",function(e,t){return-1!==this.find(e,t)}),s("get",function(e,t){if(+e!==e)throw new Error("Indicies must be numbers");return!e in this?t:this[e]}),s("set",function(e,t){return this[e]=t,!0}),s("add",function(e){return this.push(e),!0}),s("delete",function(e,t){var n=this.find(e,t);return-1!==n&&(this.splice(n,1),!0)}),s("deleteAll",function(e,t){t=t||this.contentEquals||Object.equals;for(var n=0,r=0;r<this.length;)t(e,this[r])?(this.swap(r,1),n++):r++;return n}),s("find",function(e,t){t=t||this.contentEquals||Object.equals;for(var n=0;n<this.length;n++)if(n in this&&t(e,this[n]))return n;return-1}),s("findLast",function(e,t){t=t||this.contentEquals||Object.equals;var n=this.length;do{if(--n in this&&t(this[n],e))return n}while(n>0);return-1}),s("swap",function(e,t,n){var r,o,i,s,l;if(e>this.length&&(this.length=e),void 0!==n){if(r=[e,t],Array.isArray(n)||(n=u.call(n)),i=0,(o=n.length)<1e3){for(;i<o;i++)r[i+2]=n[i];return a.apply(this,r)}for(l=a.apply(this,r);i<o;){for(r=[e+i,0],s=2;s<1002&&i<o;s++,i++)r[s]=n[i];a.apply(this,r)}return l}return void 0!==t?a.call(this,e,t):void 0!==e?a.call(this,e):[]}),s("peek",function(){return this[0]}),s("poke",function(e){this.length>0&&(this[0]=e)}),s("peekBack",function(){if(this.length>0)return this[this.length-1]}),s("pokeBack",function(e){this.length>0&&(this[this.length-1]=e)}),s("one",function(){for(var e in this)if(Object.owns(this,e))return this[e]}),Array.prototype.clear||s("clear",function(){return this.length=0,this}),s("compare",function(e,t){var n,r,i;if(t=t||Object.compare,this===e)return 0;if(!e||!Array.isArray(e))return o.prototype.compare.call(this,e,t);for(r=Math.min(this.length,e.length),n=0;n<r;n++)if(n in this){if(!(n in e))return-1;if(i=t(this[n],e[n]))return i}else if(n in e)return 1;return this.length-e.length}),s("equals",function(e,t){t=t||Object.equals;var n=0,r=this.length;if(this===e)return!0;if(!e||!Array.isArray(e))return o.prototype.equals.call(this,e);if(r!==e.length)return!1;for(;n<r;++n)if(n in this){if(!(n in e))return!1;if(!t(this[n],e[n]))return!1}else if(n in e)return!1;return!0}),s("clone",function(e,t){if(null==e)e=1/0;else if(0===e)return this;if((t=t||new i).has(this))return t.get(this);var n=new Array(this.length);for(var r in t.set(this,n),this)n[r]=Object.clone(this[r],e-1,t);return n}),s("iterate",function(e,t){return new l(this,e,t)}),s("Iterator",l),l.prototype.next=function(){if(this.start===(null==this.end?this.array.length:this.end))throw StopIteration;return this.array[this.start++]}},function(e,t){e.exports=Function,Function.noop=function(){},Function.identity=function(e){return e},Function.by=function(e,t){t=t||Object.compare,e=e||Function.identity;var n=function(n,r){return t(e(n),e(r))};return n.compare=t,n.by=e,n},Function.get=function(e){return function(t){return Object.get(t,e)}}},function(e,t,n){var r=n(8);function o(){throw new Error("Can't construct. GenericOrder is a mixin.")}e.exports=o,o.prototype.equals=function(e,t){if(t=t||this.contentEquals||r.equals,this===e)return!0;if(!e)return!1;return this.length===e.length&&this.zip(e).every(function(e){return t(e[0],e[1])})},o.prototype.compare=function(e,t){if(t=t||this.contentCompare||r.compare,this===e)return 0;if(!e)return 1;var n=Math.min(this.length,e.length),o=this.zip(e).reduce(function(e,r,o){return 0===e?o>=n?e:t(r[0],r[1]):e},0);return 0===o?this.length-e.length:o},o.prototype.toJSON=function(){return this.toArray()}},function(e,t){if(!RegExp.escape){var n=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(e){return e.replace(n,"\\$&")}}},function(e,t,n){"use strict";var r=n(8),o=n(16),i=n(1);function a(){throw new Error("Can't construct. GenericMap is a mixin.")}function u(e,t){this.key=e,this.value=t}e.exports=a,r.addEach(a.prototype,o.prototype),r.addEach(a.prototype,i.prototype),a.prototype.isMap=!0,a.prototype.addEach=function(e){if(e&&r(e)===e)if("function"==typeof e.forEach)!0===e.isMap?e.forEach(function(e,t){this.set(t,e)},this):e.forEach(function(e){this.set(e[0],e[1])},this);else if("number"==typeof e.length)for(var t=0;t<e.length;t++)this.add(e[t],t);else r.keys(e).forEach(function(t){this.set(t,e[t])},this);else if(e&&"number"==typeof e.length)for(t=0;t<e.length;t++)this.add(e[t],t);return this},a.prototype.get=function(e,t){var n=this.store.get(new this.Item(e));return n?n.value:arguments.length>1?t:this.getDefault(e)},a.prototype.set=function(e,t){var n=new this.Item(e,t),r=this.store.get(n),o=!1;return r?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,r.value),r.value=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t)):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,void 0),this.store.add(n)&&(this.length++,o=!0),this.dispatchesMapChanges&&this.dispatchMapChange(e,t)),o},a.prototype.add=function(e,t){return this.set(t,e)},a.prototype.has=function(e){return this.store.has(new this.Item(e))},a.prototype.delete=function(e){var t=new this.Item(e);if(this.store.has(t)){var n=this.store.get(t).value;return this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,n),this.store.delete(t),this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0}return!1},a.prototype.clear=function(){var e;this.dispatchesMapChanges&&(this.forEach(function(e,t){this.dispatchBeforeMapChange(t,e)},this),e=this.keys()),this.store.clear(),this.length=0,this.dispatchesMapChanges&&e.forEach(function(e){this.dispatchMapChange(e)},this)},a.prototype.reduce=function(e,t,n){return this.store.reduce(function(t,r){return e.call(n,t,r.value,r.key,this)},t,this)},a.prototype.reduceRight=function(e,t,n){return this.store.reduceRight(function(t,r){return e.call(n,t,r.value,r.key,this)},t,this)},a.prototype.keys=function(){return this.map(function(e,t){return t})},a.prototype.values=function(){return this.map(Function.identity)},a.prototype.entries=function(){return this.map(function(e,t){return[t,e]})},a.prototype.items=function(){return this.entries()},a.prototype.equals=function(e,t){return t=t||r.equals,this===e||(e&&"function"==typeof e.every?e.length===this.length&&e.every(function(e,n){return t(this.get(n),e)},this):r.keys(e).length===this.length&&r.keys(e).every(function(n){return t(this.get(n),e[n])},this))},a.prototype.toJSON=function(){return this.entries()},a.prototype.Item=u,u.prototype.equals=function(e){return r.equals(this.key,e.key)&&r.equals(this.value,e.value)},u.prototype.compare=function(e){return r.compare(this.key,e.key)}},function(e,t,n){"use strict";function r(){}e.exports=r,r.ascii={intersection:"+",through:"-",branchUp:"+",branchDown:"+",fromBelow:".",fromAbove:"'",fromBoth:"+",strafe:"|"},r.unicodeRound={intersection:"",through:"",branchUp:"",branchDown:"",fromBelow:"",fromAbove:"",fromBoth:"",strafe:""},r.unicodeSharp={intersection:"",through:"",branchUp:"",branchDown:"",fromBelow:"",fromAbove:"",fromBoth:"",strafe:""}},function(e,t,n){"use strict";n(5);var r=n(19).precedence,o=n(19).operatorTypes;n(19).operatorTokens;function i(e,t){return i.semantics.stringify(e,t)}function a(e){return function(t,n,r){var o=e+"{"+r(t.args[1],n)+"}";return"value"===t.args[0].type?o:r(t.args[0],n)+"."+o}}e.exports=i,i.semantics={makeBlockStringifier:a,stringify:function(e,t,n){var o,i=this.stringify.bind(this),a=this.stringifiers;function u(e){var n=i(e,t);return n||"this"}if(a[e.type])o=a[e.type](e,t,i);else if(e.inline)o="&"+e.type+"("+e.args.map(u).join(", ")+")";else{var s;1===e.args.length&&"mapBlock"===e.args[0].type?(s=e.type+"{"+i(e.args[0].args[1],t)+"}",e=e.args[0]):s=e.type+"("+e.args.slice(1).map(u).join(", ")+")",o="value"===e.args[0].type?s:i(e.args[0],t)+"."+s}return!n||n.type===e.type&&"if"!==n.type||r.get(n.type).has(e.type)?o:"("+o+")"},stringifiers:{value:function(e,t,n){return""},literal:function(e,t,n){return"string"==typeof e.value?"'"+e.value.replace("'","\\'")+"'":""+e.value},parameters:function(e,t,n){return"$"},record:function(e,t,n){return"{"+Object.map(e.args,function(e,r){return r+": "+("value"===e.type?"this":n(e,t))}).join(", ")+"}"},tuple:function(e,t,n){return"["+Object.map(e.args,function(e){return"value"===e.type?"this":n(e)}).join(", ")+"]"},component:function(e,t){var n;return t&&t.components&&e.component?t.components.getObjectLabel?n=t.components.getObjectLabel(e.component):t.components.getLabelForObject&&(n=t.components.getLabelForObject(e.component)):n=e.label,"@"+n},element:function(e){return"#"+e.id},mapBlock:a("map"),filterBlock:a("filter"),someBlock:a("some"),everyBlock:a("every"),sortedBlock:a("sorted"),sortedSetBlock:a("sortedSet"),groupBlock:a("group"),groupMapBlock:a("groupMap"),minBlock:a("min"),maxBlock:a("max"),property:function(e,t,n){return"value"===e.args[0].type?"string"==typeof e.args[1].value?e.args[1].value:"literal"===e.args[1].type?"."+e.args[1].value:"this["+n(e.args[1],t)+"]":"parameters"===e.args[0].type?"$"+e.args[1].value:"literal"===e.args[1].type&&/^[\w\d_]+$/.test(e.args[1].value)?n(e.args[0],t,{type:"scope"})+"."+e.args[1].value:n(e.args[0],{type:"scope"},t)+"["+n(e.args[1],t)+"]"},with:function(e,t,n){var r=n(e.args[1],t,e);return n(e.args[0],t)+"."+r},not:function(e,t,n){return"equals"===e.args[0].type?n(e.args[0].args[0],t,{type:"equals"})+" != "+n(e.args[0].args[1],t,{type:"equals"}):"!"+n(e.args[0],t,e)},neg:function(e,t,n){return"-"+n(e.args[0],t,e)},toNumber:function(e,t,n){return"+"+n(e.args[0],t,e)},parent:function(e,t,n){return"^"+n(e.args[0],t,e)},if:function(e,t,n){return n(e.args[0],t,e)+" ? "+n(e.args[1],t)+" : "+n(e.args[2],t)},event:function(e,t,n){return e.when+" "+e.event+" -> "+n(e.listener,t)},binding:function(e,t,n,r){var o=r(t.args[0],n)+" "+e+" "+r(t.args[1],n),i="",a=t.descriptor;if(a)for(var u in a)i+=", "+u+": "+r(a[u],n);return o+i},bind:function(e,t,n){return this.binding("<-",e,t,n)},bind2:function(e,t,n){return this.binding("<->",e,t,n)},assign:function(e,t,n){return n(e.args[0],t)+": "+n(e.args[1],t)},block:function(e,t,n){var r="@"+e.label;return e.connection&&("prototype"===e.connection?r+=" < ":"object"===e.connection&&(r+=" : "),r+=n({type:"literal",value:e.module}),e.exports&&"value"!==e.exports.type&&(r+=" "+n(e.exports,t))),r+" {\n"+e.statements.map(function(e){return"    "+n(e,t)+";\n"}).join("")+"}\n"},sheet:function(e,t,n){return"\n"+e.blocks.map(function(e){return n(e,t)}).join("\n")+"\n"}}},o.forEach(function(e,t){i.semantics.stringifiers[t]=function(t,n,r){return t.args.map(function(e){return r(e,n,t)}).join(" "+e+" ").trim()}})},function(e,t,n){n(0);n(13);var r,o=n(1),i=n(4),a=n(16),u=(Array.prototype.splice,Array.prototype.slice),s=(Array.prototype.reverse,Array.prototype.sort),l=Array.prototype.swap,c=Array.prototype.push;function h(e){for(var t in e)Object.defineProperty(Array.prototype,t,{value:e[t],writable:!0,configurable:!0,enumerable:!1})}r={}.__proto__===Object.prototype?function(){this.__proto__=p}:function(){Object.defineProperties(this,f)},Object.defineProperty(Array.prototype,"makeObservable",{value:r,writable:!0,configurable:!0,enumerable:!1}),h(o.prototype),Object.defineProperty(Array.prototype,"makePropertyObservable",{value:function(){},writable:!0,configurable:!0,enumerable:!1}),h(i.prototype),h(a.prototype);var f={isObservable:{value:!0,writable:!0,configurable:!0},makeObservable:{value:Function.noop,writable:!0,configurable:!0},reverse:{value:function(){var e=this.constructClone(this);return e.reverse(),this.swap(0,this.length,e),this},writable:!0,configurable:!0},sort:{value:function(){var e,t;for(this.dispatchBeforeRangeChange(this,this,0),e=0,t=this.length;e<t;e++)o.dispatchBeforeOwnPropertyChange(this,e,this[e]),this.dispatchBeforeMapChange(e,this[e]);for(s.apply(this,arguments),e=0,t=this.length;e<t;e++)o.dispatchOwnPropertyChange(this,e,this[e]),this.dispatchMapChange(e,this[e]);return this.dispatchRangeChange(this,this,0),this},writable:!0,configurable:!0},_dispatchBeforeOwnPropertyChange:{value:function(e,t){for(var n=e,r=e+t;n<r;n++)o.dispatchBeforeOwnPropertyChange(this,n,this[n]),this.dispatchBeforeMapChange(n,this[n])}},_dispatchOwnPropertyChange:{value:function(e,t){for(var n=e,r=e+t;n<r;n++)this.dispatchOwnPropertyChange(n,this[n]),this.dispatchMapChange(n,this[n])}},swap:{value:function(e,t,n){var r,i,a,s;if(n?Array.isArray(n)||(n=u.call(n)):n=Array.empty,e<0)e=this.length+e;else if(e>this.length){var c=e-this.length,h=Array(c+n.length);for(i=0,a=c;i<n.length;i++,a++)i in n&&(h[a]=n[i]);n=h,e=this.length}if(0===t){if(0===n.length)return[];s=Array.empty}else s=u.call(this,e,e+t);var f=n.length-s.length,p=this.length,d=Math.max(this.length+f,e+n.length),g=Math.max(p,d);f&&o.dispatchBeforeOwnPropertyChange(this,"length",this.length),this.dispatchBeforeRangeChange(n,s,e),0===f?this._dispatchBeforeOwnPropertyChange(e,n.length):(r=o.hasOwnPropertyChangeDescriptor(this))&&this._dispatchBeforeOwnPropertyChange(e,g-e),e>p&&(this.length=e);var m=l.call(this,e,t,n);return 0===f?this._dispatchOwnPropertyChange(e,n.length):r&&this._dispatchOwnPropertyChange(e,g-e),this.dispatchRangeChange(n,s,e),f&&this.dispatchOwnPropertyChange("length",this.length),m},writable:!0,configurable:!0},splice:{value:function(e,t){return e>this.length&&(e=this.length),this.swap.call(this,e,t,u.call(arguments,2))},writable:!0,configurable:!0},set:{value:function(e,t){return this.swap(e,e>=this.length?0:1,[t]),!0},writable:!0,configurable:!0},shift:{value:function(){return this.splice(0,1)[0]},writable:!0,configurable:!0},pop:{value:function(){if(this.length)return this.splice(this.length-1,1)[0]},writable:!0,configurable:!0},push:{value:function(e){var t,n,r=this.length,i=arguments.length;t=1===i?[arguments[0]]:Array.apply(null,arguments),i>0&&(o.dispatchBeforeOwnPropertyChange(this,"length",r),this.dispatchBeforeRangeChange(t,Array.empty,r),(n=o.hasOwnPropertyChangeDescriptor(this))&&this._dispatchBeforeOwnPropertyChange(r,i)),c.apply(this,arguments),i>0&&(n&&this._dispatchOwnPropertyChange(r,i),this.dispatchRangeChange(t,Array.empty,r),this.dispatchOwnPropertyChange("length",this.length))},writable:!0,configurable:!0},unshift:{value:function(e){if(1===arguments.length)return this.splice(0,0,e);var t=u.call(arguments);return this.swap(0,0,t)},writable:!0,configurable:!0},clear:{value:function(){return this.splice(0,this.length)},writable:!0,configurable:!0}},p=Object.create(Array.prototype,f);t.observableArrayProperties=f},function(e,t,n){"use strict";e.exports=s;n(0);var r=n(2),o=n(17),i=n(1),a=n(4),u=n(31);function s(e,t,n,r){if(!(this instanceof s))return new s(e,t,n,r);this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.getDefault=r||Function.noop,this.root=null,this.length=0,this.addEach(e)}function l(e){this.value=e,this.left=null,this.right=null,this.length=1}function c(e,t,n){if(this.set=e,this.prev=null,this.end=n,t){var r=this.set.findLeastGreaterThanOrEqual(t);r&&(this.set.splay(r.value),this.prev=r.getPrevious())}}s.SortedSet=s,Object.addEach(s.prototype,r.prototype),Object.addEach(s.prototype,o.prototype),Object.addEach(s.prototype,i.prototype),Object.addEach(s.prototype,a.prototype),s.prototype.isSorted=!0,s.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare,this.getDefault)},s.prototype.has=function(e,t){if(t)throw new Error("SortedSet#has does not support second argument: equals");return!!this.root&&(this.splay(e),this.contentEquals(e,this.root.value))},s.prototype.get=function(e,t){if(t)throw new Error("SortedSet#get does not support second argument: equals");return this.root&&(this.splay(e),this.contentEquals(e,this.root.value))?this.root.value:this.getDefault(e)},s.prototype.add=function(e){var t=new this.Node(e);if(!this.root)return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],0),this.root=t,this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],0),!0;if(this.splay(e),!this.contentEquals(e,this.root.value)){var n=this.contentCompare(e,this.root.value);if(0===n)throw new Error("SortedSet cannot contain incomparable but inequal values: "+e+" and "+this.root.value);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],this.root.index),n<0?(t.right=this.root,t.left=this.root.left,this.root.left=null,this.root.touch()):(t.left=this.root,t.right=this.root.right,this.root.right=null,this.root.touch()),t.touch(),this.root=t,this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],this.root.index),!0}return!1},s.prototype.delete=function(e,t){if(t)throw new Error("SortedSet#delete does not support second argument: equals");if(this.root&&(this.splay(e),this.contentEquals(e,this.root.value))){var n=this.root.index;if(this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],n),this.root.left){var r=this.root.right;this.root=this.root.left,this.splay(e),this.root.right=r}else this.root=this.root.right;return this.length--,this.root&&this.root.touch(),this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],n),!0}return!1},s.prototype.indexOf=function(e,t){if(t)throw new Error("SortedSet#indexOf does not support second argument: startIndex");return this.root&&(this.splay(e),this.contentEquals(e,this.root.value))?this.root.index:-1},s.prototype.find=function(e,t,n){if(t)throw new Error("SortedSet#find does not support second argument: equals");if(n)throw new Error("SortedSet#find does not support third argument: index");if(this.root&&(this.splay(e),this.contentEquals(e,this.root.value)))return this.root},s.prototype.findGreatest=function(e){if(this.root){for(e=e||this.root;e.right;)e=e.right;return e}},s.prototype.findLeast=function(e){if(this.root){for(e=e||this.root;e.left;)e=e.left;return e}},s.prototype.findGreatestLessThanOrEqual=function(e){if(this.root)return this.splay(e),this.contentCompare(this.root.value,e)>0?this.root.getPrevious():this.root},s.prototype.findGreatestLessThan=function(e){if(this.root)return this.splay(e),this.contentCompare(this.root.value,e)>=0?this.root.getPrevious():this.root},s.prototype.findLeastGreaterThanOrEqual=function(e){if(this.root)return this.splay(e),this.contentCompare(this.root.value,e)>=0?this.root:this.root.getNext()},s.prototype.findLeastGreaterThan=function(e){if(this.root)return this.splay(e),this.contentCompare(this.root.value,e)<=0?this.root.getNext():this.root},s.prototype.pop=function(){if(this.root){var e=this.findGreatest();return this.delete(e.value),e.value}},s.prototype.shift=function(){if(this.root){var e=this.findLeast();return this.delete(e.value),e.value}},s.prototype.push=function(){this.addEach(arguments)},s.prototype.unshift=function(){this.addEach(arguments)},s.prototype.slice=function(e,t){e=e||0,t=t||this.length,e<0&&(e+=this.length),t<0&&(t+=this.length);var n=[];if(this.root)for(this.splayIndex(e);this.root.index<t&&(n.push(this.root.value),this.root.right);)this.splay(this.root.getNext().value);return n},s.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},s.prototype.swap=function(e,t,n){if(void 0===e&&void 0===t)return[];(e=e||0)<0&&(e+=this.length),void 0===t&&(t=1/0);var r=[];if(this.root){this.splayIndex(e);for(var o=0;o<t;o++){r.push(this.root.value);var i=this.root.getNext();if(this.delete(this.root.value),!i)break;this.splay(i.value)}}return this.addEach(n),r},s.prototype.splay=function(e){var t,n,r,o,i,a;if(this.root){for(t=n=r=new this.Node,a=new this.Node,i=this.root;;){var u=this.contentCompare(e,i.value);if(u<0){if(!i.left)break;if(this.contentCompare(e,i.left.value)<0&&(o=i.left,i.left=o.right,i.touch(),o.right=i,o.touch(),!(i=o).left))break;(o=new l).right=i,o.left=a.left,a.left=o,r.left=i,r.touch(),r=i,i=i.left}else{if(!(u>0))break;if(!i.right)break;if(this.contentCompare(e,i.right.value)>0&&(o=i.right,i.right=o.left,i.touch(),o.left=i,o.touch(),!(i=o).right))break;(o=new l).left=i,o.right=a.right,a.right=o,n.right=i,n.touch(),n=i,i=i.right}}for(n.right=i.left,n.touch(),r.left=i.right,r.touch(),i.left=t.right,i.right=t.left;a.left;)a.left.right.touch(),a.left=a.left.left;for(;a.right;)a.right.left.touch(),a.right=a.right.right;i.touch(),this.root=i}},s.prototype.splayIndex=function(e){if(this.root){for(var t=this.root,n=this.root.index;n!==e;)if(n>e&&t.left)n-=1+((t=t.left).right?t.right.length:0);else{if(!(n<e&&t.right))break;n+=1+((t=t.right).left?t.left.length:0)}return this.splay(t.value),this.root.index===e}return!1},s.prototype.reduce=function(e,t,n){return this.root&&(t=this.root.reduce(e,t,0,n,this)),t},s.prototype.reduceRight=function(e,t,n){return this.root&&(t=this.root.reduceRight(e,t,this.length-1,n,this)),t},s.prototype.min=function(e){var t=this.findLeast(e);if(t)return t.value},s.prototype.max=function(e){var t=this.findGreatest(e);if(t)return t.value},s.prototype.one=function(){return this.min()},s.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange([],e,0)),this.root=null,this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange([],e,0)},s.prototype.iterate=function(e,t){return new this.Iterator(this,e,t)},s.prototype.Iterator=c,s.prototype.summary=function(){return this.root?this.root.summary():"()"},s.prototype.log=function(e,t,n,r){e=e||u.unicodeRound,t=t||this.logNode,n||(n=console.log,r=console),n=n.bind(r),this.root&&this.root.log(e,t,n,n)},s.prototype.logNode=function(e,t,n){t(" "+e.value)},s.logCharsets=u,s.prototype.Node=l,l.prototype.reduce=function(e,t,n,r,o,i){if(i=i||0,this.left){var a=this.left.length;t=this.left.reduce(e,t,n,r,o,i+1),n+=a}return t=e.call(r,t,this.value,n,o,this,i),n+=1,this.right&&(t=this.right.reduce(e,t,n,r,o,i+1)),t},l.prototype.reduceRight=function(e,t,n,r,o,i){return i=i||0,this.right&&(t=this.right.reduce(e,t,n,r,o,i+1),n-=this.right.length),t=e.call(r,t,this.value,this.value,o,this,i),n-=1,this.left&&(t=this.left.reduce(e,t,n,r,o,i+1)),t},l.prototype.touch=function(){this.length=1+(this.left?this.left.length:0)+(this.right?this.right.length:0),this.index=this.left?this.left.length:0},l.prototype.checkIntegrity=function(){var e=1;if(e+=this.left?this.left.checkIntegrity():0,e+=this.right?this.right.checkIntegrity():0,this.length!==e)throw new Error("Integrity check failed: "+this.summary());return e},l.prototype.getNext=function(){var e=this;if(e.right){for(e=e.right;e.left;)e=e.left;return e}},l.prototype.getPrevious=function(){var e=this;if(e.left){for(e=e.left;e.right;)e=e.right;return e}},l.prototype.summary=function(){var e=this.value||"-";return e+=" <"+this.length,this.left||this.right?"("+e+" "+(this.left?this.left.summary():"()")+", "+(this.right?this.right.summary():"()")+")":"("+e+")"},l.prototype.log=function(e,t,n,r){var o,i,a,u,s=this;o=this.left&&this.right?e.intersection:this.left?e.branchUp:this.right?e.branchDown:e.through,this.left&&this.left.log(e,t,function(t){i?r(e.strafe+" "+t):(i=!0,r(e.fromBelow+e.through+t))},function(e){r("  "+e)}),t(this,function(t){a?n((s.right?e.strafe:" ")+t):(a=!0,n(o+t))},function(t){r((s.left?e.strafe:" ")+t)}),this.right&&this.right.log(e,t,function(t){u?n("  "+t):(u=!0,n(e.fromAbove+e.through+t))},function(t){n(e.strafe+" "+t)})},c.prototype.next=function(){var e;if(!(e=this.prev?this.set.findLeastGreaterThan(this.prev.value):this.set.findLeast()))throw StopIteration;if(void 0!==this.end&&this.set.contentCompare(e.value,this.end)>=0)throw StopIteration;return this.prev=e,e.value}},function(e,t,n){var r=n(9),o=(n(6),n(36)),i=n(18),a={type:"value"},u={type:"literal",value:!0};function s(e){return s.semantics.compile(e)}e.exports=s,s.semantics={compilers:{property:o.makePropertyBinder,get:o.makeGetBinder,has:o.makeHasBinder,only:o.makeOnlyBinder,one:o.makeOneBinder,rangeContent:o.makeRangeContentBinder,mapContent:o.makeMapContentBinder,reversed:o.makeReversedBinder,and:o.makeAndBinder,or:o.makeOrBinder},compile:function(e){var t=this.compilers;if("default"===e.type)return this.compile(e.args[0]);if("literal"===e.type){if(null==e.value)return Function.noop;throw new Error("Can't bind to literal: "+e.value)}if("equals"===e.type){var n=this.compile(e.args[0]),s=r(e.args[1]);return o.makeEqualityBinder(n,s)}if("if"===e.type){var l=r(e.args[0]),c=this.compile(e.args[1]),h=this.compile(e.args[2]);return o.makeConditionalBinder(l,c,h)}if("and"===e.type||"or"===e.type){var f=i(e.args[0],a),p=i(e.args[1],a),d=(n=this.compile(f[0]),this.compile(p[0])),g=r(f[1]),m=r(p[1]),v=r(e.args[0]);s=r(e.args[1]);return this.compilers[e.type](n,d,v,s,g,m)}if("everyBlock"===e.type){var y=r(e.args[0]),b=i(e.args[1],u),w=this.compile(b[0]),O=r(b[1]);return o.makeEveryBlockBinder(y,w,O)}if("rangeContent"===e.type){var C=r(e.args[0]);try{A=this.compile(e.args[0])}catch(e){A=Function.noop}return o.makeRangeContentBinder(C,A)}if("defined"===e.type){var A=this.compile(e.args[0]);return o.makeDefinedBinder(A)}if("parent"===e.type){A=this.compile(e.args[0]);return o.makeParentBinder(A)}if("with"===e.type){C=r(e.args[0]),A=this.compile(e.args[1]);return o.makeWithBinder(C,A)}if(t.hasOwnProperty(e.type)){var E=e.args.map(r,r.semantics);return t[e.type].apply(null,E)}throw new Error("Can't compile binder for "+JSON.stringify(e.type))}}},function(e,t,n){var r=n(3),o=n(6),i=o.autoCancelPrevious,a=o.observeRangeChange,u=o.cancelEach,s=o.makeNotObserver,l=o.makeOrObserver,c=o.makeAndObserver,h=(o.observeValue,o.makeLiteralObserver()),f=new r(!0),p=new r(!1);function d(){return new Error("").stack.replace(/^.*\n.*\n/,"\n")}t.bindProperty=m;var g=m;function m(e,t,n,r,o,a){return n(i(function(n){if(!o.isActive)try{o.isActive=!0,a&&console.log("SET",a.targetPath,"TO",n,"ON",e,"BECAUSE",a.sourcePath,d()),Array.isArray(e)&&t>>>0===t?e.set(t,n):e[t]=n}finally{o.isActive=!1}}),r)}t.makePropertyBinder=function(e,t){return function(n,r,o,a,u){return t(i(function(t){if(null!=t)return e(i(function(e){if(null!=e)return e.bindProperty?e.bindProperty(t,n,r,a,u):g(e,t,n,r,a,u)}),o)}),o)}},t.bindGet=y;var v=y;function y(e,t,n,r,o,a){return n(i(function(n){if(!o.isActive)try{o.isActive=!0,a&&console.log("SET FOR KEY",t,"TO",n,"ON",e,"BECAUSE",a.sourcePath,d()),e.set(t,n)}finally{o.isActive=!1}}),r)}function b(e){return e.getRangeChangeDescriptor&&e.getRangeChangeDescriptor().isActive}t.makeGetBinder=function(e,t){return function(n,r,o,a,u){return e(i(function(e){if(e)return t(i(function(t){if(null!=t)return v(e,t,n,r,a,u)}),o)}),o)}},t.makeHasBinder=function(e,t){return function(n,r,o,a,u){return e(i(function(e){if(e)return t(i(function(t){if(null!=t)return n(i(function(n){if(n)(e.has||e.contains).call(e,t)||(u&&console.log("ADD",t,"TO",u.targetPath,"BECAUSE",u.sourcePath,d()),e.add(t));else for(;(e.has||e.contains).call(e,t);)u&&console.log("REMOVE",t,"FROM",u.targetPath,"BECAUSE",u.sourcePath,d()),(e.remove||e.delete).call(e,t)}),r)}),o)}),o)}},t.makeEqualityBinder=function(e,t){return function(n,r,o,a,u){return n(i(function(n){if(n){u&&console.log("BIND",u.targetPath,"TO",u.sourcePath,d());e(t,r,r,a,u);return function(){u&&console.log("UNBIND",u.targetPath,"FROM",u.sourcePath,d())}}}),o)}},t.makeEveryBlockBinder=function(e,t,n){return function(r,o,s,l,c){return r(i(function(r){if(r)return e(i(function(e){if(e){var r=[],o=a(e,function(e,o,i){u(r.slice(i,i+o.length)),r.swap(i,o.length,e.map(function(e,r){var o=s.nest(e);return t(n,o,o,l,c)}))},s);return function(){u(r),o()}}}),s)}),o)}},t.makeAndBinder=function(e,t,n,r,o,a){var u=s(r),l=c(n,u);return function(n,r,u,s,c){return n(i(function(n){if(null!=n){if(n){var r=e(o,f,u,s,c),i=t(a,f,u,s,c);return function(){r(),i()}}return e(l,u,u,s,c)}}),r)}},t.makeOrBinder=function(e,t,n,r,o,a){var u=s(r),c=l(n,u);return function(n,r,u,s,l){return n(i(function(n){if(null!=n){if(n)return e(c,u,u,s,l);var r=e(o,p,u,s,l),i=t(a,p,u,s,l);return function(){r(),i()}}}),r)}},t.makeConditionalBinder=function(e,t,n){return function(r,o,a,u,s){return e(i(function(e){if(null!=e)return e?t(r,o,a,u,s):n(r,o,a,u,s)}),o)}},t.makeOnlyBinder=function(e){return function(t,n,r,o,a){return e(i(function(e){if(e)return t(i(function(t){null!=t&&(e.splice?e.splice(0,e.length,t):e.clear&&e.add&&(e.clear(),e.add(t)))}),n)}),r)}},t.makeOneBinder=function(e){return function(t,n,r,o,a){return e(i(function(e){if(e)return t(i(function(t){null!=t&&t!==e.one()&&(e.splice?e.splice(0,e.length,t):e.clear&&e.add&&(e.clear(),e.add(t)))}),n)}),r)}},t.makeRangeContentBinder=function(e,t){return function(n,r,a,u,s){return e(i(function(e){return e?n(i(function(t){if(t!==e)if(t){if(t.addRangeChangeListener)return t.addRangeChangeListener(n),n(Array.from(t),Array.from(e),0),function(){t.removeRangeChangeListener(n)}}else e.clear();function n(t,n,r){b(e)||(s&&console.log("SWAPPING",n,"FOR",t,"AT",r,"ON",s.targetPath,d()),e.swap?e.swap(r,n.length,t):e.add&&(e.remove||e.delete)&&(t.forEach(e.add,e),n.forEach(e.remove||e.delete,e)))}}),r):t(o.makeLiteralObserver([]),r,a,u,s)}),a)}},t.makeMapContentBinder=function(e){return function(t,n,r,o,a){return e(i(function(e){if(e)return t(i(function(t){if(t)return e.clear(),t.forEach(n),t.addMapChangeListener(n);function n(t,n){if(!o.isActive)try{o.isActive=!0,void 0===t?(a&&a&&console.log("DELETED",a.targetPath,"FOR KEY",n,"ON",e,"BECAUSE",a.sourcePath,d()),Array.isArray(e)?e.splice(n,1):e.delete(n)):(a&&a&&console.log("SET",a.targetPath,"FOR KEY",n,"TO",t,"ON",e,"BECAUSE",a.sourcePath,d()),e.set(n,t))}finally{o.isActive=!1}}e.clear()}),n)}),r)}},t.makeReversedBinder=function(e){return function(t,n,r,o,a){return e(i(function(e){if(e)return t(i(function(t){if(t)return t.addRangeChangeListener(n),n(t,e,0),function(){t.removeRangeChangeListener(n)};function n(t,n,r){if(!b(e)){var o=e.length-r-n.length;e.swap(o,n.length,t.reversed())}}e.clear()}),n)}),r)}},t.makeDefinedBinder=function(e){return function(t,n,r,o,a){return t(i(function(t){return t?Function.noop:e(h,n,r,o,a)}),r)}},t.makeParentBinder=function(e){return function(t,n,r,o,i){if(r.parent)return e(t,n,r.parent,o,i)}},t.makeWithBinder=function(e,t){return function(n,r,o,a,u){return e(i(function(e){if(null!=e)return t(n,r,o.nest(e),a,u)}),o)}}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(59),o=n(60),i=n(61);function a(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=s.prototype:(null===e&&(e=new s(t)),e.length=t),e}function s(e,t,n){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);s.TYPED_ARRAY_SUPPORT?(e=t).__proto__=s.prototype:e=f(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!s.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(t,n),o=(e=u(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(s.isBuffer(t)){var n=0|p(t.length);return 0===(e=u(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?u(e,0):f(e,t);if("Buffer"===t.type&&i(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(c(t),e=u(e,t<0?0:0|p(t)),!s.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|p(t.length);e=u(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function d(e,t){if(s.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return j(this,t,n);case"utf8":case"utf-8":return B(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,o);if("number"==typeof t)return t&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,o){var i,a=1,u=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,u/=2,s/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var c=-1;for(i=n;i<u;i++)if(l(e,i)===l(t,-1===c?0:i-c)){if(-1===c&&(c=i),i-c+1===s)return c*a}else-1!==c&&(i-=i-c),c=-1}else for(n+s>u&&(n=u-s),i=n;i>=0;i--){for(var h=!0,f=0;f<s;f++)if(l(e,i+f)!==l(t,f)){h=!1;break}if(h)return i}return-1}function b(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))return a;e[n+a]=u}return a}function w(e,t,n,r){return H(U(t,e.length-n),e,n,r)}function O(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function C(e,t,n,r){return O(e,t,n,r)}function A(e,t,n,r){return H(Y(t),e,n,r)}function E(e,t,n,r){return H(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function B(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,u,s,l=e[o],c=null,h=l>239?4:l>223?3:l>191?2:1;if(o+h<=n)switch(h){case 1:l<128&&(c=l);break;case 2:128==(192&(i=e[o+1]))&&(s=(31&l)<<6|63&i)>127&&(c=s);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(s=(15&l)<<12|(63&i)<<6|63&a)>2047&&(s<55296||s>57343)&&(c=s);break;case 4:i=e[o+1],a=e[o+2],u=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&u)&&(s=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&u)>65535&&s<1114112&&(c=s)}null===c?(c=65533,h=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),o+=h}return function(e){var t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=x));return n}(r)}t.Buffer=s,t.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},t.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),s.poolSize=8192,s._augment=function(e){return e.__proto__=s.prototype,e},s.from=function(e,t,n){return l(null,e,t,n)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?u(e,t):void 0!==n?"string"==typeof r?u(e,t).fill(n,r):u(e,t).fill(n):u(e,t)}(null,e,t,n)},s.allocUnsafe=function(e){return h(null,e)},s.allocUnsafeSlow=function(e){return h(null,e)},s.isBuffer=function(e){return!(null==e||!e._isBuffer)},s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=s.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!s.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},s.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?B(this,0,e):g.apply(this,arguments)},s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},s.prototype.compare=function(e,t,n,r,o){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(i,a),l=this.slice(r,o),c=e.slice(t,n),h=0;h<u;++h)if(l[h]!==c[h]){i=l[h],a=c[h];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return O(this,e,t,n);case"latin1":case"binary":return C(this,e,t,n);case"base64":return A(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function P(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function j(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=I(e[i]);return o}function _(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function T(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function S(e,t,n,r,o,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function M(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function q(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,r,i){return i||q(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,i){return i||q(e,0,n,8),o.write(e,t,n,r,52,8),n+8}s.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),s.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=s.prototype;else{var o=t-e;n=new s(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},s.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},s.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},s.prototype.readUInt8=function(e,t){return t||T(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return t||T(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return t||T(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){t||T(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){t||T(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return t||T(e,4,this.length),o.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return t||T(e,4,this.length),o.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return t||T(e,8,this.length),o.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return t||T(e,8,this.length),o.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||S(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||S(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,1,255,0),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);S(this,e,t,n,o-1,-o)}var i=0,a=1,u=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);S(this,e,t,n,o-1,-o)}var i=n-1,a=1,u=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,1,127,-128),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},s.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!s.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=s.isBuffer(e)?e:U(new s(e,r).toString()),u=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%u]}return this};var D=/[^+\/0-9A-Za-z-_]/g;function I(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Y(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(58))},function(e,t,n){var r=n(39),o=n(40),i=n(41),a=t.tengwar=o.tengwar,u=t.tehtar=o.tehtar,s=t.positions={tinco:2,parma:2,calma:{y:1,"o-below":1,others:2},quesse:{y:1,"o-below":1,others:2},ando:{wide:!0,others:0},umbar:{wide:!0,others:0},anga:{wide:!0,others:0},ungwe:{wide:!0,others:0},thule:{a:3,w:3,others:2},formen:{a:3,w:3,"":3,others:2},harma:{a:0,e:0,i:1,o:1,u:1,w:0,"":0,others:1},hwesta:{a:0,e:0,i:1,o:1,u:1,w:0,others:1},anto:{wide:!0,others:0},ampa:{wide:!0,others:0},anca:{wide:!0,others:0},unque:{wide:!0,others:0},numen:{wide:!0,others:0},malta:{wide:!0,others:0},noldo:{wide:!0,others:0},nwalme:{wide:!0,others:0},ore:{a:1,e:2,i:1,o:2,u:3,others:1},vala:{a:1,e:2,i:2,o:2,w:1,y:1,"":2,"i-below":1,others:3},anna:{a:1,w:3,others:2},wilya:{i:2,"":2,others:1},romen:{a:1,e:1,i:2,o:1,u:1,y:3,"o-below":null,"i-below":3,others:1},arda:{a:1,e:1,i:2,o:1,u:1,w:1,"":2,y:3,"o-below":null,"i-below":3,others:0},lambe:{wide:!0,e:1,y:4,w:0,"o-below":null,"i-below":4,others:0},alda:{wide:!0,w:0,y:null,"o-below":null,"i-below":null,others:1},silme:{y:2,"o-below":2,"i-below":2,others:null},"silme-nuquerna":{e:2,y:null,"o-below":null,"i-below":null,others:1},esse:{others:null},"esse-nuquerna":{e:2,y:null,"o-below":null,"i-below":null,others:1},hyarmen:{y:1,"o-below":1,"i-below":1,others:3},"hwesta-sindarinwa":{w:1,y:1,"o-below":1,"i-below":1,others:0},yanta:{a:1,others:2},ure:{a:1,others:2},halla:{"i-below":3,"o-below":3,others:null},"short-carrier":{y:null,others:3},"long-carrier":{y:null,"o-below":null,"i-below":null,others:3},"round-carrier":2,"tinco-extended":{a:3,w:3,y:3,"":3,"o-below":3,others:2},"parma-extended":{a:3,w:3,y:3,"":3,"o-below":3,others:2},"calma-extended":{i:1,w:1,y:0,"":0,"i-below":1,"o-below":1,others:0},"quesse-extended":{i:1,w:1,y:0,"":0,"i-below":1,"o-below":1,others:0},"ando-extended":{wide:!0,others:0},"umbar-extended":{wide:!0,others:0},"anga-extended":{wide:!0,others:0},"ungwe-extended":{wide:!0,others:0}};function l(e,t){var n=(t=t||{}).plain||!1,r=e.tengwa||"anna",o=[];e.above&&o.push(e.above),e.below&&o.push(e.below),e.tildeBelow&&o.push("tilde-below"),e.tildeAbove&&o.push("tilde-above"),e.following&&o.push(e.following);var i=a[r]+o.map(function(e){return c(r,e)}).join("");return e.errors&&!n&&(i='<abbr class="error" title="'+e.errors.join("\n").replace(/"/g,"&quot;")+'">'+i+"</abbr>"),i}function c(e,t){var n=function(e,t){if(!u[t])return null;if(-1!==h.indexOf(t))return null;if(u[t].special)return u[t][e]||null;if(-1!==r.barsAndTildes.indexOf(t))return"lambe"===e||"alda"===e&&u[t].length>=2?2:s[e].wide?0:1;return null==s[e]?null:null===s[e][t]?null:null!=s[e][t]?s[e][t]:null!=s[e].others?s[e].others:s[e]}(e,t);return null==n?null:u[t][e]||u[t][n]||null}t.transcribe=function(e,t){var n=(t=t||{}).block||!1,r=n?"<p>":"",o=n?"</p>":"";return e.map(function(e){return e.map(function(e){return r+e.map(function(e){return e.map(function(e){return e.map(function(e){return l(e,t)}).join("")}).join(" ")}).join("<br>\n")+o}).join("\n\n")}).join("\n\n\n")},t.transcribeColumn=l,t.tehtaForTengwa=c;var h="";t.makeColumn=function(e,n){return i(t,e,n)}},function(e,t){t.tengwar=[["tinco","parma","calma","quesse"],["ando","umbar","anga","ungwe"],["thule","formen","harma","hwesta"],["anto","ampa","anca","unque"],["numen","malta","noldo","nwalme"],["ore","vala","anna","wilya"],["romen","arda","lambe","alda"],["silme","silme-nuquerna","esse","esse-nuquerna"],["hyarmen","hwesta-sindarinwa","yanta","ure"],["halla","short-carrier","long-carrier","round-carrier"],["tinco-extended","parma-extended","calma-extended","quesse-extended"],["ando-extended","umbar-extended","anga-extended","ungwe-extended"]],t.tehtarAbove=["a","e","i","o","u","","","","","","w"],t.tehtarBelow=["y","s","o-below","i-below"],t.tehtarFollowing=["s-final","s-inverse","s-extended","s-flourish"],t.barsAndTildes=["tilde-above","tilde-below","tilde-high-above","tilde-far-below","bar-above","bar-below","bar-high-above","bar-far-below"],t.tehtar=[].concat(t.tehtarAbove,t.tehtarBelow,t.tehtarFollowing,t.barsAndTildes),t.aliases={vilya:"wilya",aha:"harma",gasdil:"halla"}},function(e,t){t.tengwar={tinco:"1",parma:"q",calma:"a",quesse:"z",ando:"2",umbar:"w",anga:"s",ungwe:"x",thule:"3",formen:"e",harma:"d",hwesta:"c",anto:"4",ampa:"r",anca:"f",unque:"v",numen:"5",malta:"t",noldo:"g",nwalme:"b",ore:"6",vala:"y",anna:"h",wilya:"n",romen:"7",arda:"u",lambe:"j",alda:"m",silme:"8","silme-nuquerna":"i",esse:"k","esse-nuquerna":",",hyarmen:"9","hwesta-sindarinwa":"o",yanta:"l",ure:".",halla:"","short-carrier":"`","long-carrier":"~","round-carrier":"]","tinco-extended":"!","parma-extended":"Q","calma-extended":"A","quesse-extended":"Z","ando-extended":"@","umbar-extended":"W","anga-extended":"S","ungwe-extended":"X",comma:"=","full-stop":"-","exclamation-point":"","question-mark":"","open-paren":"=","close-paren":"=","flourish-left":"","flourish-right":"",0:"",1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:"",11:""},t.tehtar={a:"#EDC",e:"$RFV",i:"%TGB",o:"^YHN",u:["&","U","J","M","","","",""],"":["","","",""],"":["","","",""],"":["","","",""],w:"",y:"","o-below":["","","","","|"],"i-below":["","","","","L"],s:{special:!0,calma:"|",quesse:"|","short-carrier":"}"},"s-final":{special:!0,tinco:"+",ando:"+",numen:"+",lambe:"_"},"s-inverse":{special:!0,tinco:""},"s-extended":{special:!0,tinco:""},"s-flourish":{special:!0,tinco:"",lambe:""},"tilde-above":"Pp","tilde-below":[":",";",""],"tilde-high-above":")0","tilde-far-below":"?/","bar-above":"{[","bar-below":['"',"'",""],"bar-high-above":"","bar-far-below":""}},function(e,t){e.exports=function(e,t,r){return new n(e,t,r)};var n=function(e,t,n){this.font=e,this.above=void 0,this.tildeAbove=void 0,this.tengwa=t,this.tildeBelow=void 0,this.below=void 0,this.following=void 0,this.error=void 0,this.aboveNote=void 0,this.tildeAboveNote=void 0,this.tengwaNote=n,this.tildeBelowNote=void 0,this.belowNote=void 0,this.followingNote=void 0,this.hasVariant=!1};n.prototype.canAddAbove=function(e,t){return!this.above&&!!this.font.tehtaForTengwa(this.tengwa,e)||!t&&!this.below&&this.reversed().canAddAbove(e,!0)},n.prototype.addAbove=function(e,t){return this.font.tehtaForTengwa(this.tengwa,e)||this.reverse(),this.above=e,this.aboveNote=t,this},n.prototype.canAddBelow=function(e,t){return!this.below&&!!this.font.tehtaForTengwa(this.tengwa,e)||!t&&!this.above&&this.reversed().canAddBelow(e,!0)},n.prototype.addBelow=function(e,t){return this.font.tehtaForTengwa(this.tengwa,e)||this.reverse(),this.below=e,this.belowNote=t,this},n.prototype.addTildeAbove=function(e){return this.tildeAbove=!0,this.tildeAboveNote=e,this},n.prototype.addTildeBelow=function(e){return this.tildeBelow=!0,this.tildeBelowNote=e,this},n.prototype.canAddFollowing=function(e){return!this.following&&!!this.font.tehtaForTengwa(this.tengwa,e)},n.prototype.addFollowing=function(e,t){return this.following=e,this.followingNote=t,this},n.prototype.reversed=function(){return this.clone().reverse()},n.prototype.clone=function(){var e=new n(this.font,this.tengwa);return this.above&&e.addAbove(this.above,this.aboveNote),this.below&&e.addBelow(this.below,this.belowNote),this.following&&e.addFollowing(this.following,this.followingNote),this.tildeBelow&&e.addTildeBelow(this.tildeBelowNote),this.tildeAbove&&e.addTildeAbove(this.tildeAboveNote),e};var r={silme:"silme-nuquerna",esse:"esse-nuquerna","silme-nuquerna":"silme","esse-nuquerna":"esse"};n.prototype.reverse=function(){return this.tengwa=r[this.tengwa]||this.tengwa,this},n.prototype.addError=function(e){return this.errors=this.errors||[],this.errors.push(e),this},n.prototype.varies=function(){return this.hasVariant=!0,this}},function(e,t,n){n(43);var r,o=n(44),i=n(55),a=n(64),u=n(65);"Mae govannen, Arda!"===(r=window.location.search?i.parse(window.location.search.slice(1)):{q:"",mode:"general-use",font:"annatar",height:void 0}).q&&(r.q=""),r.options=r.options||[];var s=document.querySelector.bind(document),l=document.querySelectorAll.bind(document);function c(e,t){var n=(e.dataset.mode||"").split(" ");n.shift();var r={};n.forEach(function(e){e=e.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),r[e]=!0}),o.defineBindings({fonts:a,modes:u,input:e.dataset.tengwar,element:e,options:r,state:t},{"element.classList.rangeContent()":{"<-":"['tengwar', state.font, state.mode, 'rendered']"},mode:{"<-":"modes[state.mode]"},"options.font":{"<-":"fonts[state.font]"},"options.language":{"<-":"state.language"},"element.innerHTML":{args:["options.font","mode","input","options"],compute:function(e,t,n,r){r=t.makeOptions(r);return t.transcribe(n,r)}}})}function h(e,t){e.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),t.options.sort(),window.location="./?"+i.stringify(t)})}Array.prototype.forEach.call(l(".dynamic-tengwar"),function(e){c(e,{font:e.dataset.font,mode:(e.dataset.mode||"").split(" ")[0],language:e.dataset.lang||"unknown"})});var f={};["general-use","classical","beleriand"].forEach(function(e){var t={q:"",font:"parmaite",mode:e,options:[]};f[e]=t,Array.prototype.forEach.call(l("."+e+"-font"),function(e){c(e,t)}),o.defineBindings({parmaite:document.getElementById(e+"-font-parmaite"),annatar:document.getElementById(e+"-font-annatar"),state:t},{"state.font == 'parmaite'":{"<->":"parmaite.checked"},"state.font == 'annatar'":{"<->":"annatar.checked"}}),h(document.getElementById(e+"-button"),t)}),h(document.getElementById("kings-letter-general-use-button"),{q:document.getElementById("kings-letter-general-use-tengwar").dataset.tengwar,font:"parmaite",mode:"general-use",options:[]}),h(document.getElementById("kings-letter-beleriand-button"),{q:document.getElementById("kings-letter-beleriand-tengwar").dataset.tengwar,font:"parmaite",mode:"beleriand",options:[]}),h(document.getElementById("doors-of-durin-button"),{q:document.getElementById("doors-of-durin-tengwar").dataset.tengwar,font:"parmaite",mode:"beleriand",options:[]}),h(document.getElementById("black-speech-button"),{q:document.getElementById("black-speech-tengwar").dataset.tengwar,font:"annatar",mode:"general-use",language:"blackSpeech",options:[]}),h(document.getElementById("english-general-use-button"),{q:document.getElementById("english-general-use-tengwar").dataset.tengwar,font:"parmaite",mode:"general-use",language:"english",options:[]}),h(document.getElementById("namarie-button"),{q:document.getElementById("namarie-tengwar").dataset.tengwar,font:"parmaite",mode:"classical",options:[]}),[{mode:"general-use",option:"double-nasals-with-tilde-below",on:"general-use-nasal-below",off:"general-use-nasal-above"},{mode:"general-use",option:"reverse-curls",on:"general-use-reverse-curls",off:"general-use-normal-curls"},{mode:"general-use",option:"swap-dot-slash",on:"general-use-slash-dot",off:"general-use-dot-slash"},{mode:"general-use",option:"medial-ore",on:"general-use-medial-ore",off:"general-use-no-medial-ore"},{mode:"general-use",option:"no-ach-laut",on:"general-use-no-ach-laut",off:"general-use-ach-laut"},{mode:"general-use",option:"s-hook",on:"general-use-s-hook",off:"general-use-no-s-hook"},{mode:"general-use",option:"tsdz",on:"general-use-tsdz",off:"general-use-no-tsdz"},{mode:"general-use",option:"duodecimal",on:"general-use-duodecimal",off:"general-use-decimal"},{mode:"classical",option:"reverse-curls",on:"classical-reverse-curls",off:"classical-normal-curls"},{mode:"classical",option:"swap-dot-slash",on:"classical-slash-dot",off:"classical-dot-slash"},{mode:"classical",option:"vilya",on:"classical-vilya",off:"classical-wilya"},{mode:"classical",option:"classical-r",on:"classical-r-classical",off:"classical-r-modern"},{mode:"classical",option:"iu-rising",on:"classical-iu-rising",off:"classical-iu-falling"},{mode:"classical",option:"duodecimal",on:"classical-duodecimal",off:"classical-decimal"},{mode:"beleriand",option:"duodecimal",on:"beleriand-duodecimal",off:"beleriand-decimal"}].forEach(function(e){o.defineBindings({option:e.option,off:s("#"+e.off),on:s("#"+e.on),state:f[e.mode]},{"!state.options.has(option)":{"<->":"off.checked",trace:!1},"state.options.has(option)":{"<->":"on.checked",trace:!1}})}),o.defineBindings({halla:s("#classical-period-halla"),aha:s("#classical-period-aha"),hyarmen:s("#classical-period-hyarmen"),state:f.classical},{"!state.options.has('classical-h')":{"<->":"hyarmen.checked",trace:!1},"state.options.has('classical-h')":{"<-":"halla.checked || aha.checked",trace:!1},"!state.options.has('harma')":{"<-":"halla.checked || hyarmen.checked",trace:!1},"state.options.has('harma')":{"<->":"aha.checked",trace:!1}}),["general-use","classical","beleriand"].forEach(function(e){var t=f[e];t.q=r.q||"",t.options.swap(0,f[e].options.length,r.options.filter(function(e){return e&&"undefined"!==e}))})},function(e,t,n){var r=n(1);function o(e){r.dispatchOwnPropertyChange(e.target,"checked",e.target.checked)}function i(e){r.dispatchOwnPropertyChange(e.target,"value",e.target.value)}function a(e){r.dispatchOwnPropertyChange(e.target,"innerHTML",e.target.innerHTML),r.dispatchOwnPropertyChange(e.target,"innerText",e.target.innerText),r.dispatchOwnPropertyChange(e.target,"value",e.target.innerText)}function u(e){"checked"===e?this.addEventListener("change",o):"value"===e&&(this.addEventListener("change",i),"text"===this.type||"TEXTAREA"===this.nodeName?this.addEventListener("keyup",i):this.contentEditable&&(this.innerText=this.innerText?this.innerText:this.value,this.addEventListener("keyup",a)))}function s(e){"checked"===e?this.removeEventListener("change",o):"value"===e&&(this.removeEventListener("change",i),"text"===this.type||"TEXTAREA"===this.nodeName?this.removeEventListener("keyup",i):this.contentEditable&&this.removeEventListener("keyup",a))}var l=Object.getPrototypeOf(document.createElement("input"));l.makePropertyObservable=u,l.makePropertyUnobservable=s;var c=Object.getPrototypeOf(document.createElement("textarea"));c.makePropertyObservable=u,c.makePropertyUnobservable=s;var h=Object.getPrototypeOf(document.createElement("span"));h.makePropertyObservable=u,h.makePropertyUnobservable=s},function(e,t,n){var r=n(11),o=n(46),i=n(53),a=(n(54),n(32),new r),u=Object.prototype.hasOwnProperty;function s(e,n,r,a){a=a||Object.empty;var s=l(e);if(u.call(s,n))throw new Error("Can't bind to already bound target, "+JSON.stringify(n));return"<-"in r||"<->"in r||"compute"in r?(r.target=e,r.parameters=r.parameters||a.parameters,r.document=r.document||a.document,r.components=r.components||a.components,r.cancel="compute"in r?i(e,n,r):o(e,n,r),s[n]=r,t.count++):("get"in r||"set"in r||"writable"in r||(r.writable=!0),"configurable"in r||(r.configurable=!0),"enumerable"in r||(r.enumerable=!0),Object.defineProperty(e,n,r)),e}function l(e){return a.has(e)||a.set(e,{}),a.get(e)}function c(e,n){var r=l(e);if(!r[n])throw new Error("Can't cancel non-existent binding to "+JSON.stringify(n));var o=r[n];if(o&&o.cancel){for(var n in o.cancel(),delete r[n],t.count--,r)return;a.delete(e)}}t.count=0,t.bindings=a,t.defineBindings=function(e,t,n){if(t)for(var r in t)s(e,r,t[r],n);return e},t.defineBinding=s,t.getBindings=l,t.getBinding=function(e,t){return l(e)[t]},t.cancelBindings=function(e){var t=l(e);for(var n in t)c(e,n)},t.cancelBinding=c},function(e,t,n){"use strict";n(0);var r=n(14),o=n(13),i=n(2),a=n(17),u=n(31),s=n(1);Object.prototype.hasOwnProperty;function l(e,t,n,r){if(!(this instanceof l))return new l(e,t,n,r);t=t||Object.equals,n=n||Object.hash,r=r||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=r;var o=this;this.buckets=new this.Buckets(null,function(){return new o.Bucket}),this.length=0,this.addEach(e)}e.exports=l,l.FastSet=l,Object.addEach(l.prototype,i.prototype),Object.addEach(l.prototype,a.prototype),Object.addEach(l.prototype,s.prototype),l.prototype.Buckets=r,l.prototype.Bucket=o,l.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},l.prototype.has=function(e){var t=this.contentHash(e);return this.buckets.get(t).has(e)},l.prototype.get=function(e,t){if(t)throw new Error("FastSet#get does not support second argument: equals");var n=this.contentHash(e),r=this.buckets;return r.has(n)?r.get(n).get(e):this.getDefault(e)},l.prototype.delete=function(e,t){if(t)throw new Error("FastSet#delete does not support second argument: equals");var n=this.contentHash(e),r=this.buckets;if(r.has(n)){var o=r.get(n);if(o.delete(e))return this.length--,0===o.length&&r.delete(n),!0}return!1},l.prototype.clear=function(){this.buckets.clear(),this.length=0},l.prototype.add=function(e){var t=this.contentHash(e),n=this.buckets;return n.has(t)||n.set(t,new this.Bucket(null,this.contentEquals)),!n.get(t).has(e)&&(n.get(t).add(e),this.length++,!0)},l.prototype.reduce=function(e,t){var n=arguments[2],r=this.buckets,o=0;return r.reduce(function(t,r){return r.reduce(function(t,r){return e.call(n,t,r,o++,this)},t,this)},t,this)},l.prototype.one=function(){if(this.length>0)return this.buckets.one().one()},l.prototype.iterate=function(){return this.buckets.values().flatten().iterate()},l.prototype.log=function(e,t,n,r){e=e||u.unicodeSharp,t=t||this.logNode,n||(n=console.log,r=console),n=n.bind(r);var o=this.buckets,i=o.keys();i.forEach(function(a,u){var s,l;u===i.length-1?(s=e.fromAbove,l=" "):0===u?(s=e.branchDown,l=e.strafe):(s=e.fromBoth,l=e.strafe);var c=o.get(a);n.call(r,s+e.through+e.branchDown+" "+a),c.forEach(function(o,i){var a,u,s;i===c.head.prev?(a=e.fromAbove,u=" "):(a=e.fromBoth,u=e.strafe),t(i,function(t){s?n.call(r,l+" "+u+"  "+t):(n.call(r,l+" "+a+e.through+e.through+t),s=!0)},function(t){n.call(r,l+" "+e.strafe+"  "+t)})})})},l.prototype.logNode=function(e,t){var n=e.value;Object(n)===n?JSON.stringify(n,null,4).split("\n").forEach(function(e){t(" "+e)}):t(" "+n)}},function(e,t,n){var r=n(5),o=n(18),i=n(32),a=n(9),u=n(35),s=n(51),l=n(6),c=l.observeRangeChange,h=(n(36),n(3));function f(e,t,n,r,o,s,c){var h=a(r);return o&&(h=l.makeConverterObserver(h,o,n)),u(t)(h,n,e,s,c?{sourcePath:i(r),targetPath:i(t)}:null)}e.exports=function(e,t,n){n.target=e,n.targetPath=t;var u=n.source=n.source||e,l=n["<-"]||n["<->"]||"",p=n.twoWay="<->"in n;n.sourcePath=l;n.value;var d=n.parameters=n.parameters||u,g=n.document,m=n.components,v=n.trace,y=n.sourceScope=new h(u);y.parameters=d,y.document=g,y.components=m;var b=n.targetScope=new h(e);if(b.parameters=d,b.document=g,b.components=m,n.converter){var w=n.converter;w.convert&&(n.convert=w.convert.bind(w)),w.revert&&(n.revert=w.revert.bind(w))}else if(n.reverter){var O=n.reverter;O.convert&&(n.revert=O.convert.bind(O)),O.revert&&(n.convert=O.revert.bind(O))}var C=n.convert,A=n.revert,E=n.sourceSyntax=r(l),k=n.targetSyntax=r(t),B=o(k,E);if(k=B[0],E=B[1],p&&"rangeContent"===k.type)return function(e,t,n,r,o,i,u,l){var h,f,p,d=a(r),g=a(t),m=s(r),v=s(t),y=Function.noop;p=!0;var b=g(function(e){y(),y=Function.noop,l&&console.log("RANGE CONTENT TARGET",l.targetPath,"SET TO",e),e&&e.addRangeChangeListener&&(h=e,f&&h?(l&&console.log("RANGE CONTENT TARGET REPLACES SOURCE",l.targetPath,"->",l.sourcePath,"WITH",h),p=!0,f.swap(0,f.length,h),p=!1,y=A()):f||p||(l&&console.log("RANGE CONTENT TARGET INITIALIZED TO COPY OF SOURCE",l.targetPath,"<-",tarce.sourcePath,"WITH",f),m(h.clone(),n)))},e);p=!1;var w=d(function(t){y(),y=Function.noop,l&&console.log("RANGE CONTENT SOURCE",l.sourcePath,"SET TO",t),t&&t.addRangeChangeListener&&(f=t,h&&f?(l&&console.log("RANGE CONTENT SOURCE REPLACES TARGET",l.targetPath,"<-",l.sourcePath,"WITH",f),p=!0,h.swap(0,h.length,f),p=!1,y=A()):h||v(f.clone(),e))},n);h||f||m([],n);function O(e,t,n){p||(p=!0,l&&console.log("RANGE CONTENT PROPAGATED",l.targetPath,"<-",l.sourcePath,"PLUS",e,"MINUS",t,"AT",n),h.swap(n,t.length,e),p=!1)}function C(e,t,n){p||(p=!0,l&&console.log("RANGE CONTENT PROPAGATED",l.targetPath,"->",l.sourcePath,"PLUS",e,"MINUS",t,"AT",n),f.swap(n,t.length,e),p=!1)}function A(){if(f!==h){l&&console.log("RANGE CONTENT BOUND",l.targetPath,"<->",l.sourcePath),p=!0;var t=c(f,O,n),r=c(h,C,e);return p=!1,function(){l&&console.log("RANGE CONTENT UNBOUND",l.targetPath,"<->",l.sourcePath),t(),r()}}}return function(){y(),b(),w()}}(b,k.args[0],y,E,0,0,0,v?{sourcePath:i(E),targetPath:i(k.args[0])}:null);v&&console.log("DEFINE BINDING",t,"<-",l,e);var x=f(b,k,y,E,C,n,v);B=o(E,k);E=B[0],k=B[1];var P=Function.noop;p&&(v&&console.log("DEFINE BINDING",t,"->",l,u),P=f(y,E,b,k,A,n,v));return function(){x(),P()}}},function(e,t){e.exports=function(){function e(e,t,n,r,o){this.expected=e,this.found=t,this.offset=n,this.line=r,this.column=o,this.name="SyntaxError",this.message=function(e,t){var n;switch(e.length){case 0:n="end of input";break;case 1:n=e[0];break;default:n=e.slice(0,-1).join(", ")+" or "+e[e.length-1]}return"Expected "+n+" but "+(t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}(t)+'"':"end of input")+" found."}(e,t)}return function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(e,Error),{SyntaxError:e,parse:function(t){var n,r=arguments.length>1?arguments[1]:{},o={expression:ir,sheet:function(){var e,t,n,r;if(e=Kn,null!==(t=Tr())){for(n=[],r=Lr();null!==r;)n.push(r),r=Lr();null!==n&&null!==(r=Tr())?(Zn=e,null===(t=Bn(n))?(Kn=e,e=t):e=t):(Kn=e,e=u)}else Kn=e,e=u;return e}},i=ir,a="expression",u=null,s=",",l='","',c=function(e,t){for(var n=[e],r=0;r<t.length;r++)n.push(t[r][2]);return n},h="(",f='"("',p=")",d='")"',g=function(){return[]},m=function(e){return e},v="",y="?",b='"?"',w=":",O='":"',C=function(e,t){return t?{type:"if",args:[e,t[2],t[6]]}:e},A="||",E='"||"',k=function(e,t){for(var n=0;n<t.length;n++)e={type:Fr[t[n][1]],args:[e,t[n][3]]};return e},B="&&",x='"&&"',P="<=>",R='"<=>"',j="<=",_='"<="',T=">=",S='">="',M="<",L='"<"',q="-",N='"-"',F=">",D='">"',I="==",U='"=="',Y="!=",H='"!="',G=function(e,t){if(t){var n=t[1],r=t[3];return"!="===n?{type:"not",args:[{type:"equals",args:[e,r]}]}:{type:Fr[n],args:[e,r]}}return e},z="+",W='"+"',V="*",J='"*"',$="/",K='"/"',Z="%",X='"%"',Q="rem",ee='"rem"',te="**",ne='"**"',re="//",oe='"//"',ie="%%",ae='"%%"',ue="??",se='"??"',le="!",ce='"!"',he=function(e,t){return{type:Dr[e],args:[t]}},fe=function(e,t){for(var n=0;n<t.length;n++)e=t[n](e);return e},pe=".",de='"."',ge=function(e){return e},me="[",ve='"["',ye="]",be='"]"',we=function(e){return function(t){return{type:"property",args:[t,e]}}},Oe="{",Ce='"{"',Ae="}",Ee='"}"',ke=function(e,t){return Ir[e]?function(n){return{type:Ir[e],args:[n,t]}}:"value"===t.type?function(t){return{type:e,args:[t]}}:function(n){return{type:e,args:[{type:"mapBlock",args:[n,t]}]}}},Be=function(e,t){return function(n){return{type:e,args:[n].concat(t)}}},xe=function(e){return function(t){return{type:"property",args:[t,{type:"literal",value:+e.join("")}]}}},Pe=function(e){return function(t){return{type:"property",args:[t,{type:"literal",value:e}]}}},Re=function(e){return function(t){return{type:"with",args:[t,e]}}},je="this",_e='"this"',Te=function(){return{type:"value"}},Se="true",Me='"true"',Le=function(){return{type:"literal",value:!0}},qe="false",Ne='"false"',Fe=function(){return{type:"literal",value:!1}},De="null",Ie='"null"',Ue=function(){return{type:"literal",value:null}},Ye="@",He='"@"',Ge=function(e){return{type:"component",label:e}},ze="$",We='"$"',Ve=function(e){return{type:"property",args:[{type:"parameters"},{type:"literal",value:e}]}},Je=function(){return{type:"parameters"}},$e="#",Ke='"#"',Ze=function(e){return{type:"element",id:e}},Xe="&",Qe='"&"',et=function(e,t){return{type:e,args:t,inline:!0}},tt="^",nt='"^"',rt=function(e){return{type:"parent",args:[e]}},ot=function(e){return e},it=function(e){return e({type:"value"})},at=function(){return{type:"value"}},ut="word",st=/^[a-zA-Z_0-9\-]/,lt="[a-zA-Z_0-9\\-]",ct="string",ht="'",ft='"\'"',pt=function(e){return{type:"literal",value:e.join("")}},dt='"',gt='"\\""',mt=/^[^'\\\0-\x1F]/,vt="[^'\\\\\\0-\\x1F]",yt="\\'",bt='"\\\\\'"',wt=function(){return"'"},Ot=/^[^"\\\0-\x1F]/,Ct='[^"\\\\\\0-\\x1F]',At='\\"',Et='"\\\\\\""',kt=function(){return'"'},Bt="\\\\",xt='"\\\\\\\\"',Pt=function(){return"\\"},Rt="\\/",jt='"\\\\/"',_t=function(){return"/"},Tt="\\b",St='"\\\\b"',Mt=function(){return"\b"},Lt="\\f",qt='"\\\\f"',Nt=function(){return"\f"},Ft="\\n",Dt='"\\\\n"',It=function(){return"\n"},Ut="\\r",Yt='"\\\\r"',Ht=function(){return"\r"},Gt="\\t",zt='"\\\\t"',Wt=function(){return"\t"},Vt="\\0",Jt='"\\\\0"',$t=function(){return"\0"},Kt="\\u",Zt='"\\\\u"',Xt=function(e){return String.fromCharCode(parseInt(e,16))},Qt=/^[0-9a-fA-F]/,en="[0-9a-fA-F]",tn=function(){return{type:"tuple",args:[]}},nn=function(e){return{type:"tuple",args:e}},rn=function(){return{type:"record",args:[]}},on=function(e){return{type:"record",args:e}},an=function(e,t){var n={};n[e[0]]=e[1];for(var r=0;r<t.length;r++)n[t[r][2][0]]=t[r][2][1];return n},un=function(e,t){return[e,t]},sn="number",ln=function(e){return{type:"literal",value:+e}},cn=/^[eE]/,hn="[eE]",fn=/^[+\-]/,pn="[+\\-]",dn=/^[0-9]/,gn="[0-9]",mn=/^[1-9]/,vn="[1-9]",yn="whitespace",bn=/^[\t\x0B\f \xA0\uFEFF]/,wn="[\\t\\x0B\\f \\xA0\\uFEFF]",On=/^[ \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000]/,Cn="[ \\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000]",An="line terminator",En=/^[\n\r\u2028\u2029]/,kn="[\\n\\r\\u2028\\u2029]",Bn=function(e){return{type:"sheet",blocks:e}},xn=function(e,t,n){return{type:"block",connection:t.connection,module:t.module,exports:t.exports,label:e,statements:n}},Pn=function(e,t,n){return{connection:{"<":"prototype",":":"object"}[e],module:t&&t.value,exports:""!==n?n[1]:void 0}},Rn=function(){return{}},jn=/^[a-zA-Z_0-9]/,_n="[a-zA-Z_0-9]",Tn=";",Sn='";"',Mn=function(e){return[e]},Ln="on",qn='"on"',Nn="before",Fn='"before"',Dn=" ",In='" "',Un="->",Yn='"->"',Hn=function(e,t,n){return{type:"event",when:e,event:t,listener:n}},Gn="<->",zn='"<->"',Wn="<-",Vn='"<-"',Jn=function(e,t,n,r){var o={type:Ur[t],args:[e,n]};if(r.length){for(var i={},a=0;a<r.length;a++)i[r[a][2]]=r[a][6];o.descriptor=i}return o},$n=function(e,t){return{type:"unit",name:e,value:t}},Kn=0,Zn=0,Xn=0,Qn={line:1,column:1,seenCR:!1},er=0,tr=[],nr=0;if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=o[r.startRule]}function rr(e){return Xn!==e&&(Xn>e&&(Xn=0,Qn={line:1,column:1,seenCR:!1}),function(e,n,r){var o,i;for(o=n;o<r;o++)"\n"===(i=t.charAt(o))?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):"\r"===i||"\u2028"===i||"\u2029"===i?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(Qn,Xn,e),Xn=e),Qn}function or(e){Kn<er||(Kn>er&&(er=Kn,tr=[]),tr.push(e))}function ir(){var e;return nr++,e=function(){var e,n,r,o,i,a,s,l,c,h;e=Kn,null!==(n=function(){var e,n,r,o,i,a,s,l;if(e=Kn,null!==(n=sr())){for(r=[],o=Kn,null!==(i=Tr())?(t.substr(Kn,2)===A?(a=A,Kn+=2):(a=null,0===nr&&or(E)),null!==a&&null!==(s=Tr())&&null!==(l=sr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==o;)r.push(o),o=Kn,null!==(i=Tr())?(t.substr(Kn,2)===A?(a=A,Kn+=2):(a=null,0===nr&&or(E)),null!==a&&null!==(s=Tr())&&null!==(l=sr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==r?(Zn=e,null===(n=k(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}())&&null!==Tr()?(r=Kn,63===t.charCodeAt(Kn)?(o=y,Kn++):(o=null,0===nr&&or(b)),null!==o&&null!==(i=Tr())&&null!==(a=ir())&&null!==(s=Tr())?(58===t.charCodeAt(Kn)?(l=w,Kn++):(l=null,0===nr&&or(O)),null!==l&&null!==(c=Tr())&&null!==(h=ir())?r=o=[o,i,a,s,l,c,h]:(Kn=r,r=u)):(Kn=r,r=u),null===r&&(r=v),null!==r?(Zn=e,null===(n=C(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u);return e}(),nr--,null===e&&(null,0===nr&&or(a)),e}function ar(){var e,n,r,o,i,a,h;if(e=Kn,null!==(n=ir())){for(r=[],o=Kn,44===t.charCodeAt(Kn)?(i=s,Kn++):(i=null,0===nr&&or(l)),null!==i&&null!==(a=Tr())&&null!==(h=ir())?o=i=[i,a,h]:(Kn=o,o=u);null!==o;)r.push(o),o=Kn,44===t.charCodeAt(Kn)?(i=s,Kn++):(i=null,0===nr&&or(l)),null!==i&&null!==(a=Tr())&&null!==(h=ir())?o=i=[i,a,h]:(Kn=o,o=u);null!==r&&null!==(o=Tr())?(Zn=e,null===(n=c(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}function ur(){var e,n,r,o;return e=Kn,40===t.charCodeAt(Kn)?(n=h,Kn++):(n=null,0===nr&&or(f)),null!==n&&null!==(r=Tr())?(41===t.charCodeAt(Kn)?(o=p,Kn++):(o=null,0===nr&&or(d)),null!==o?(Zn=e,null===(n=g())?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u),null===e&&(e=Kn,40===t.charCodeAt(Kn)?(n=h,Kn++):(n=null,0===nr&&or(f)),null!==n&&null!==(r=ar())?(41===t.charCodeAt(Kn)?(o=p,Kn++):(o=null,0===nr&&or(d)),null!==o?(Zn=e,null===(n=m(r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)),e}function sr(){var e,n,r,o,i,a,s,l;if(e=Kn,null!==(n=lr())){for(r=[],o=Kn,null!==(i=Tr())?(t.substr(Kn,2)===B?(a=B,Kn+=2):(a=null,0===nr&&or(x)),null!==a&&null!==(s=Tr())&&null!==(l=lr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==o;)r.push(o),o=Kn,null!==(i=Tr())?(t.substr(Kn,2)===B?(a=B,Kn+=2):(a=null,0===nr&&or(x)),null!==a&&null!==(s=Tr())&&null!==(l=lr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==r?(Zn=e,null===(n=k(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}function lr(){var e,n,r,o,i,a,s,l,c;return e=Kn,null!==(n=cr())?(r=Kn,null!==(o=Tr())?(i=Kn,t.substr(Kn,3)===P?(a=P,Kn+=3):(a=null,0===nr&&or(R)),null===a&&(t.substr(Kn,2)===j?(a=j,Kn+=2):(a=null,0===nr&&or(_)),null===a&&(t.substr(Kn,2)===T?(a=T,Kn+=2):(a=null,0===nr&&or(S)),null===a&&(a=Kn,60===t.charCodeAt(Kn)?(s=M,Kn++):(s=null,0===nr&&or(L)),null!==s?(l=Kn,nr++,45===t.charCodeAt(Kn)?(c=q,Kn++):(c=null,0===nr&&or(N)),nr--,null===c?l=v:(Kn=l,l=u),null!==l?a=s=[s,l]:(Kn=a,a=u)):(Kn=a,a=u),null===a&&(62===t.charCodeAt(Kn)?(a=F,Kn++):(a=null,0===nr&&or(D)),null===a&&(t.substr(Kn,2)===I?(a=I,Kn+=2):(a=null,0===nr&&or(U)),null===a&&(t.substr(Kn,2)===Y?(a=Y,Kn+=2):(a=null,0===nr&&or(H)))))))),null!==a&&(a=t.substring(i,Kn)),null!==(i=a)&&null!==(a=Tr())&&null!==(s=cr())?r=o=[o,i,a,s]:(Kn=r,r=u)):(Kn=r,r=u),null===r&&(r=v),null!==r?(Zn=e,null===(n=G(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u),e}function cr(){var e,n,r,o,i,a,s,l;if(e=Kn,null!==(n=hr())){for(r=[],o=Kn,null!==(i=Tr())?(a=Kn,43===t.charCodeAt(Kn)?(s=z,Kn++):(s=null,0===nr&&or(W)),null===s&&(45===t.charCodeAt(Kn)?(s=q,Kn++):(s=null,0===nr&&or(N))),null!==s&&(s=t.substring(a,Kn)),null!==(a=s)&&null!==(s=Tr())&&null!==(l=hr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==o;)r.push(o),o=Kn,null!==(i=Tr())?(a=Kn,43===t.charCodeAt(Kn)?(s=z,Kn++):(s=null,0===nr&&or(W)),null===s&&(45===t.charCodeAt(Kn)?(s=q,Kn++):(s=null,0===nr&&or(N))),null!==s&&(s=t.substring(a,Kn)),null!==(a=s)&&null!==(s=Tr())&&null!==(l=hr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==r?(Zn=e,null===(n=k(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}function hr(){var e,n,r,o,i,a,s,l;if(e=Kn,null!==(n=fr())){for(r=[],o=Kn,null!==(i=Tr())?(a=Kn,42===t.charCodeAt(Kn)?(s=V,Kn++):(s=null,0===nr&&or(J)),null===s&&(47===t.charCodeAt(Kn)?(s=$,Kn++):(s=null,0===nr&&or(K)),null===s&&(37===t.charCodeAt(Kn)?(s=Z,Kn++):(s=null,0===nr&&or(X)),null===s&&(t.substr(Kn,3)===Q?(s=Q,Kn+=3):(s=null,0===nr&&or(ee))))),null!==s&&(s=t.substring(a,Kn)),null!==(a=s)&&null!==(s=Tr())&&null!==(l=fr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==o;)r.push(o),o=Kn,null!==(i=Tr())?(a=Kn,42===t.charCodeAt(Kn)?(s=V,Kn++):(s=null,0===nr&&or(J)),null===s&&(47===t.charCodeAt(Kn)?(s=$,Kn++):(s=null,0===nr&&or(K)),null===s&&(37===t.charCodeAt(Kn)?(s=Z,Kn++):(s=null,0===nr&&or(X)),null===s&&(t.substr(Kn,3)===Q?(s=Q,Kn+=3):(s=null,0===nr&&or(ee))))),null!==s&&(s=t.substring(a,Kn)),null!==(a=s)&&null!==(s=Tr())&&null!==(l=fr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==r?(Zn=e,null===(n=k(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}function fr(){var e,n,r,o,i,a,s,l;if(e=Kn,null!==(n=pr())){for(r=[],o=Kn,null!==(i=Tr())?(a=Kn,t.substr(Kn,2)===te?(s=te,Kn+=2):(s=null,0===nr&&or(ne)),null===s&&(t.substr(Kn,2)===re?(s=re,Kn+=2):(s=null,0===nr&&or(oe)),null===s&&(t.substr(Kn,2)===ie?(s=ie,Kn+=2):(s=null,0===nr&&or(ae)))),null!==s&&(s=t.substring(a,Kn)),null!==(a=s)&&null!==(s=Tr())&&null!==(l=pr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==o;)r.push(o),o=Kn,null!==(i=Tr())?(a=Kn,t.substr(Kn,2)===te?(s=te,Kn+=2):(s=null,0===nr&&or(ne)),null===s&&(t.substr(Kn,2)===re?(s=re,Kn+=2):(s=null,0===nr&&or(oe)),null===s&&(t.substr(Kn,2)===ie?(s=ie,Kn+=2):(s=null,0===nr&&or(ae)))),null!==s&&(s=t.substring(a,Kn)),null!==(a=s)&&null!==(s=Tr())&&null!==(l=pr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==r?(Zn=e,null===(n=k(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}function pr(){var e,n,r,o,i,a,s,l;if(e=Kn,null!==(n=dr())){for(r=[],o=Kn,null!==(i=Tr())?(t.substr(Kn,2)===ue?(a=ue,Kn+=2):(a=null,0===nr&&or(se)),null!==a&&null!==(s=Tr())&&null!==(l=dr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==o;)r.push(o),o=Kn,null!==(i=Tr())?(t.substr(Kn,2)===ue?(a=ue,Kn+=2):(a=null,0===nr&&or(se)),null!==a&&null!==(s=Tr())&&null!==(l=dr())?o=i=[i,a,s,l]:(Kn=o,o=u)):(Kn=o,o=u);null!==r?(Zn=e,null===(n=k(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}function dr(){var e,n,r;return e=Kn,n=Kn,33===t.charCodeAt(Kn)?(r=le,Kn++):(r=null,0===nr&&or(ce)),null===r&&(43===t.charCodeAt(Kn)?(r=z,Kn++):(r=null,0===nr&&or(W)),null===r&&(45===t.charCodeAt(Kn)?(r=q,Kn++):(r=null,0===nr&&or(N)))),null!==r&&(r=t.substring(n,Kn)),null!==(n=r)&&null!==(r=dr())?(Zn=e,null===(n=he(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u),null===e&&(e=function(){var e,n,r,o;if(e=Kn,null!==(n=function e(){var n,r,o,i;n=Ar();null===n&&null===(n=Er())&&null===(n=yr())&&null===(n=function(){var e,n,r;nr++,e=Kn,n=Kn,null!==(r=function(){var e,t,n,r;e=Kn,null!==(t=Br())&&null!==(n=xr())&&null!==(r=Pr())?e=t=[t,n,r]:(Kn=e,e=u);null===e&&(e=Kn,null!==(t=Br())&&null!==(n=xr())?e=t=[t,n]:(Kn=e,e=u),null===e&&(e=Kn,null!==(t=Br())&&null!==(n=Pr())?e=t=[t,n]:(Kn=e,e=u),null===e&&(e=Br())));return e}())&&(r=t.substring(n,Kn));null!==(n=r)&&(Zn=e,n=ln(n));null===n?(Kn=e,e=n):e=n;nr--,null===e&&(n=null,0===nr&&or(sn));return e}())&&(n=Kn,t.substr(Kn,4)===je?(r=je,Kn+=4):(r=null,0===nr&&or(_e)),null!==r&&(Zn=n,r=Te()),null===r?(Kn=n,n=r):n=r,null===n&&(n=Kn,t.substr(Kn,4)===Se?(r=Se,Kn+=4):(r=null,0===nr&&or(Me)),null!==r&&(Zn=n,r=Le()),null===r?(Kn=n,n=r):n=r,null===n&&(n=Kn,t.substr(Kn,5)===qe?(r=qe,Kn+=5):(r=null,0===nr&&or(Ne)),null!==r&&(Zn=n,r=Fe()),null===r?(Kn=n,n=r):n=r,null===n&&(n=Kn,t.substr(Kn,4)===De?(r=De,Kn+=4):(r=null,0===nr&&or(Ie)),null!==r&&(Zn=n,r=Ue()),null===r?(Kn=n,n=r):n=r,null===n&&(n=Kn,64===t.charCodeAt(Kn)?(r=Ye,Kn++):(r=null,0===nr&&or(He)),null!==r?(o=Kn,null!==(i=qr())&&(i=t.substring(o,Kn)),null!==(o=i)?(Zn=n,null===(r=Ge(o))?(Kn=n,n=r):n=r):(Kn=n,n=u)):(Kn=n,n=u),null===n&&(n=Kn,36===t.charCodeAt(Kn)?(r=ze,Kn++):(r=null,0===nr&&or(We)),null!==r?(o=Kn,null!==(i=vr())&&(i=t.substring(o,Kn)),null!==(o=i)?(Zn=n,null===(r=Ve(o))?(Kn=n,n=r):n=r):(Kn=n,n=u)):(Kn=n,n=u),null===n&&(n=Kn,36===t.charCodeAt(Kn)?(r=ze,Kn++):(r=null,0===nr&&or(We)),null!==r&&(Zn=n,r=Je()),null===r?(Kn=n,n=r):n=r,null===n&&(n=Kn,35===t.charCodeAt(Kn)?(r=$e,Kn++):(r=null,0===nr&&or(Ke)),null!==r?(o=Kn,null!==(i=vr())&&(i=t.substring(o,Kn)),null!==(o=i)?(Zn=n,null===(r=Ze(o))?(Kn=n,n=r):n=r):(Kn=n,n=u)):(Kn=n,n=u),null===n&&(n=Kn,38===t.charCodeAt(Kn)?(r=Xe,Kn++):(r=null,0===nr&&or(Qe)),null!==r?(o=Kn,null!==(i=vr())&&(i=t.substring(o,Kn)),null!==(o=i)&&null!==(i=ur())?(Zn=n,null===(r=et(o,i))?(Kn=n,n=r):n=r):(Kn=n,n=u)):(Kn=n,n=u),null===n&&(n=Kn,94===t.charCodeAt(Kn)?(r=tt,Kn++):(r=null,0===nr&&or(nt)),null!==r&&null!==(o=e())?(Zn=n,null===(r=rt(o))?(Kn=n,n=r):n=r):(Kn=n,n=u),null===n&&(n=Kn,40===t.charCodeAt(Kn)?(r=h,Kn++):(r=null,0===nr&&or(f)),null!==r&&null!==(o=ir())?(41===t.charCodeAt(Kn)?(i=p,Kn++):(i=null,0===nr&&or(d)),null!==i?(Zn=n,null===(r=ot(o))?(Kn=n,n=r):n=r):(Kn=n,n=u)):(Kn=n,n=u),null===n&&(n=Kn,null!==(r=mr())&&(Zn=n,r=it(r)),null===r?(Kn=n,n=r):n=r,null===n&&(n=Kn,null!==(r=[])&&(Zn=n,r=at()),null===r?(Kn=n,n=r):n=r)))))))))))));return n}())){for(r=[],o=gr();null!==o;)r.push(o),o=gr();null!==r?(Zn=e,null===(n=fe(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}()),e}function gr(){var e,n,r,o;return e=Kn,46===t.charCodeAt(Kn)?(n=pe,Kn++):(n=null,0===nr&&or(de)),null!==n&&null!==(r=mr())?(Zn=e,null===(n=ge(r))?(Kn=e,e=n):e=n):(Kn=e,e=u),null===e&&(e=Kn,91===t.charCodeAt(Kn)?(n=me,Kn++):(n=null,0===nr&&or(ve)),null!==n&&null!==(r=ir())?(93===t.charCodeAt(Kn)?(o=ye,Kn++):(o=null,0===nr&&or(be)),null!==o?(Zn=e,null===(n=we(r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)),e}function mr(){var e,n,r,o,i,a;return e=Kn,n=Kn,null!==(r=vr())&&(r=t.substring(n,Kn)),null!==(n=r)?(123===t.charCodeAt(Kn)?(r=Oe,Kn++):(r=null,0===nr&&or(Ce)),null!==r&&null!==(o=Tr())&&null!==(i=ir())&&null!==Tr()?(125===t.charCodeAt(Kn)?(a=Ae,Kn++):(a=null,0===nr&&or(Ee)),null!==a?(Zn=e,null===(n=ke(n,i))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)):(Kn=e,e=u),null===e&&(e=Kn,n=Kn,null!==(r=vr())&&(r=t.substring(n,Kn)),null!==(n=r)&&null!==(r=ur())?(Zn=e,null===(n=Be(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u),null===e&&(e=Kn,null!==(n=Rr())&&(Zn=e,n=xe(n)),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,n=Kn,null!==(r=vr())&&(r=t.substring(n,Kn)),null!==(n=r)&&(Zn=e,n=Pe(n)),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,null!==(n=Ar())&&(Zn=e,n=Re(n)),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,null!==(n=Er())&&(Zn=e,n=Re(n)),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,40===t.charCodeAt(Kn)?(n=h,Kn++):(n=null,0===nr&&or(f)),null!==n&&null!==(r=ir())?(41===t.charCodeAt(Kn)?(o=p,Kn++):(o=null,0===nr&&or(d)),null!==o?(Zn=e,null===(n=Re(r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u))))))),e}function vr(){var e,n;if(nr++,e=[],st.test(t.charAt(Kn))?(n=t.charAt(Kn),Kn++):(n=null,0===nr&&or(lt)),null!==n)for(;null!==n;)e.push(n),st.test(t.charAt(Kn))?(n=t.charAt(Kn),Kn++):(n=null,0===nr&&or(lt));else e=u;return nr--,null===e&&(n=null,0===nr&&or(ut)),e}function yr(){var e,n,r,o;if(nr++,e=Kn,39===t.charCodeAt(Kn)?(n=ht,Kn++):(n=null,0===nr&&or(ft)),null!==n){for(r=[],o=br();null!==o;)r.push(o),o=br();null!==r?(39===t.charCodeAt(Kn)?(o=ht,Kn++):(o=null,0===nr&&or(ft)),null!==o?(Zn=e,null===(n=pt(r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)}else Kn=e,e=u;if(null===e)if(e=Kn,34===t.charCodeAt(Kn)?(n=dt,Kn++):(n=null,0===nr&&or(gt)),null!==n){for(r=[],o=wr();null!==o;)r.push(o),o=wr();null!==r?(34===t.charCodeAt(Kn)?(o=dt,Kn++):(o=null,0===nr&&or(gt)),null!==o?(Zn=e,null===(n=pt(r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)}else Kn=e,e=u;return nr--,null===e&&(n=null,0===nr&&or(ct)),e}function br(){var e,n;return mt.test(t.charAt(Kn))?(e=t.charAt(Kn),Kn++):(e=null,0===nr&&or(vt)),null===e&&(e=Kn,t.substr(Kn,2)===yt?(n=yt,Kn+=2):(n=null,0===nr&&or(bt)),null!==n&&(Zn=e,n=wt()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Or())),e}function wr(){var e,n;return Ot.test(t.charAt(Kn))?(e=t.charAt(Kn),Kn++):(e=null,0===nr&&or(Ct)),null===e&&(e=Kn,t.substr(Kn,2)===At?(n=At,Kn+=2):(n=null,0===nr&&or(Et)),null!==n&&(Zn=e,n=kt()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Or())),e}function Or(){var e,n,r,o,i,a,s,l;return e=Kn,t.substr(Kn,2)===Bt?(n=Bt,Kn+=2):(n=null,0===nr&&or(xt)),null!==n&&(Zn=e,n=Pt()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,t.substr(Kn,2)===Rt?(n=Rt,Kn+=2):(n=null,0===nr&&or(jt)),null!==n&&(Zn=e,n=_t()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,t.substr(Kn,2)===Tt?(n=Tt,Kn+=2):(n=null,0===nr&&or(St)),null!==n&&(Zn=e,n=Mt()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,t.substr(Kn,2)===Lt?(n=Lt,Kn+=2):(n=null,0===nr&&or(qt)),null!==n&&(Zn=e,n=Nt()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,t.substr(Kn,2)===Ft?(n=Ft,Kn+=2):(n=null,0===nr&&or(Dt)),null!==n&&(Zn=e,n=It()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,t.substr(Kn,2)===Ut?(n=Ut,Kn+=2):(n=null,0===nr&&or(Yt)),null!==n&&(Zn=e,n=Ht()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,t.substr(Kn,2)===Gt?(n=Gt,Kn+=2):(n=null,0===nr&&or(zt)),null!==n&&(Zn=e,n=Wt()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,t.substr(Kn,2)===Vt?(n=Vt,Kn+=2):(n=null,0===nr&&or(Jt)),null!==n&&(Zn=e,n=$t()),null===n?(Kn=e,e=n):e=n,null===e&&(e=Kn,t.substr(Kn,2)===Kt?(n=Kt,Kn+=2):(n=null,0===nr&&or(Zt)),null!==n?(r=Kn,o=Kn,null!==(i=Cr())&&null!==(a=Cr())&&null!==(s=Cr())&&null!==(l=Cr())?o=i=[i,a,s,l]:(Kn=o,o=u),null!==o&&(o=t.substring(r,Kn)),null!==(r=o)?(Zn=e,null===(n=Xt(r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u))))))))),e}function Cr(){var e;return Qt.test(t.charAt(Kn))?(e=t.charAt(Kn),Kn++):(e=null,0===nr&&or(en)),e}function Ar(){var e,n,r,o;return e=Kn,91===t.charCodeAt(Kn)?(n=me,Kn++):(n=null,0===nr&&or(ve)),null!==n&&null!==Tr()?(93===t.charCodeAt(Kn)?(r=ye,Kn++):(r=null,0===nr&&or(be)),null!==r?(Zn=e,null===(n=tn())?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u),null===e&&(e=Kn,91===t.charCodeAt(Kn)?(n=me,Kn++):(n=null,0===nr&&or(ve)),null!==n&&null!==Tr()&&null!==(r=ar())&&null!==Tr()?(93===t.charCodeAt(Kn)?(o=ye,Kn++):(o=null,0===nr&&or(be)),null!==o?(Zn=e,null===(n=nn(r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)),e}function Er(){var e,n,r,o;return e=Kn,123===t.charCodeAt(Kn)?(n=Oe,Kn++):(n=null,0===nr&&or(Ce)),null!==n&&null!==Tr()?(125===t.charCodeAt(Kn)?(r=Ae,Kn++):(r=null,0===nr&&or(Ee)),null!==r&&null!==(o=Tr())?(Zn=e,null===(n=rn())?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u),null===e&&(e=Kn,123===t.charCodeAt(Kn)?(n=Oe,Kn++):(n=null,0===nr&&or(Ce)),null!==n&&null!==Tr()&&null!==(r=function(){var e,n,r,o,i,a,c;if(e=Kn,null!==(n=kr())){for(r=[],o=Kn,44===t.charCodeAt(Kn)?(i=s,Kn++):(i=null,0===nr&&or(l)),null!==i&&null!==(a=Tr())&&null!==(c=kr())?o=i=[i,a,c]:(Kn=o,o=u);null!==o;)r.push(o),o=Kn,44===t.charCodeAt(Kn)?(i=s,Kn++):(i=null,0===nr&&or(l)),null!==i&&null!==(a=Tr())&&null!==(c=kr())?o=i=[i,a,c]:(Kn=o,o=u);null!==r?(Zn=e,null===(n=an(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;return e}())?(125===t.charCodeAt(Kn)?(o=Ae,Kn++):(o=null,0===nr&&or(Ee)),null!==o&&null!==Tr()?(Zn=e,null===(n=on(r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)),e}function kr(){var e,n,r,o;return e=Kn,n=Kn,null!==(r=vr())&&(r=t.substring(n,Kn)),null!==(n=r)?(58===t.charCodeAt(Kn)?(r=w,Kn++):(r=null,0===nr&&or(O)),null!==r&&null!==Tr()&&null!==(o=ir())?(Zn=e,null===(n=un(n,o))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u),e}function Br(){var e,n,r,o;return e=Kn,null!==(n=_r())&&null!==(r=Rr())?e=n=[n,r]:(Kn=e,e=u),null===e&&null===(e=jr())&&(e=Kn,45===t.charCodeAt(Kn)?(n=q,Kn++):(n=null,0===nr&&or(N)),null!==n&&null!==(r=_r())&&null!==(o=Rr())?e=n=[n,r,o]:(Kn=e,e=u),null===e&&(e=Kn,45===t.charCodeAt(Kn)?(n=q,Kn++):(n=null,0===nr&&or(N)),null!==n&&null!==(r=jr())?e=n=[n,r]:(Kn=e,e=u))),e}function xr(){var e,n,r;return e=Kn,46===t.charCodeAt(Kn)?(n=pe,Kn++):(n=null,0===nr&&or(de)),null!==n&&null!==(r=Rr())?e=n=[n,r]:(Kn=e,e=u),e}function Pr(){var e,n,r;return e=Kn,null!==(n=function(){var e,n,r;e=Kn,cn.test(t.charAt(Kn))?(n=t.charAt(Kn),Kn++):(n=null,0===nr&&or(hn));null!==n?(fn.test(t.charAt(Kn))?(r=t.charAt(Kn),Kn++):(r=null,0===nr&&or(pn)),null===r&&(r=v),null!==r?e=n=[n,r]:(Kn=e,e=u)):(Kn=e,e=u);return e}())&&null!==(r=Rr())?e=n=[n,r]:(Kn=e,e=u),e}function Rr(){var e,t;if(e=[],null!==(t=jr()))for(;null!==t;)e.push(t),t=jr();else e=u;return e}function jr(){var e;return dn.test(t.charAt(Kn))?(e=t.charAt(Kn),Kn++):(e=null,0===nr&&or(gn)),e}function _r(){var e;return mn.test(t.charAt(Kn))?(e=t.charAt(Kn),Kn++):(e=null,0===nr&&or(vn)),e}function Tr(){var e,t;for(e=[],null===(t=Sr())&&(t=Mr());null!==t;)e.push(t),null===(t=Sr())&&(t=Mr());return e}function Sr(){var e;return nr++,bn.test(t.charAt(Kn))?(e=t.charAt(Kn),Kn++):(e=null,0===nr&&or(wn)),null===e&&(On.test(t.charAt(Kn))?(e=t.charAt(Kn),Kn++):(e=null,0===nr&&or(Cn))),nr--,null===e&&(null,0===nr&&or(yn)),e}function Mr(){var e;return nr++,En.test(t.charAt(Kn))?(e=t.charAt(Kn),Kn++):(e=null,0===nr&&or(kn)),nr--,null===e&&(null,0===nr&&or(An)),e}function Lr(){var e,n,r,o,i,a,s,l;return e=Kn,64===t.charCodeAt(Kn)?(n=Ye,Kn++):(n=null,0===nr&&or(He)),null!==n?(r=Kn,null!==(o=qr())&&(o=t.substring(r,Kn)),null!==(r=o)&&null!==(o=Tr())?(null===(i=function(){var e,n,r,o,i,a;e=Kn,60===t.charCodeAt(Kn)?(n=M,Kn++):(n=null,0===nr&&or(L));null===n&&(58===t.charCodeAt(Kn)?(n=w,Kn++):(n=null,0===nr&&or(O)));null!==n&&null!==Tr()?(null===(r=yr())&&(r=v),null!==r&&null!==Tr()?(o=Kn,i=Kn,nr++,123===t.charCodeAt(Kn)?(a=Oe,Kn++):(a=null,0===nr&&or(Ce)),nr--,null===a?i=v:(Kn=i,i=u),null!==i&&null!==(a=ir())?o=i=[i,a]:(Kn=o,o=u),null===o&&(o=v),null!==o&&null!==(i=Tr())?(Zn=e,null===(n=Pn(n,r,o))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)):(Kn=e,e=u);null===e&&(e=Kn,null!==(n=Tr())&&(Zn=e,n=Rn()),null===n?(Kn=e,e=n):e=n);return e}())&&(i=v),null!==i?(123===t.charCodeAt(Kn)?(a=Oe,Kn++):(a=null,0===nr&&or(Ce)),null!==a&&null!==Tr()&&null!==(s=function(){var e,n,r,o,i,a,s,l;if(e=Kn,null!==(n=Nr()))if(null!==Tr()){for(r=[],o=Kn,59===t.charCodeAt(Kn)?(i=Tn,Kn++):(i=null,0===nr&&or(Sn)),null!==i&&null!==(a=Tr())&&null!==(s=Nr())&&null!==(l=Tr())?o=i=[i,a,s,l]:(Kn=o,o=u);null!==o;)r.push(o),o=Kn,59===t.charCodeAt(Kn)?(i=Tn,Kn++):(i=null,0===nr&&or(Sn)),null!==i&&null!==(a=Tr())&&null!==(s=Nr())&&null!==(l=Tr())?o=i=[i,a,s,l]:(Kn=o,o=u);null!==r?(59===t.charCodeAt(Kn)?(o=Tn,Kn++):(o=null,0===nr&&or(Sn)),null===o&&(o=v),null!==o&&null!==(i=Tr())?(Zn=e,null===(n=c(n,r))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)}else Kn=e,e=u;else Kn=e,e=u;null===e&&(e=Kn,null!==(n=Nr())&&null!==Tr()?(59===t.charCodeAt(Kn)?(r=Tn,Kn++):(r=null,0===nr&&or(Sn)),null===r&&(r=v),null!==r&&null!==(o=Tr())?(Zn=e,null===(n=Mn(n))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u),null===e&&(e=Kn,null!==(n=Tr())&&(Zn=e,n=g()),null===n?(Kn=e,e=n):e=n));return e}())?(125===t.charCodeAt(Kn)?(l=Ae,Kn++):(l=null,0===nr&&or(Ee)),null!==l&&null!==Tr()?(Zn=e,null===(n=xn(r,i,s))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)):(Kn=e,e=u)):(Kn=e,e=u)):(Kn=e,e=u),e}function qr(){var e,n,r,o,i,a,s;if(e=Kn,n=[],jn.test(t.charAt(Kn))?(r=t.charAt(Kn),Kn++):(r=null,0===nr&&or(_n)),null!==r)for(;null!==r;)n.push(r),jn.test(t.charAt(Kn))?(r=t.charAt(Kn),Kn++):(r=null,0===nr&&or(_n));else n=u;if(null!==n){if(r=[],o=Kn,58===t.charCodeAt(Kn)?(i=w,Kn++):(i=null,0===nr&&or(O)),null!==i){if(a=[],jn.test(t.charAt(Kn))?(s=t.charAt(Kn),Kn++):(s=null,0===nr&&or(_n)),null!==s)for(;null!==s;)a.push(s),jn.test(t.charAt(Kn))?(s=t.charAt(Kn),Kn++):(s=null,0===nr&&or(_n));else a=u;null!==a?o=i=[i,a]:(Kn=o,o=u)}else Kn=o,o=u;for(;null!==o;)if(r.push(o),o=Kn,58===t.charCodeAt(Kn)?(i=w,Kn++):(i=null,0===nr&&or(O)),null!==i){if(a=[],jn.test(t.charAt(Kn))?(s=t.charAt(Kn),Kn++):(s=null,0===nr&&or(_n)),null!==s)for(;null!==s;)a.push(s),jn.test(t.charAt(Kn))?(s=t.charAt(Kn),Kn++):(s=null,0===nr&&or(_n));else a=u;null!==a?o=i=[i,a]:(Kn=o,o=u)}else Kn=o,o=u;null!==r?e=n=[n,r]:(Kn=e,e=u)}else Kn=e,e=u;return e}function Nr(){var e,n,r,o,i,a,c,h,f,p,d,g,m,v,y,b,C;if(e=Kn,t.substr(Kn,2)===Ln?(n=Ln,Kn+=2):(n=null,0===nr&&or(qn)),null===n&&(t.substr(Kn,6)===Nn?(n=Nn,Kn+=6):(n=null,0===nr&&or(Fn))),null!==n?(32===t.charCodeAt(Kn)?(r=Dn,Kn++):(r=null,0===nr&&or(In)),null!==r&&null!==(o=Tr())?(i=Kn,null!==(a=vr())&&(a=t.substring(i,Kn)),null!==(i=a)&&null!==(a=Tr())?(t.substr(Kn,2)===Un?(c=Un,Kn+=2):(c=null,0===nr&&or(Yn)),null!==c&&null!==(h=Tr())&&null!==(f=ir())&&null!==(p=Tr())?(Zn=e,null===(n=Hn(n,i,f))?(Kn=e,e=n):e=n):(Kn=e,e=u)):(Kn=e,e=u)):(Kn=e,e=u)):(Kn=e,e=u),null===e){if(e=Kn,null!==(n=ir()))if(null!==(r=Tr()))if(58===t.charCodeAt(Kn)?(o=w,Kn++):(o=null,0===nr&&or(O)),null===o&&(t.substr(Kn,3)===Gn?(o=Gn,Kn+=3):(o=null,0===nr&&or(zn)),null===o&&(t.substr(Kn,2)===Wn?(o=Wn,Kn+=2):(o=null,0===nr&&or(Vn)))),null!==o)if(null!==(i=Tr()))if(null!==(a=ir()))if(null!==(c=Tr())){for(h=[],f=Kn,44===t.charCodeAt(Kn)?(p=s,Kn++):(p=null,0===nr&&or(l)),null!==p&&null!==(d=Tr())?(g=Kn,null!==(m=vr())&&(m=t.substring(g,Kn)),null!==(g=m)&&null!==(m=Tr())?(58===t.charCodeAt(Kn)?(v=w,Kn++):(v=null,0===nr&&or(O)),null!==v&&null!==(y=Tr())&&null!==(b=ir())&&null!==(C=Tr())?f=p=[p,d,g,m,v,y,b,C]:(Kn=f,f=u)):(Kn=f,f=u)):(Kn=f,f=u);null!==f;)h.push(f),f=Kn,44===t.charCodeAt(Kn)?(p=s,Kn++):(p=null,0===nr&&or(l)),null!==p&&null!==(d=Tr())?(g=Kn,null!==(m=vr())&&(m=t.substring(g,Kn)),null!==(g=m)&&null!==(m=Tr())?(58===t.charCodeAt(Kn)?(v=w,Kn++):(v=null,0===nr&&or(O)),null!==v&&null!==(y=Tr())&&null!==(b=ir())&&null!==(C=Tr())?f=p=[p,d,g,m,v,y,b,C]:(Kn=f,f=u)):(Kn=f,f=u)):(Kn=f,f=u);null!==h?(Zn=e,null===(n=Jn(n,o,a,h))?(Kn=e,e=n):e=n):(Kn=e,e=u)}else Kn=e,e=u;else Kn=e,e=u;else Kn=e,e=u;else Kn=e,e=u;else Kn=e,e=u;else Kn=e,e=u;null===e&&(e=Kn,n=Kn,null!==(r=vr())&&(r=t.substring(n,Kn)),null!==(n=r)&&null!==(r=Tr())&&null!==(o=ir())&&null!==(i=Tr())?(Zn=e,null===(n=$n(n,o))?(Kn=e,e=n):e=n):(Kn=e,e=u))}return e}var Fr={"**":"pow","//":"root","%%":"log","*":"mul","/":"div","%":"mod",rem:"rem","+":"add","-":"sub","<":"lt",">":"gt","<=":"le",">=":"ge","==":"equals","<=>":"compare","??":"default","&&":"and","||":"or","<-":"bind","<->":"bind2",":":"assign"},Dr={"+":"toNumber","-":"neg","!":"not","^":"parent"},Ir={map:"mapBlock",filter:"filterBlock",some:"someBlock",every:"everyBlock",sorted:"sortedBlock",sortedSet:"sortedSetBlock",group:"groupBlock",groupMap:"groupMapBlock",min:"minBlock",max:"maxBlock"},Ur={":":"assign","<-":"bind","<->":"bind2"};if(null!==(n=i())&&Kn===t.length)return n;throw function(e){var t=0;for(e.sort();t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(tr),Zn=Math.max(Kn,er),new e(tr,Zn<t.length?t.charAt(Zn):null,Zn,rr(Zn).line,rr(Zn).column)}}}()},function(e,t,n){"use strict";e.exports=a;n(0);var r=n(2),o=n(1),i=n(4);function a(e,t,n,r){if(!(this instanceof a))return new a(e,t,n,r);Array.isArray(e)?(this.array=e,e=e.splice(0,e.length)):this.array=[],this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.getDefault=r||Function.noop,this.length=0,this.addEach(e)}function u(e,t,n){for(var r=0,o=e.length-1;r<=o;){var i=r+o>>1,a=n(t,e[i]);if(a>0)r=i+1;else{if(!(a<0))return i;o=i-1}}return-(r+1)}function s(e,t,n,r){var o=u(e,t,n);if(o<0)return-1;for(;o>0&&r(t,e[o-1]);)o--;return r(t,e[o])?o:-1}function l(e,t,n,r){var o=u(e,t,n);if(o<0)return-1;for(;o<e.length-1&&r(t,e[o+1]);)o++;return r(t,e[o])?o:-1}a.SortedArray=a,Object.addEach(a.prototype,r.prototype),Object.addEach(a.prototype,o.prototype),Object.addEach(a.prototype,i.prototype),a.prototype.isSorted=!0,a.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare,this.getDefault)},a.prototype.has=function(e,t){if(t)throw new Error("SortedSet#has does not support second argument: equals");var n=u(this.array,e,this.contentCompare);return n>=0&&this.contentEquals(this.array[n],e)},a.prototype.get=function(e,t){if(t)throw new Error("SortedArray#get does not support second argument: equals");var n=s(this.array,e,this.contentCompare,this.contentEquals);return-1!==n?this.array[n]:this.getDefault(e)},a.prototype.add=function(e){var t=function(e,t,n){var r=u(e,t,n);if(r<0)return-r-1;for(var o=e.length-1;r<o&&0===n(t,e[r+1]);)r++;return r}(this.array,e,this.contentCompare);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],t),this.array.splice(t,0,e),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],t),!0},a.prototype.delete=function(e,t){if(t)throw new Error("SortedArray#delete does not support second argument: equals");var n=s(this.array,e,this.contentCompare,this.contentEquals);return-1!==n&&(this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],n),this.array.splice(n,1),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],n),!0)},a.prototype.deleteAll=function(e,t){if(t){var n=this.array.deleteAll(e,t);return this.length-=n,n}var r=s(this.array,e,this.contentCompare,this.contentEquals);if(-1!==r){for(var o=r;this.contentEquals(e,this.array[o]);)o++;var i=this.slice(r,o);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],i,r),this.array.splice(r,i.length),this.length-=i.length,this.dispatchesRangeChanges&&this.dispatchRangeChange([],i,r),i.length}return 0},a.prototype.indexOf=function(e){return s(this.array,e,this.contentCompare,this.contentEquals)},a.prototype.lastIndexOf=function(e){return l(this.array,e,this.contentCompare,this.contentEquals)},a.prototype.find=function(e,t,n){if(t)throw new Error("SortedArray#find does not support second argument: equals");if(n)throw new Error("SortedArray#find does not support third argument: index");return s(this.array,e,this.contentCompare,this.contentEquals)},a.prototype.findLast=function(e,t,n){if(t)throw new Error("SortedArray#findLast does not support second argument: equals");if(n)throw new Error("SortedArray#findLast does not support third argument: index");return l(this.array,e,this.contentCompare,this.contentEquals)},a.prototype.push=function(){this.addEach(arguments)},a.prototype.unshift=function(){this.addEach(arguments)},a.prototype.pop=function(){var e=this.array.pop();return this.length=this.array.length,e},a.prototype.shift=function(){var e=this.array.shift();return this.length=this.array.length,e},a.prototype.slice=function(){return this.array.slice.apply(this.array,arguments)},a.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},a.prototype.swap=function(e,t,n){if(void 0===e&&void 0===t)return[];(e=e||0)<0&&(e+=this.length),void 0===t&&(t=1/0);var r=this.slice(e,e+t);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(n,r,e),this.array.splice(e,t),this.length-=r.length,this.dispatchesRangeChanges&&this.dispatchRangeChange([],r,e),this.addEach(n),r},a.prototype.reduce=function(e,t){var n=arguments[2];return this.array.reduce(function(t,r,o){return e.call(n,t,r,o,this)},t,this)},a.prototype.reduceRight=function(){var e=arguments[2];return this.array.reduceRight(function(t,n,r){return callback.call(e,t,n,r,this)},basis,this)},a.prototype.min=function(){if(this.length)return this.array[0]},a.prototype.max=function(){if(this.length)return this.array[this.length-1]},a.prototype.one=function(){return this.array.one()},a.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.array.slice(),this.dispatchBeforeRangeChange([],e,0)),this.length=0,this.array.clear(),this.dispatchesRangeChanges&&this.dispatchRangeChange([],e,0)},a.prototype.equals=function(e,t){return this.array.equals(e,t)},a.prototype.compare=function(e,t){return this.array.compare(e,t)},a.prototype.iterate=function(e,t){return new this.Iterator(this.array,e,t)},a.prototype.toJSON=function(){return this.toArray()},a.prototype.Iterator=Array.prototype.Iterator},function(e,t,n){n(33),n(0);var r=n(2),o=n(16),i=n(4),a=n(1);function u(e,t,n){if(!(this instanceof u))return new u(e,t,n);this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.content=[],this.length=0,this.addEach(e)}e.exports=u,u.Heap=u,Object.addEach(u.prototype,r.prototype),Object.addEach(u.prototype,a.prototype),Object.addEach(u.prototype,i.prototype),Object.addEach(u.prototype,o.prototype),u.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare)},u.prototype.push=function(e){this.content.push(e),this.float(this.content.length-1),this.length++},u.prototype.pop=function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content.set(0,t),this.sink(0)),this.length--,e},u.prototype.add=function(e){this.push(e)},u.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this.contentEquals(this.content[t],e))return t;return-1},u.prototype.delete=function(e,t){if(t)throw new Error("Heap#delete does not support second argument: equals");var n=this.indexOf(e);if(-1===n)return!1;var r=this.content.pop();if(this.length=this.content.length,n===this.content.length)return!0;this.content.set(n,r);var o=this.contentCompare(r,e);return o>0?this.float(n):o<0&&this.sink(n),!0},u.prototype.peek=function(){if(this.length)return this.content[0]},u.prototype.max=function(){return this.peek()},u.prototype.one=function(){return this.peek()},u.prototype.float=function(e){for(var t=this.content[e];e>0;){var n=Math.floor((e+1)/2)-1,r=this.content[n];if(!(this.contentCompare(r,t)<0))break;this.content.set(n,t),this.content.set(e,r),e=n}},u.prototype.sink=function(e){for(var t,n,r,o,i=this.content.length,a=this.content[e];;){if(o=!1,(t=(n=2*(e+1))-1)<i){var u=this.content[t];this.contentCompare(u,a)>0&&(r=t,o=!0)}if(n<i){var s=this.content[n];this.contentCompare(s,o?u:a)>0&&(r=n,o=!0)}if(!o)break;this.content.set(e,this.content[r]),this.content.set(r,a),e=r}},u.prototype.clear=function(){this.content.clear(),this.length=0},u.prototype.reduce=function(e,t){var n=arguments[2];return this.content.reduce(function(t,r,o){return e.call(n,t,r,o,this)},t,this)},u.prototype.reduceRight=function(e,t){var n=arguments[2];return this.content.reduceRight(function(t,r,o){return e.call(n,t,r,o,this)},t,this)},u.prototype.toJSON=function(){return this.toArray()},u.prototype.makeObservable=function(){this.content.addRangeChangeListener(this,"content"),this.content.addBeforeRangeChangeListener(this,"content"),this.content.addMapChangeListener(this,"content"),this.content.addBeforeMapChangeListener(this,"content")},u.prototype.handleContentRangeChange=function(e,t,n){this.dispatchRangeChange(e,t,n)},u.prototype.handleContentRangeWillChange=function(e,t,n){this.dispatchBeforeRangeChange(e,t,n)},u.prototype.handleContentMapChange=function(e,t){this.dispatchMapChange(t,e)},u.prototype.handleContentMapWillChange=function(e,t){this.dispatchBeforeMapChange(t,e)}},function(e,t,n){"use strict";function r(e,t){for(var n,r=(t.length+1)*(e.length+1),o=Array(r),i=Array(t.length+1),a=Array(t.length+1),u=0;u<e.length+1;u++){for(var s=0;s<t.length+1;s++){var l,c;if(0===u&&0===s)l=" ",c=0;else if(0===u)l="insert",c=s;else if(0===s)l="delete",c=u;else if(e[u-1]===t[s-1])l="retain",c=a[s-1];else{var h=i[s-1],f=a[s];f<h?(l="delete",c=f+1):(l="insert",c=h+1)}o[u+s*(e.length+1)]=l,i[s]=c}n=i,i=a,a=n}return{edges:o,cost:a[t.length],source:t,target:e}}function o(e){for(var t,n,r=[],o=e.edges,i=t=e.target.length,a=e.source.length;t||a;){var u=o[t+a*(i+1)];if("delete"===u){if(n&&"delete"===n[0])n[1]++;else n=s=["delete",1],r.push(s);t--}else if("insert"===u){if(n&&"insert"===n[0])n[1]++;else n=s=["insert",1],r.push(s);a--}else if("retain"===u){var s=["retain",1];n&&"retain"===n[0]?n[1]++:(n=s,r.push(s)),t--,a--}}return r.reverse(),r}function i(e,t){return o(r(e,t))}function a(e,t){for(var n=i(e,t),r=[],o=0,a=0;a<n.length;){var u=n[a++];if("insert"===u[0])r.push([o,0,t.slice(o,o+u[1])]),o+=u[1];else if("delete"===u[0])if(a<n.length&&"insert"===n[a][0]){var s=n[a++];r.push([o,u[1],t.slice(o,o+s[1])]),u[1],o+=s[1]}else r.push([o,u[1]]),u[1];else"retain"==u[0]&&(u[1],o+=u[1])}return r}function u(e,t){for(var n=0;n<t.length;n++)e.swap.apply(e,t[n])}n(0),t.graphOt=r,t.traceOt=o,t.ot=i,t.diff=a,t.apply=u,t.merge=function(e,t){u(e,a(e,t))}},function(e,t,n){var r=n(52),o=n(18),i=(n(3),{type:"value"}),a={type:"literal",value:!0},u={type:"literal",value:!1};function s(e){return s.semantics.compile(e)}e.exports=s,s.semantics={compile:function(e){var t=this.compilers;if("equals"===e.type){var n=this.compile(e.args[0]),r=this.compileEvaluator(e.args[1]);return t.equals(n,r)}if("if"===e.type){var a=this.compileEvaluator(e.args[0]),u=this.compile(e.args[1]),s=this.compile(e.args[2]);return t.if(a,u,s)}if("and"===e.type||"or"===e.type){var l=o(e.args[0],i),c=o(e.args[1],i),h=this.compileEvaluator(e.args[0]),f=(r=this.compileEvaluator(e.args[1]),this.compileEvaluator(l[1])),p=this.compileEvaluator(c[1]),d=(n=this.compile(l[0]),this.compile(c[0]));return t[e.type](n,d,h,r,f,p)}if("everyBlock"===e.type){var g=this.compileEvaluator(e.args[0]),m=o(e.args[1],{type:"literal",value:!0}),v=this.compile(m[0]),y=this.compileEvaluator(m[1]);return t.everyBlock(g,v,y)}if("parent"===e.type){var b=this.compile(e.args[0]);return function(e,t){return b(e,t.parent)}}if(t.hasOwnProperty(e.type)){var w=e.args.map(this.compileEvaluator,this.compileEvaluator.semantics);return t[e.type].apply(null,w)}throw new Error("Can't compile assigner for "+JSON.stringify(e.type))},compileEvaluator:r,compilers:{property:function(e,t){return function(n,r){var o=e(r);if(o){var i=t(r);null!=i&&(Array.isArray(o)?o.set(i,n):o[i]=n)}}},get:function(e,t){return function(n,r){var o=e(r);if(o){var i=t(r);null!=i&&o.set(i,n)}}},has:function(e,t){return function(n,r){var o=e(r);if(o){var i=t(r);null!=n&&(n?(o.has||o.contains).call(o,i)||o.add(i):(o.has||o.contains).call(o,i)&&(o.remove||o.delete).call(o,i))}}},equals:function(e,t){return function(n,r){if(n)return e(t(r),r)}},if:function(e,t,n){return function(r,o){var i=e(o);if(null!=i)return i?t(r,o):n(r,o)}},and:function(e,t,n,r,o,i){return function(u,s){null!=u&&(u?(e(o(a),s),t(i(a),s)):e(n(s)&&!r(s),s))}},or:function(e,t,n,r,o,i){return function(a,s){null!=a&&(a?e(n(s)||!r(s),s):(e(o(u),s),t(i(u),s)))}},rangeContent:function(e){return function(t,n){var r=e(n);r&&(t?r.swap(0,r.length,t):r.clear())}},mapContent:function(e){return function(t,n){var r=e(n);r&&(r.clear(),n.value&&r.addEach(t))}},reversed:function(e){return function(t,n){var r=e(n);r&&r.swap(0,r.length,t.reversed())}},everyBlock:function(e,t,n){return function(r,o){if(r){var i=e(o),a=n(o);i.forEach(function(e){t(a,o.nest(e))})}}}}}},function(e,t,n){var r=n(8),o=n(11),i=n(34),a=n(20);n(3);function u(e){return u.semantics.compile(e)}e.exports=u;var s={mapBlock:function(e,t){return function(n){return e(n).map(function(e){return t(n.nest(e))})}},filterBlock:function(e,t){return function(n){return e(n).filter(function(e){return t(n.nest(e))})}},someBlock:function(e,t){return function(n){return e(n).some(function(e){return t(n.nest(e))})}},everyBlock:function(e,t){return function(n){return e(n).every(function(e){return t(n.nest(e))})}},sortedBlock:function(e,t){return function(n){return e(n).sorted(Function.by(function(e){return t(n.nest(e))}))}},sortedSetBlock:function(e,t){return function(n){function o(e){return t(n.nest(e))}return new i(e(n),function(e,t){return r.equals(o(e),o(t))},function(e,t){return r.compare(o(e),o(t))})}},groupBlock:function(e,t){return function(n){return e(n).group(function(e){return t(n.nest(e))})}},groupMapBlock:function(e,t){return function(n){return new o(e(n).group(function(e){return t(n.nest(e))}))}},minBlock:function(e,t){return function(n){return e(n).min(Function.by(function(e){return t(n.nest(e))}))}},maxBlock:function(e,t){return function(n){return e(n).max(Function.by(function(e){return t(n.nest(e))}))}},parent:function(e){return function(t){return e(t.parent)}},with:function(e,t){return function(n){return t(n.nest(e(n)))}},if:function(e,t,n){return function(r){var o=e(r);if(null!=o)return o?t(r):n(r)}},not:function(e){return function(t){return!e(t)}},and:function(e,t){return function(n){return e(n)&&t(n)}},or:function(e,t){return function(n){return e(n)||t(n)}},default:function(e,t){return function(n){var r=e(n);return null==r&&(r=t(n)),r}},defined:function(e){return function(t){return null!=e(t)}},path:function(e,t){return function(r){var o=e(r),i=t(r),a=n(5);try{return u(a(i))(r.nest(o))}catch(e){}}}},l=r.clone(a,1);r.addEach(l,{property:function(e,t){return e[t]},get:function(e,t){return e.get(t)},mapContent:Function.identity,rangeContent:Function.identity,view:function(e,t,n){return e.slice(t,t+n)}});u.semantics={compilers:{literal:function(e){return function(){return e.value}},value:function(e){return function(e){return e.value}},parameters:function(e){return function(e){return e.parameters}},element:function(e){return function(t){return t.document.getElementById(e.id)}},component:function(e){return function(t){return t.components.getObjectByLabel(e.label)}},tuple:function(e){var t=e.args.map(this.compile,this);return function(e){return t.map(function(t){return t(e)})}},record:function(e){var t=e.args,n={};for(var r in t)n[r]=this.compile(t[r]);return function(e){var t={};for(var r in n)t[r]=n[r](e);return t}}},argCompilers:s,operators:l,compile:function(e){var t=this.compilers,n=this.argCompilers,r=this.operators;if(t.hasOwnProperty(e.type))return t[e.type].call(this,e);if(n.hasOwnProperty(e.type)){var o=e.args.map(this.compile,this);return n[e.type].apply(null,o)}r.hasOwnProperty(e.type)||(r[e.type]=function(t){var n=Array.prototype.slice.call(arguments,1);if(!t[e.type])throw new TypeError("Can't call "+JSON.stringify(e.type)+" of "+t);return t[e.type].apply(t,n)});var i=r[e.type];o=e.args.map(this.compile,this);return function(e){var t=o.map(function(t){return t(e)});if(t.every(a.defined))return i.apply(null,t)}}}},function(e,t,n){var r=n(5),o=n(9),i=n(35),a=n(6),u=n(3);e.exports=function(e,t,n){n.target=e,n.targetPath=t;var s=n.source=n.source||e,l=n.args,c=n.compute,h=n.parameters=n.parameters||s,f=n.document,p=n.components,d=n.trace,g=n.sourceScope=new u(s);g.parameters=h,g.document=f,g.components=p;var m=n.targetScope=new u(e);m.parameters=h,m.document=f,m.components=p;var v=l.map(function(e){return r(e)}).map(function(e){if("rangeContent"===e.type){var t=o(e.args[0]);return a.makeRangeContentObserver(t)}if("mapContent"===e.type){t=o(e.args[0]);return a.makeMapContentObserver(t)}return o(e)}),y=a.makeRangeContentObserver(a.makeObserversObserver(v)),b=a.makeComputerObserver(y,c,e),w=r(t);return i(w)(b,g,m,n,d?{sourcePath:l.join(", "),targetPath:t}:void 0)}},function(e,t,n){var r=n(5),o=n(9),i=n(6),a=i.autoCancelPrevious,u=n(3);e.exports=function(e,t,n){var l;l="function"==typeof n?{change:n}:n;(l=l||s).source=e,l.sourcePath=t;var c=l.parameters=l.parameters||e,h=l.document,f=l.components,p=l.beforeChange,d=l.contentChange,g=new u(e);g.parameters=c,g.document=h,g.components=f,g.beforeChange=p;var m=r(t),v=o(m);!0===d&&(v=i.makeRangeContentObserver(v));return v(a(function(t){if(t){if("function"!=typeof d)return l.change.apply(e,arguments);if("function"==typeof d)return t.addRangeChangeListener(d),function(){t.removeRangeChangeListener(d)}}else;}),g)};var s={}},function(e,t,n){e.exports=n(56)},function(e,t,n){var r=n(57),o=n(62);e.exports={stringify:r,parse:o}},function(e,t,n){(function(t){var n={delimiter:"&",stringify:function(e,r){if(t.isBuffer(e)?e=e.toString():e instanceof Date?e=e.toISOString():null===e&&(e=""),"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return[encodeURIComponent(r)+"="+encodeURIComponent(e)];var o=[];for(var i in e)e.hasOwnProperty(i)&&(o=o.concat(n.stringify(e[i],r+"["+i+"]")));return o}};e.exports=function(e,t){t=void 0===t?n.delimiter:t;var r=[];for(var o in e)e.hasOwnProperty(o)&&(r=r.concat(n.stringify(e[o],o)));return r.join(t)}}).call(this,n(37).Buffer)},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=l(e),a=r[0],u=r[1],s=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,u)),c=0,h=u>0?a-4:a;for(n=0;n<h;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=255&t;2===u&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,s[c++]=255&t);1===u&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,s[c++]=t>>8&255,s[c++]=255&t);return s},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=0,u=n-o;a<u;a+=16383)i.push(c(e,a,a+16383>u?u:a+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,s=a.length;u<s;++u)r[u]=a[u],o[a.charCodeAt(u)]=u;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var o,i,a=[],u=t;u<n;u+=3)o=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(255&e[u+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,u=8*o-r-1,s=(1<<u)-1,l=s>>1,c=-7,h=n?o-1:0,f=n?-1:1,p=e[t+h];for(h+=f,i=p&(1<<-c)-1,p>>=-c,c+=u;c>0;i=256*i+e[t+h],h+=f,c-=8);for(a=i&(1<<-c)-1,i>>=-c,c+=r;c>0;a=256*a+e[t+h],h+=f,c-=8);if(0===i)i=1-l;else{if(i===s)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),i-=l}return(p?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,u,s,l=8*i-o-1,c=(1<<l)-1,h=c>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+h>=1?f/s:f*Math.pow(2,1-h))*s>=2&&(a++,s/=2),a+h>=c?(u=0,a=c):a+h>=1?(u=(t*s-1)*Math.pow(2,o),a+=h):(u=t*Math.pow(2,h-1)*Math.pow(2,o),a=0));o>=8;e[n+p]=255&u,p+=d,u/=256,o-=8);for(a=a<<o|u,l+=o;l>0;e[n+p]=255&a,p+=d,a/=256,l-=8);e[n+p-d]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r=n(63),o={delimiter:"&",depth:5,arrayLimit:20,parametersLimit:1e3,parseValues:function(e,t){t="string"==typeof t?t:o.delimiter;for(var n={},i=e.split(t,o.parametersLimit),a=0,u=i.length;a<u;++a){var s=i[a],l=-1===s.indexOf("]=")?s.indexOf("="):s.indexOf("]=")+1;if(-1===l)n[r.decode(s)]="";else{var c=r.decode(s.slice(0,l)),h=r.decode(s.slice(l+1));n[c]?n[c]=[].concat(n[c]).concat(h):n[c]=h}}return n},parseObject:function(e,t){if(!e.length)return t;var n=e.shift(),r={};if("[]"===n)r=(r=[]).concat(o.parseObject(e,t));else{var i="["===n[0]&&"]"===n[n.length-1]?n.slice(1,n.length-1):n,a=parseInt(i,10);!isNaN(a)&&n!==i&&a<=o.arrayLimit?(r=[])[a]=o.parseObject(e,t):r[i]=o.parseObject(e,t)}return r},parseKeys:function(e,t,n){if(e){var r=/(\[[^\[\]]*\])/g,i=/^([^\[\]]*)/.exec(e);if(!Object.prototype.hasOwnProperty(i[1])){var a=[];i[1]&&a.push(i[1]);for(var u=0;null!==(i=r.exec(e))&&u<n;)++u,Object.prototype.hasOwnProperty(i[1].replace(/\[|\]/g,""))||a.push(i[1]);return i&&a.push("["+e.slice(i.index)+"]"),o.parseObject(a,t)}}}};e.exports=function(e,t,n){if(""===e||null==e)return{};"number"!=typeof t&&(n=t,t=o.depth);var i="string"==typeof e?o.parseValues(e,n):r.clone(e),a={};for(var u in i)if(i.hasOwnProperty(u)){var s=o.parseKeys(u,i[u],t);a=r.merge(a,s)}return r.compact(a)}},function(e,t,n){(function(e){t.arrayToObject=function(e){for(var t={},n=0,r=e.length;n<r;++n)void 0!==e[n]&&(t[n]=e[n]);return t},t.clone=function(n){if("object"!=typeof n||null===n)return n;if(e.isBuffer(n))return n.toString();var r=Array.isArray(n)?[]:{};for(var o in n)n.hasOwnProperty(o)&&(r[o]=t.clone(n[o]));return r},t.merge=function(e,n){if(!n)return e;var r=t.clone(e);if(Array.isArray(n)){for(var o=0,i=n.length;o<i;++o)void 0!==n[o]&&("object"==typeof r[o]?r[o]=t.merge(r[o],n[o]):r[o]=n[o]);return r}Array.isArray(r)&&(r=t.arrayToObject(r));for(var a=Object.keys(n),u=0,s=a.length;u<s;++u){var l=a[u],c=n[l];c&&"object"==typeof c?r[l]?r[l]=t.merge(r[l],c):r[l]=t.clone(c):r[l]=c}return r},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.compact=function(e){if("object"!=typeof e||null===e)return e;var n={};for(var r in e)if(e.hasOwnProperty(r))if(Array.isArray(e[r])){n[r]=[];for(var o=0,i=e[r].length;o<i;o++)void 0!==e[r][o]&&n[r].push(e[r][o])}else n[r]=t.compact(e[r]);return n}}).call(this,n(37).Buffer)},function(e,t,n){e.exports={parmaite:n(38),annatar:n(21)}},function(e,t,n){e.exports={"general-use":n(66),classical:n(69),beleriand:n(70)}},function(e,t,n){var r=n(21),o=n(22),i=n(7),a=n(23),u=n(24),s=n(15),l=n(25);t.name="General Use Mode";var c={};function h(e){return(e=e||c).blackSpeech&&(e.language="blackSpeech"),"blackSpeech"===e.language&&(e.language="black-speech"),{font:e.font||r,block:e.block,plain:e.plain,doubleNasalsWithTildeBelow:e.doubleNasalsWithTildeBelow,reverseCurls:e.reverseCurls||"black-speech"===e.language,swapDotSlash:e.swapDotSlash,medialOre:e.medialOre||"black-speech"===e.language,language:e.language,noAchLaut:e.noAchLaut,sHook:e.sHook,tsdz:e.tsdz,duodecimal:e.duodecimal}}t.makeOptions=h,t.transcribe=function(e,t){return(t=h(t)).font.transcribe(f(e,t),t)},t.encode=function(e,t){return t=h(t),o.encode(f(e,t),t)};var f=t.parse=a(function(e,t){return u(function(e,t){var n=t.font.makeColumn;return d(function(r,a){if("english"===t.language){if("of"===r)return function(t){return i.isBreak(t)?d(function(t,r){return"the"===t?e([O(n)]):"the'"===t?e([m(n),b(n)]):"the''"===t?e([m(n),b(n)]):r(e([m(n)]))}):e([m(n)])(t)};if("of'"===r)return d(function(t,r){return"the"===t?e([v(n),y(n)]):"the'"===t?e([v(n),b(n)]):"the''"===t?e([v(n),w(n)]):r(e([v(n)]))});if("the"===r)return e([y(n)]);if("the'"===r)return e([b(n)]);if("the''"===r)return e([w(n)]);if("of'the"===r)return e([m(n)])("t")("h")("e");if("of'the'"===r)return e([v(n)])("t")("h")("e")("'");if("and"===r)return e([C(n)]);if("and'"===r)return e([A(n)]);if("and''"===r)return e([E(n)]);if("we"===r)return e([n("vala",{from:"w"}),n("short-carrier",{from:""}).addAbove("e",{from:"e"}).varies()]);if("we'"===r)return e([n("vala",{from:"w",diphthong:!0}).addBelow("y",{from:""})])}return p[r]?e(o.decodeWord(p[r],n),{from:r}):e(g(r,r.length,t),r)},t)}(e,t))},h);var p={iant:"yanta;tinco:a,tilde-above",iaur:"yanta;vala:a;ore",baranduiniant:"umbar;romen:a;ando:a,tilde-above;anna:u;yanta;anto:a,tilde-above",ioreth:"yanta;romen:o;thule:e",noldo:"nwalme;lambe:o;ando;short-carrier:o",noldor:"nwalme;lambe:o;ando;ore:o"};function d(e,t,n,r){return n=n||"",r=r||function(e){return e},function(o){return i.isBreak(o)?e(n,r)(o):d(e,t,n+o,function(e){return r(e)(o)})}}var g=i.makeParser(function(e,t,n){return function e(t,n,r,o,a){return function(e,t,n,r){var o=n.font.makeColumn;return function(e,t){return function(n){return""===n&&"english"!==t.language&&(n="e"),""===n?e():-1!==B.indexOf(n)?function(t){return t===n?e(x[n],x[n]):e(n,n)(t)}:-1!==P.indexOf(n)?e(n,n):e()(n)}}(function(r,a){return function(e,t,n,r){var o=t.font.makeColumn;return function(a){return"n"===a?function(i){return"n"===i?t.doubleNasalsWithTildeBelow?e(o("numen",{from:"n"}).addTildeBelow({from:"n"}),n,r):e(o("numen",{from:"n"}).addTildeAbove({from:"n"}),n,r):"t"===i?function(t){return"h"===t?e(o("thule",{from:"th"}).addTildeAbove({from:"n"}),n,r):e(o("tinco",{from:"t"}).addTildeAbove({from:"n"}),n,r)(t)}:"d"===i?e(o("ando",{from:"d"}).addTildeAbove({from:"n"}),n,r):"c"===i?e(o("quesse",{from:"c"}).addTildeAbove({from:""}),n,r):"g"===i?e(o("ungwe",{from:"g"}).addTildeAbove({from:""}),n,r):"j"===i?e(o("anca",{from:"j"}).addTildeAbove({from:"n"}),n,r):"f"===i?e(o("numen",{from:"n"}),n,r)("v"):"w"===i?function(t){return"a"===t?function(t){return"l"===t?e(o("nwalme",{from:"n"}).addAbove("w",{from:"w"}),n,r)("a")(t):e(o("numen",{from:"n"}).addAbove("w",{from:"w"}),n,r)("a")(t)}:"nw'"===t?e(o("nwalme",{from:""}).addAbove("w",{from:"w"}),n,r):e(o("numen",{from:"n"}).addAbove("w",{from:"w"}),n,r)(t)}:e(o("numen",{from:"n"}),n,r)(i)}:"m"===a?function(i){return"m"===i?t.doubleNasalsWithTildeBelow?e(o("malta",{from:"m"}).addTildeBelow({from:"m"}),n,r):e(o("malta",{from:"m"}).addTildeAbove({from:"m"}),n,r):"p"===i?e(o("parma",{from:"p"}).addTildeAbove({from:"m"}),n,r):"b"===i?e(o("umbar",{from:"b"}).addTildeAbove({from:"m"}),n,r):"f"===i?e(o("formen",{from:"f"}).addTildeAbove({from:"m"}),n,r):"v"===i?e(o("ampa",{from:"v"}).addTildeAbove({from:"m"}),n,r):e(o("malta",{from:"m"}),n,r)(i)}:""===a?function(t){return"c"===t?e(o("quesse",{from:"c"}).addTildeAbove({from:""}),n,r):"g"===t?e(o("ungwe",{from:"g"}).addTildeAbove({from:""}),n,r):e(o("nwalme",{from:""}),n,r)(t)}:"t"===a?function(i){return"t"===i?e(o("tinco",{from:"t"}).addTildeBelow({from:"t"}),n,r):"h"===i?e(o("thule",{from:"th"}),n,r):"c"===i?function(t){return"h"===t?e(o("tinco",{from:"t"}),n,r)("c")("h")("'"):e(o("tinco",{from:"t"}),n,r)("c")(t)}:"s"===i&&t.tsdz?e(o("calma",{from:"ts"}),n,r):e(o("tinco",{from:"t"}),n,r)(i)}:"p"===a?function(t){return"p"===t?e(o("parma",{from:"p"}).addTildeBelow({from:"p"}),n,r):"h"===t?e(o("formen",{from:"ph"}),n,r):e(o("parma",{from:"p"}),n,r)(t)}:"c"===a?function(a){return"c"===a?e(o("calma",{from:"cc"}),n,r):"h"===a?i.countPrimes(function(i){return t.noAchLaut&&!i?e(o("calma",{from:"ch"}),n,r):e(o("hwesta",{from:"ch"}),n,r)}):e(o("quesse",{from:"c"}),n,r)(a)}:"d"===a?function(i){return"d"===i?e(o("ando",{from:"d"}).addTildeBelow({from:"d"}),n,r):"j"===i?e(o("anga",{from:"dj"}),n,r):"z"===i&&t.tsdz?e(o("anga",{from:"dz"}),n,r):"h"===i?e(o("anto",{from:"dh"}),n,r):e(o("ando",{from:"d"}),n,r)(i)}:"b"===a?function(t){return"b"===t?e(o("umbar",{from:"b"}).addTildeBelow({from:"b"}),n,r):"bh"===t?e(o("ampa",{from:"bh (v)"}),n,r):e(o("umbar",{from:"b"}),n,r)(t)}:"g"===a?function(i){return"g"===i?e(o("ungwe",{from:"g"}).addTildeBelow({from:"g"}),n,r):"h"===i?"black-speech"===t.language?e(o("ungwe-extended",{from:"gh"}),n,r):e(o("unque",{from:"gh"}),n,r):e(o("ungwe",{from:"g"}),n,r)(i)}:"f"===a?function(t){return"f"===t?e(o("formen",{from:"f"}).addTildeBelow({from:"f"}),n,r):e(o("formen",{from:"f"}),n,r)(t)}:"v"===a?e(o("ampa",{from:"v"}),n,r):"j"===a?e(o("anca",{from:"j"}),n,r):"s"===a?function(a){return"s"===a?i.countPrimes(function(t){var i=o(t>0?"silme-nuquerna":"silme",{from:t>0?"s":"s"}).addTildeBelow({from:"s"});return 0===t&&i.varies(),t>1&&i.addError("Silme does not have this many alternate forms."),e(i,n,r)}):"h"===a?"black-speech"===t.language?e(o("calma-extended",{from:"sh"}),n,r):e(o("harma",{from:"sh"}),n,r):i.countPrimes(function(t){var i=o(t>0?"silme-nuquerna":"silme",{from:t>0?"s":"s"});return 0===t&&i.varies(),t>1&&i.addError("Silme does not have this many alternate forms."),e(i,n,r)})(a)}:"z"===a?function(t){return"z"===t?i.countPrimes(function(t){var i=o(t>0?"esse-nuquerna":"esse",{from:"z"}).addTildeBelow({from:"z"});return 0===t&&i.varies(),t>1&&i.addError("Esse does not have this many alternate forms."),e(i,n,r)}):i.countPrimes(function(t){var i=o(t>0?"esse-nuquerna":"esse",{from:"z"});return 0===t&&i.varies(),t>1&&i.addError("Silme does not have this many alternate forms."),e(i,n,r)})(t)}:"h"===a?function(t){return"w"===t?e(o("hwesta-sindarinwa",{from:"hw"}),n,r):e(o("hyarmen",{from:"h"}),n,r)(t)}:"r"===a?function(a){return"r"===a?e(o("romen",{from:"r"}).addTildeBelow({from:"r"}),n,r):"h"===a?e(o("arda",{from:"rh"}),n,r):i.isFinal(a)||t.medialOre&&-1===j.indexOf(a)?e(o("ore",{from:"r",final:!0}),n,r)(a):e(o("romen",{from:"r"}),n,r)(a)}:"l"===a?function(t){return"l"===t?e(o("lambe",{from:"l"}).addTildeBelow({from:"l"}),n,r):"h"===t?e(o("alda",{from:"lh"}),n,r):e(o("lambe",{from:"l"}),n,r)(t)}:"i"===a?e(o("anna",{from:"i",diphthong:!0}),n,r):"u"===a?e(o("vala",{from:"u",diphthong:!0}),n,r):"w"===a?function(t){return"h"===t?e(o("hwesta-sindarinwa",{from:"wh"}),n,r):e(o("vala",{from:"w",dipththong:!0}),n,r)(t)}:"e"!==a||n&&"a"!==n?""===a?e(o("short-carrier",{from:""}).addAbove("e",{from:"e"})):"y"===a?i.countPrimes(function(t){return 0===t?e(o("anna",{from:""}),n,r):1===t?e(o("long-carrier",{from:"y"}).addAbove("i",{from:""}),n,r):e(o("ure",{from:"y"}).addError("Consonantal Y only has one variation"))}):_[a]?e(k(a,a,t).addAbove(_[a],{from:""}),n,r):"'"===a&&"english"===t.language&&"e"===n?e(o("short-carrier",{from:""}).addAbove("e",{from:"e"})):""===a&&"english"===t.language&&"e"===n?e(o("short-carrier",{from:""}).addBelow("i-below",{from:"e",silent:!0}))(a):e(null,n,r)(a):e(o("yanta",{from:"e",diphthong:!0}),n,r)}}(function(r,a,u){return r?a?(n.reverseCurls&&(a=T[a]||a),n.swapDotSlash&&(a=S[a]||a),"silme"===r.tengwa&&a&&n.sHook?e([o("short-carrier",{from:""}).addAbove(a,{from:u}).addBelow("s",{from:"s"})]):"english"===n.language&&_[a]?e([o("long-carrier",{from:_[a]}).addAbove(_[a],{from:_[a]}),r]):function(e){return-1!==R.indexOf(e)}(a)&&r.canAddAbove(a)?(r.addAbove(a,{from:u}),M(function(t){return e([t])},r,t,n)):M(function(t){return e([k(a,u,n),t])},r,t,n)):M(function(t){return e([t])},r,t,n):a?(n.reverseCurls&&(a=T[a]||a),n.swapDotSlash&&(a=S[a]||a),M(function(t){return e([t])},k(a,u,n),t,n)):function(t){return i.isBreak(t)?e([]):/\d/.test(t)?l(e,n)(t):s[t]?e([o(s[t],{from:t})]):e([o("ure",{from:t}).addError("Cannot transcribe "+JSON.stringify(t)+" in General Use Mode")])}},n,r,a)},n)}(function(i){return i.length?e(t,n,r,o.concat(i),i[i.length-1]):t(o)},n,r)}(e,t,n,[])});function m(e){return e("umbar-extended",{from:"of"}).varies()}function v(e){return m(e).addAbove("o",{from:"o",silent:!0}).varies()}function y(e){return e("ando-extended",{from:"the"}).varies()}function b(e){return y(e).addBelow("i-below",{from:""}).varies()}function w(e){return e("thule",{from:"th"}).addBelow("i-below",{from:"e",silent:!0})}function O(e){return e("umbar-extended",{from:"of the"}).addTildeBelow({from:""})}function C(e){return e("ando",{from:"and"}).addTildeAbove({from:""})}function A(e){return C(e).addBelow("i-below",{from:""}).varies()}function E(e){return e("ando",{from:"d"}).addTildeAbove("n",{from:"n"}).addAbove("a",{from:"a"})}function k(e,t,n){var r=n.font.makeColumn;return""===e?r("wilya",{from:"a"}).addAbove("a",{from:"a"}):_[e]?r("long-carrier",{from:t}).addAbove(_[e],{from:""}):r("short-carrier",{from:t}).addAbove(e,{from:""})}var B="aeiou",x={a:"",e:"",i:"",o:"",u:""},P="aei",R="aeiou",j="aeiou",_={"":"a","":"e","":"i","":"o","":"u"},T={o:"u",u:"o","":"","":""},S={i:"e",e:"i"};function M(e,t,n,r){return function(e,t){return t.canAddAbove("w","w")?function(n){return"w"===n?e(t.addAbove("w",{from:"e"})):e(t)(n)}:e(t)}(function(t){return function(e,t,n,r){return function(o){return""===o&&"english"!==r.language&&(o="e"),"y"===o&&t.canAddBelow("y")?e(t.addBelow("y",{from:"y"})):"e"===o&&t.canAddBelow("i-below")?i.countPrimes(function(o){return function(a){return i.isFinal(a)&&"english"===r.language&&n>2?0===o?e(t.addBelow("i-below",{from:"e",silent:!0}).varies())(a):(o>1&&t.addError("Following E has only one variation."),e(t)("e")(a)):0===o?e(t.varies())("e")(a):(o>1&&t.addError("Following E has only one variation."),e(t.addBelow("i-below",{from:"e",eilent:!0}))(a))}}):e(t)(o)}}(function(t){return function(e,t){return function(n){return"s"===n?t.canAddBelow("s")?i.countPrimes(function(n,r){return 0===n?e(t.addBelow("s",{from:"s"}).varies()):n?(n>1&&t.addError("Only one alternate form for following S."),r(e(t)("s"))):void 0}):i.countPrimes(function(n,r){return function(o){if(i.isFinal(o)){if(t.canAddFollowing("s-final")&&0==n--)t.addFollowing("s-final",{from:"s"});else if(t.canAddFollowing("s-inverse")&&0==n--)t.addFollowing("s-inverse",{from:"s"}),t.canAddFollowing("s-final")&&t.varies();else if(t.canAddFollowing("s-extended")&&0==n--)t.addFollowing("s-extended",{from:"s"}),t.canAddFollowing("s-inverse")&&t.varies();else{if(!t.canAddFollowing("s-flourish")||0!=n--){for(var a=e(t)("s");n-- >0;)a=a("'");return a}t.addFollowing("s-flourish",{from:"s"}),t.canAddFollowing("s-extended")&&t.varies()}return e(t)(o)}return r(e(t)("s"))(o)}}):e(t)(n)}}(e,t)},t,n,r)},t)}t.parseTengwaAnnotations=M},function(e,t){e.exports=function e(t){var n=Object.keys(t);var r={value:void 0,children:{}};var o={};n.forEach(function(e){if(0===e.length)r.value=t[e];else{var n=e[0];o[n]||(o[n]={});var i=e.slice(1);o[n][i]=t[e]}});var i=Object.keys(o);i.forEach(function(t){r.children[t]=e(o[t])});return r}},function(e,t){e.exports=function e(t,n,r,o){var i={};var a=Object.keys(t.children);a.forEach(function(a){i[a]=e(t.children[a],n,r,o)});var u;t.value&&(u=n(t.value));return a.reduceRight(function(e,t){return function(n){return function(o){return o===t?r(i[o](n)):e(n)(o)}}},function(e){return u?r(u(e)):o(e)})}},function(e,t,n){var r=n(21),o=n(22),i=n(7),a=n(23),u=n(24),s=n(15),l=n(25);t.name="Classical Mode";var c={};function h(e){return{font:(e=e||c).font||r,block:e.block,plain:e.plain,vilya:e.vilya,harma:e.harma,classicalH:e.classicalH,classicalR:e.classicalR,swapDotSlash:e.swapDotSlash,reverseCurls:e.reverseCurls,iuRising:e.iuRising,longHalla:e.longHalla,duodecimal:e.duodecimal}}t.makeOptions=h,t.transcribe=function(e,t){return(t=h(t)).font.transcribe(f(e,t),t)},t.encode=function(e,t){return t=h(t),o.encode(f(e,t),t)};var f=t.parse=a(function(e,t){return u(function e(t,n,r,o){r=r||[];return function(e,t,n){var r=t.font.makeColumn;return function(e,t,n){var r=t.font.makeColumn;return function(o){return"n"===o?function(t){return"n"===t?e([r("numen",{from:"n"}).addTildeBelow({from:"n"})]):"t"===t?e([r("anto",{from:"nt"})]):"d"===t?e([r("ando",{from:"nd"})]):"g"===t?function(t){return"w"===t?e([r("ungwe",{from:"gw"})]):e([r("anga",{from:"g"})])(t)}:"c"===t?function(t){return"w"===t?e([r("unque",{from:"cw"})]):e([r("anca",{from:"c"})])(t)}:e([r("numen",{from:"n"})])(t)}:"m"===o?function(t){return"m"===t?e([r("malta",{from:"m"}).addTildeBelow({from:"m"})]):"p"===t?e([r("ampa",{from:"mp"})]):"b"===t?e([r("umbar",{from:"mb"})]):e([r("malta",{from:"m"})])(t)}:""===o?function(t){return"g"===t?function(t){return"w"===t?e([r("ungwe",{from:"gw"})]):e([r("anga",{from:"g"})])(t)}:"c"===t?function(t){return e("w"===t?[r("unque",{from:"cw"})]:[r("anca",{from:"c"})])}:e([r("noldo",{from:""})])(t)}:"t"===o?function(t){return"t"===t?function(t){return"y"===t?e([r("tinco",{from:"t"}).addBelow("y",{from:"y"}).addTildeBelow({from:"t"})]):e([r("tinco",{from:"t"}).addTildeBelow({from:"t"})])(t)}:"y"===t?e([r("tinco",{from:"t"}).addBelow("y",{from:"y"})]):"h"===t?e([r("thule",{from:"th"})]):"s"===t?function(t){return i.isFinal(t)?e([r("tinco",{from:"t"}).addFollowing("s",{from:"s"})])(t):e([r("tinco",{from:"t"}),r("silme",{from:"s"})])(t)}:e([r("tinco",{from:"t"})])(t)}:"p"===o?function(t){return"p"===t?function(t){return"y"===t?e([r("parma",{from:"p"}).addBelow("y",{from:"y"}).addTildeBelow({from:"p"})]):e([r("parma",{from:"p"}).addTildeBelow({from:"p"})])(t)}:"y"===t?e([r("parma",{from:"p"}).addBelow("y",{from:"y"})]):"s"===t?function(t){return i.isFinal(t)?e([r("parma",{from:"p"}).addFollowing("s",{from:"s"})])(t):e([r("parma",{from:"p"}),r("silme",{from:"s"})])(t)}:e([r("parma",{from:"p"})])(t)}:"c"===o?function(t){return"c"===t?e([r("calma",{from:"c"}).addTildeBelow({from:"c"})]):"s"===t?e([r("calma",{from:"s"}).addBelow("s",{from:"s"})]):"h"===t?e([r("harma",{from:"ch"})]):"w"===t?e([r("quesse",{from:"chw"})]):e([r("calma",{from:"c"})])(t)}:"f"===o?e([r("formen",{from:"f"})]):"v"===o?t.vilya?e([r("wilya",{from:"v",name:"vilya"})]):e([r("vala",{from:"v",name:"vala"})]):"w"===o?t.vilya?e([])("u"):e([r("wilya",{from:"w",name:"vilya"})]):"r"===o?function(o){if("d"===o)return e([r("arda",{from:"rd"})]);if("h"===o){var a="R should preceed H in the HR diagraph in Classical mode.";return e([r("halla",{from:"h"}).addError(a),r("romen",{from:"r"}).addError(a)])}return t.classicalR?n&&n.above&&!i.isFinal(o)&&-1!==p.indexOf(o)?e([r("ore",{from:"r"})])(o):e([r("romen",{from:"r"})])(o):i.isFinal(o)||-1===p.indexOf(o)?e([r("ore",{from:"r"})])(o):e([r("romen",{from:"r"})])(o)}:"l"===o?function(t){if("l"===t)return function(t){return"y"===t?e([r("lambe",{from:"l"}).addBelow("y",{from:"y"}).addTildeBelow({from:"l"})]):e([r("lambe",{from:"l"}).addTildeBelow({from:"y"})])(t)};if("y"===t)return e([r("lambe",{from:"l"}).addBelow("y",{from:"y"})]);if("h"===t){var n="L should preceed H in the HL diagraph in Classical mode.";return e([r("halla",{from:"h"}).addError(n),r("lambe",{from:"l"}).addError(n)])}return"d"===t?e([r("alda",{from:"ld"})]):"b"===t?e([r("lambe",{from:"l"}),r("umbar",{from:"b"})]):e([r("lambe",{from:"l"})])(t)}:"s"===o?function(t){return"s"===t?e([r("esse",{from:"ss"})]):e([r("silme",{from:"s"})])(t)}:"h"===o?function(o){return"l"===o?e([r("halla",{from:"h"}),r("lambe",{from:"l"})]):"r"===o?e([r("halla",{from:"h"}),r("romen",{from:"r"})]):"w"===o?e([r("hwesta",{from:"hw"})]):"t"===o?e([r("harma",{from:"ht"})]):"y"===o?t.classicalH&&!t.harma?e([r("hyarmen",{from:"hy"})]):e([r("hyarmen",{from:"hy"}).addBelow("y",{from:"y"})]):t.classicalH?t.harma?n?e([r("halla",{from:"h"})])(o):e([r("harma",{from:"h"})])(o):n?e([r("hyarmen",{from:"h"})])(o):e([r("halla",{from:"h"})])(o):e([r("hyarmen",{from:"h"})])(o)}:"d"===o?e([r("ando",{from:"d"}).addError("D cannot appear except after N, L, or R in Classical Mode")]):"b"===o?e([r("umbar",{from:"b"}).addError("B cannot appear except after M or L in Classical Mode")]):"g"===o?e([r("anga",{from:"g"}).addError("G cannot appear except after N or  in Classical Mode")]):"j"===o?e([r("ure",{from:"j"}).addError("J cannot be transcribed in Classical Mode")]):e([])(o)}}(function(n){var o=n.pop();return function e(t,n,r){var o=n.font;var i=o.makeColumn;return function(o){if("a"===o)return function(o){return"a"===o?e(t,n,r)(""):"i"===o?t([r,i("yanta",{from:"i",diphthong:!0}).addAbove("a",{from:"a"})]):"u"===o?t([r,i("ure",{from:"u",diphthong:!0}).addAbove("a",{from:"a"})]):r&&r.canAddAbove("a")?t([r.addAbove("a",{from:"a"})])(o):t([r,i("short-carrier",{from:"a"}).addAbove("a",{from:""})])(o)};if("e"===o||""===o){var a=v("e",n);return function(o){return"e"===o?e(t,n,r)(""):"u"===o?t([r,i("ure",{from:"u",diphthong:!0}).addAbove(a,{from:"e"})]):r&&r.canAddAbove("e")?t([r.addAbove(a,{from:"e"})])(o):t([r,i("short-carrier",{from:"e"}).addAbove(a,{from:""})])(o)}}if("i"===o){var u=v("i",n);return function(o){return"i"===o?e(t,n,r)(""):"u"===o?n.iuRising?t([r,i("anna",{from:"i",diphthong:!0}).addAbove(g("u",n),{from:"u"}).addBelow("y",{from:"y"})]):t([r,i("ure",{from:"u",diphthong:!0}).addAbove(u,{from:"i"})]):r&&r.canAddAbove(u)?t([r.addAbove(u,{from:"i"})])(o):t([r,i("short-carrier",{from:"i"}).addAbove(u,{from:""})])(o)}}if("o"===o)return function(o){return"o"===o?e(t,n,r)(""):"i"===o?t([r,i("yanta",{from:"i",diphthong:!0}).addAbove(g("o",n),{from:"o"})]):r&&r.canAddAbove("o")?t([r.addAbove(g("o",n),{from:"o"})])(o):t([r,i("short-carrier",{from:"o"}).addAbove(g("o",n),{from:""})])(o)};if("u"===o)return function(o){return"u"===o?e(t,n,r)(""):"i"===o?t([r,i("yanta",{from:"i",diphthong:!0}).addAbove(g("u",n),{from:"u"})]):r&&r.canAddAbove("u")?t([r.addAbove(g("u",n),{from:"u"})])(o):t([r,i("short-carrier",{from:"u"}).addAbove(g("u",n),{from:""})])(o)};if("y"===o){if(r&&r.canAddBelow("y"))return t([r.addBelow("y",{from:"y"})]);var s=i("anna",{from:""}).addBelow("y",{from:"y"});return e(function(e){return t([r].concat(e))},n,s)}return""===o?t([r,i("long-carrier",{from:""}).addAbove("a",{from:""})]):""===o?t([r,i("long-carrier",{from:""}).addAbove(v("e",n),{from:""})]):""===o?t([r,i("long-carrier",{from:""}).addAbove(v("i",n),{from:""})]):""===o?r&&r.canAddAbove("")?t([r.addAbove(g("",n),{from:""})]):t([r,i("long-carrier",{from:""}).addAbove(g("o",n),{from:""})]):""===o?r&&r.canAddAbove("")?t([r.addAbove(g("",n),{from:""})]):t([r,i("long-carrier",{from:""}).addAbove(g("u",n),{from:""})]):t([r])(o)}}(function(o){return(o=n.concat(o).filter(Boolean)).length?e(o):function(n){return i.isBreak(n)?e([])(n):/\d/.test(n)?l(e,t)(n):s[n]?e([r(s[n],{from:n})]):e([r("ure",{from:""}).addError("Cannot transcribe "+JSON.stringify(n)+" in Classical Mode")])}},t,o)},t,n)}(function(o){return o.length?e(t,n,r.concat(o),o[o.length-1]):t(r)},n,o)}(e,t))},h);var p="aeiouy";var d={o:"u",u:"o","":"","":""};function g(e,t){return t.reverseCurls&&(e=d[e]||e),e}var m={e:"i",i:"e"};function v(e,t){return t.swapDotSlash&&(e=m[e]||e),e}},function(e,t,n){var r=n(38),o=n(7),i=n(22),a=n(23),u=n(24),s=n(15),l=n(25);t.name="Mode of Beleriand";var c={};function h(e){return{font:(e=e||c).font||r,block:e.block,plain:e.plain,duodecimal:e.duodecimal}}t.makeOptions=h,t.transcribe=function(e,t){return(t=h(t)).font.transcribe(f(e,t),t)},t.encode=function(e,t){return t=h(t),i.encode(f(e,t),t)};var f=t.parse=a(function(e,t){return u(function e(t,n,r){r=r||[];return p(function(o){return o?e(t,n,r.concat([o])):function(o){return/\d/.test(o)?l(function(o){return e(t,n,r.concat(o))},n)(o):t(r)(o)}},n)}(e,t))},h);function p(e,t){return function e(t,n){var r=n.font;var i=r.makeColumn;return function(r){return"n"===r?function(r){return"t"===r||"d"===r?e(function(e){return t(e.addTildeAbove())},n)(r):"c"===r||"g"===r?e(t,n)("")(r):"n"===r?t(i("numen",{from:"nn"})):t(i("ore",{from:"n"}))(r)}:"t"===r?function(e){return"h"===e?t(i("thule",{from:"th"})):t(i("tinco",{from:"t"}))(e)}:"d"===r?function(e){return"h"===e?t(i("anto",{from:"dh"})):t(i("ando",{from:"d"}))(e)}:"m"===r?function(r){return"p"===r||"b"===r||"f"===r||"v"===r?e(function(e){return t(e.addTildeAbove({from:r}))},n)(r):"m"===r?t(i("malta",{from:"mm"})):t(i("vala",{from:"m"}))(r)}:"p"===r?t(i("parma",{from:"p"})):"b"===r?t(i("umbar",{from:"b"})):"f"===r?function(e){return o.isFinal(e)?t(i("ampa",{from:"f",final:!0}))(e):t(i("formen",{from:"f",medial:!0}))(e)}:"v"===r?t(i("ampa",{from:"v"})):""===r?function(r){return"c"===r||"g"===r?e(function(e){return"halla"===e.tengwa&&e.addError("Lenited G (halla) should not be nasalized with prefix N"),t(e.addTildeAbove({from:r}))},n)(r):t(i("noldo",{from:""}))(r)}:"c"===r?function(e){return"h"===e?function(e){return"w"===e?t(i("hwesta",{from:"chw"})):t(i("harma",{from:"ch"}))(e)}:"w"===e?t(i("quesse",{from:"cw"})):t(i("calma",{from:"c"}))(e)}:"g"===r?function(e){return"h"===e?function(e){return"w"===e?t(i("unque",{from:"ghw"})):t(i("anca",{from:"gh"}))(e)}:"w"===e?t(i("ungwe",{from:"gw"})):"'"===e?t(i("halla",{from:"g"})):t(i("anga",{from:"g"}).varies())(e)}:"r"===r?function(e){return"h"===e?t(i("arda",{from:"rh"})):t(i("romen",{from:"r"}))(e)}:"l"===r?function(e){return"h"===e?t(i("alda",{from:"lh"})):t(i("lambe",{from:"l"}))(e)}:"s"===r?t(i("silme",{from:"s"})):"a"===r?function(e){return"i"===e?t(i("round-carrier",{from:"a",diphthong:!0}).addAbove("",{from:"i"})):"u"===e?t(i("round-carrier",{from:"a",diphthong:!0}).addAbove("w",{from:"u"})):"'"===e?t(i("round-carrier",{from:"a"}).addAbove("i",{from:"a"})):"a"===e?t(i("round-carrier",{from:"a",long:!0}).addAbove("e",{from:"a"})):t(i("round-carrier",{from:"a"}).varies())(e)}:"e"===r||""===r?function(e){return"i"===e?t(i("yanta",{from:"e"}).addAbove("",{from:"i"})):"e"===e?t(i("yanta",{from:"e",long:!0}).addAbove("e",{from:"e"})):t(i("yanta",{from:"e"}))(e)}:"i"===r?function(e){return"i"===e?p(t,n)(""):o.countPrimes(function(e){return t(0===e?i("short-carrier",{from:"i"}).varies():1===e?i("short-carrier",{from:"i"}).addAbove("i",{from:""}).varies():2===e?i("long-carrier",{from:"i",long:!0}).addAbove("i",{from:""}).varies():3===e?i("long-carrier",{from:"i",long:!0}):i("long-carrier").addAbove("i").addError("I only has four variants between short or long and dotted or not."))})(e)}:"o"===r?function(e){return"o"===e?t(i("anna",{from:"o"}).addAbove("e",{from:"o"})):t(i("anna",{from:"o"}))(e)}:"u"===r?function(e){return"i"===e?t(i("ure",{from:"u",diphthong:!0}).addAbove("",{from:"i"})):"u"===e?t(i("ure",{from:"u",long:!0}).addAbove("e",{from:"u"})):t(i("ure",{from:"u"}))(e)}:"w"===r?function(e){return"w"===e?t(i("wilya",{from:"w"}).addAbove("e",{from:"w"})):t(i("wilya",{from:"w"}))(e)}:"y"===r?function(e){return"y"===e?t(i("silme-nuquerna",{from:"y"}).addAbove("e",{from:"y"})):t(i("silme-nuquerna",{from:"y"}))(e)}:""===r?t(i("round-carrier",{from:"a",long:!0}).addAbove("e",{from:"a"})):""===r?t(i("yanta",{from:""}).addAbove("e")):""===r?o.countPrimes(function(e){return t(0===e?i("short-carrier",{from:"i"}).addAbove("e",{from:"i"}).varies():1===e?i("long-carrier",{from:"",long:!0}).addAbove("e",{from:""}):i("long-carrier").addAbove("e").addError(" only has one variant."))}):""===r?t(i("anna",{from:"",long:!0}).addAbove("e",{from:""})):""===r?t(i("ure",{from:"",long:!0}).addAbove("e",{from:""})):"h"===r?function(e){return"w"===e?t(i("hwesta-sindarinwa",{from:"hw"})):t(i("hyarmen",{from:"h"}))(e)}:"z"===r?t(i("silme",{from:"z"}).addError("Z does not appear in the mode of Beleriand")):s[r]?t(i(s[r],{from:r})):o.isBreak(r)||/\d/.test(r)?t()(r):t(i("anna",{from:r}).addError("Unexpected character: "+JSON.stringify(r)))}}(function(t){return t?function(e,t){return function(n){return"s"===n?t.canAddBelow("s")?e(t.addBelow("s",{from:"s"})):o.countPrimes(function(n){return function(r){if(o.isFinal(r)){if(t.canAddFollowing("s-final")&&0==n--)t.addFollowing("s-final",{from:"s"});else if(t.canAddFollowing("s-inverse")&&0==n--)t.addFollowing("s-inverse");else if(t.canAddFollowing("s-extended")&&0==n--)t.addFollowing("s-extended",{from:"s"});else{if(!t.canAddFollowing("s-flourish"))return e(t)("s",{from:"s"})(r);t.addFollowing("s-flourish",{from:"s"}),n>0&&t.addError("Following S only has 3 alternate flourishes.")}return e(t)(r)}return e(t)("s",{from:"s"})(r)}}):e(t)(n)}}(e,t):e()},t)}}]);